"use strict";(()=>{var U=e=>{let{stage:n,buildings:r}=u;switch(e){case"discharge":u.energy.current=0;for(let s=0;s<=3;s++)s===0?(r[0].current=3,r[0].total+=3):(r[s].current=0,r[s].true=0);break;case"stage":{let{upgrades:s,researches:i}=u;switch(n.true){case 1:U("discharge"),u.energy.total=0,u.discharge.current=0;for(let o=0;o<=3;o++)o===0?(r[0].current=3,r[0].total=3):r[o].total=0;for(let o=0;o<b.upgrades.length;o++)s[o]=0;for(let o=0;o<b.researches.length;o++)i[o]=0;break;case 2:for(let o=0;o<=1;o++)o===0?(r[0].current=1,r[0].total=1):(r[o].current=0,r[o].true=0,r[o].total=0);break}break}}};var I=(e,n,r=!1)=>{let{stage:s,energy:i,researchesAuto:o,buyToggle:l}=u,{stageInfo:g,energyType:f,buildingsInfo:d}=c;if(e[n-1].current<d.cost[n]*(r?2:1)){c.screenReader&&!r&&(t("invisibleBought").textContent=`Coudn't buy '${d.name[n]}', because didn't had enough of '${d.name[n-1]}'`);return}if(s.true===1&&(f[n]=x.energyType[n]*2**u.researches[4]),l.howMany!==1&&o[0]>0||r){let a=e[n-1].current/(r?2:1),v=d.cost[n],J=0,F=r?-1:l.howMany;for(var y=0;a>=v&&y!==F;y++)J+=v,a-=v,v*=d.increase;if(y<F&&F!==-1&&l.strict)return;e[n-1].current-=J,e[n].current+=y,e[n].true+=y,e[n].total+=y,s.true===1&&(i.current+=f[n]*y,i.total+=f[n]*y),c.screenReader&&!r&&(t("invisibleBought").textContent=`Bought ${m(y)} '${d.name[n]}'${s.true===1?`, gained ${m(f[n]*y)} ${g.resourceName[s.true]}`:""}`)}else(l.howMany===1||o[0]===0)&&(e[n-1].current-=d.cost[n],e[n].current++,e[n].true++,e[n].total++,s.true===1&&(i.current+=f[n],i.total+=f[n]),c.screenReader&&(t("invisibleBought").textContent=`Bought 1 '${d.name[n]}'${s.true===1?`, gained ${f[n]} ${g.resourceName[s.true]}`:""}`));w(n),A(),L()},w=e=>{let{stage:n,buildings:r,upgrades:s,researches:i}=u,{buildingsInfo:o,upgradesInfo:l}=c;n.true===1&&(l.effect[4]=Math.trunc((.2+i[0]*.01)*100)/100,o.increase=Math.trunc((1.4-(s[4]===1?l.effect[4]:0))*100)/100),o.cost[e]=x.buildingsInfo.cost[e]*o.increase**r[e].true,e===1&&s[0]===1&&n.true===1&&(o.cost[1]/=10)},P=(e,n)=>{u[n][e]!==c[n+"Info"].max[e]&&(c[n+"Info"].cost[e]=x[n+"Info"].cost[e]+c[n+"Info"].scalling[e]*u[n][e])},B=(e,n)=>{let{stage:r,buildings:s}=u,{buildingsInfo:i}=c,o=s[e].current;if(r.true===1&&e===3){if(i.producing[3]<=1)return;s[e].current+=Math.log(i.producing[e])*n*12**u.researches[2]*(u.upgrades[7]===1?u.energy.current:1)}else s[e].current+=i.producing[e+1]*n;s[e].total+=s[e].current-o},k=(e,n="normal")=>{let{energy:r,upgrades:s,researches:i,researchesAuto:o}=u,{upgradesInfo:l,researchesInfo:g,researchesAutoInfo:f}=c;switch(c.screenReader&&T(e,n),n){case"normal":if(s[e]===1||r.current<l.cost[e])return;if(s[e]=1,r.current-=l.cost[e],t(`upgrade${e+1}`).style.backgroundColor="green",e===0)w(1);else if(e===3)t("discharge").style.display="";else if(e===4)for(let d=1;d<=3;d++)w(d);c.screenReader&&(t("invisibleBought").textContent=`You have bought upgrade '${l.description[e]}'`);break;case"researches":{if(i[e]===g.max[e]||r.current<g.cost[e])return;let d=t(`research${e+1}Stage1Level`);if(i[e]++,r.current-=g.cost[e],d.textContent=String(i[e]),i[e]!==g.max[e]?d.classList.replace("redText","orchidText"):(d.classList.remove("redText","orchidText"),d.classList.add("greenText")),e===0)for(let y=1;y<=3;y++)w(y);c.screenReader&&(t("invisibleBought").textContent=`You have researched '${g.description[e]}', level is now ${i[e]} ${i[e]===g.max[e]?"maxed":""}`);break}case"researchesAuto":{if(o[e]===f.max[e]||r.current<f.cost[e])return;let d=t(`researchAuto${e+1}Level`);o[e]++,r.current-=f.cost[e],d.textContent=String(o[e]),o[e]!==f.max[e]?d.classList.replace("redText","orchidText"):(d.classList.remove("redText","orchidText"),d.classList.add("greenText")),c.screenReader&&(t("invisibleBought").textContent=`You have researched '${f.description[e]}', level is now ${o[e]} ${o[e]===f.max[e]?"maxed":""}`);break}}L(),n.includes("researches")&&P(e,n),T(e,n)},G=(e,n=!0)=>{var i,o,l,g;let{toggles:r}=u,s=t(`toggle${e}`);n&&(r[e]=!r[e]),s.classList.contains("auto")?r[e]?(s.textContent="Auto ON",s.style.borderColor=""):(s.textContent="Auto OFF",s.style.borderColor="crimson"):r[e]?(s.textContent="ON",s.style.borderColor="",c.screenReader&&(s.ariaLabel=(g=(l=s.ariaLabel)==null?void 0:l.replace(" OFF"," ON"))!=null?g:"")):(s.textContent="OFF",s.style.borderColor="crimson",c.screenReader&&(s.ariaLabel=(o=(i=s.ariaLabel)==null?void 0:i.replace(" ON"," OFF"))!=null?o:""))},$=(e="none")=>{let{buyToggle:n}=u,r=t("buyAnyInput");switch(e){case"1":n.howMany=1;break;case"max":n.howMany=-1;break;case"any":n.input=Math.max(Math.trunc(Number(r.value)),-1),n.input===0&&(n.input=1),n.howMany=n.input;break;case"strict":n.strict=!n.strict;break;default:r.value=String(n.input)}t("buyStrict").style.borderColor=n.strict?"":"crimson",t("buy1x").style.backgroundColor=n.howMany===1?"green":"",t("buyAny").style.backgroundColor=Math.abs(n.howMany)!==1?"green":"",t("buyMax").style.backgroundColor=n.howMany===-1?"green":""},V=async()=>{let{stage:e,buildings:n,researchesAuto:r}=u,s=!1;if(e.true===1)if(n[3].current>=1e21){let i=!0;u.toggles[2]&&(i=await C("Ready to enter next stage?")),i&&(r[0]===0&&r[0]++,s=!0)}else p("There are more molecules in a single drop than that you know.");else p("Not yet in game");s&&p("There is nothing past stage 1 for now")},_=async()=>{let{energy:e}=u,{dischargeInfo:n}=c;if(u.upgrades[3]===1&&u.buildings[1].true>0&&u.stage.true===1){let r=!0;if(u.toggles[1]&&e.current<n.next?r=await C("This will reset all of your current buildings and energy. You will NOT gain production boost. Continue?"):u.toggles[1]&&e.current>=n.next&&(r=await C("You have enough energy to gain boost. Continue?")),r){e.current>=n.next?(n.next*=10,u.discharge.current++,c.screenReader&&(t("invisibleBought").textContent="Progress was reset for 4x boost")):c.screenReader&&e.current<n.next&&(t("invisibleBought").textContent="Buildings and energy were reset, no boost"),U("discharge");for(let s=1;s<c.buildingsInfo.name.length;s++)w(s);L()}}};var S=(e="none")=>{if(c.tab!==e){t("stageTab").style.display="none",t("stageTabBtn").style.borderColor="",t("researchTab").style.display="none",t("researchTabBtn").style.borderColor="",t("settingsTab").style.display="none",t("settingsTabBtn").style.borderColor="";let n=["#e3e3e3","#a10000"][c.theme.stage-1],r=t("invisibleTab");t("specialTab").style.display="none",e!=="none"?c.tab=e:c.tab="stage",t(`${c.tab}Tab`).style.display="",t(`${c.tab}TabBtn`).style.borderColor=n,r.textContent=`Current tab: ${c.tab} tab`,j(),L()}},A=()=>{let{stage:e,discharge:n,time:r,upgrades:s,researches:i,researchesAuto:o,buildings:l,toggles:g}=u,{buildingsInfo:f,upgradesInfo:d}=c,y=Date.now()-r.updated,a=y/1e3;if(r.updated=Date.now(),y<0)return console.warn("Negative passed time detected.");switch(c.lastSave+=y,a>3600&&(a=3600,console.log("Max offline progress is 1 hour.")),e.true){case 1:d.effect[5]=Math.trunc((1.02+.01*i[1])*100)/100,d.effect[3]=4+1*i[3],s[6]===1&&B(3,a),g[6]&&o[1]>=3&&I(l,3,!0),f.producing[3]=.3*l[3].current*d.effect[3]**n.current,s[5]===1&&(f.producing[3]*=d.effect[5]**l[3].true),B(2,a),g[5]&&o[1]>=2&&I(l,2,!0),f.producing[2]=.4*l[2].current*d.effect[3]**n.current,s[2]===1&&(f.producing[2]*=5),s[5]===1&&(f.producing[2]*=d.effect[5]**l[2].true),B(1,a),g[4]&&o[1]>=1&&I(l,1,!0),f.producing[1]=.5*l[1].current*d.effect[3]**n.current,s[1]===1&&(f.producing[1]*=10),s[5]===1&&(f.producing[1]*=d.effect[5]**l[1].true),B(0,a);break}},L=()=>{let{stage:e,energy:n,buildings:r,upgrades:s}=u,{tab:i,lastSave:o,dischargeInfo:l,buildingsInfo:g,upgradesInfo:f}=c;c.footer&&(e.true===1?(t("quarks").textContent=`Quarks: ${m(r[0].current)}`,n.total>=9&&(t("energy").textContent=`Energy: ${m(n.current,0)}`)):e.true===2&&(t("water").textContent=`Drops: ${m(r[0].current)}`)),i==="stage"?(t("building1Cur").textContent=m(r[1].current),t("building1Prod").textContent=m(g.producing[1]),e.true===1?(g.cost[1]<=r[0].current?(t("building1Btn").classList.add("availableBuilding"),t("building1Btn").textContent=`Buy for: ${m(g.cost[1])} Quarks`):(t("building1Btn").classList.remove("availableBuilding"),t("building1Btn").textContent=`Need: ${m(g.cost[1])} Quarks`),r[1].total>=11&&(t("building2Cur").textContent=m(r[2].current),t("building2Prod").textContent=m(g.producing[2]),g.cost[2]<=r[1].current?(t("building2Btn").classList.add("availableBuilding"),t("building2Btn").textContent=`Buy for: ${m(g.cost[2])} Particles`):(t("building2Btn").classList.remove("availableBuilding"),t("building2Btn").textContent=`Need: ${m(g.cost[2])} Particles`)),r[2].total>=2&&(t("building3Cur").textContent=m(r[3].current),t("building3Prod").textContent=m(g.producing[3]),g.cost[3]<=r[2].current?(t("building3Btn").classList.add("availableBuilding"),t("building3Btn").textContent=`Buy for: ${m(g.cost[3])} Atoms`):(t("building3Btn").classList.remove("availableBuilding"),t("building3Btn").textContent=`Need: ${m(g.cost[3])} Atoms`)),s[3]===1&&(t("dischargeReset").textContent=`Next goal is ${m(l.next,0)} Energy`,t("dischargeEffect").textContent=String(f.effect[3]))):e.true===2&&(g.cost[1]<=r[0].current?(t("building1Btn").classList.add("availableBuilding"),t("building1Btn").textContent=`Buy for: ${m(g.cost[1])} Drops`):(t("building1Btn").classList.remove("availableBuilding"),t("building1Btn").textContent=`Need: ${m(g.cost[1])} Drops`))):i==="settings"&&o>=1e3&&(t("isSaved").textContent=`${m(o,0,"time")} ago`)},j=()=>{let{stage:e,energy:n,discharge:r,buildings:s,upgrades:i,researchesAuto:o}=u;if(e.true===1){t("energyStat").style.display=n.total>=9?"":"none",t("building2").style.display=s[1].total>=11?"":"none",t("building3").style.display=s[2].total>=2?"":"none",t("upgrades").style.display=n.total>=9?"":"none",t("discharge").style.display=i[3]>0?"":"none",t("resetToggles").style.display=r.current>=1?"":"none";for(let l=5;l<=8;l++)r.current>=3?t(`upgrade${l}`).style.display="":t(`upgrade${l}`).style.display="none";t("researchTabBtn").style.display=r.current>=4?"":"none",t("stage").style.display=i[7]===1?"":"none",s[3].current>=1e21&&(t("stageReset").textContent="Enter next stage"),c.screenReader&&(t("invisibleGetBuilding2").style.display=s[2].total>0?"":"none",t("invisibleGetBuilding3").style.display=s[3].total>0?"":"none")}for(let l=1;l<b.buildings.length;l++)o[1]>=l?t(`toggle${l+3}`).style.display="":t(`toggle${l+3}`).style.display="none";t("toggleBuy").style.display=o[0]>0?"":"none"},T=(e,n="normal")=>{let{stage:r,upgrades:s,researches:i,researchesAuto:o}=u,{stageInfo:l,buildingsInfo:g,upgradesInfo:f,researchesInfo:d,researchesAutoInfo:y}=c;switch(n){case"normal":t("upgradeText").textContent=f.description[e],t("upgradeEffect").textContent=`${f.effectText[e][0]}${f.effect[e]}${f.effectText[e][1]}`,t("upgradeCost").textContent=`${s[e]===1?0:f.cost[e]} ${l.resourceName[r.true-1]}.`;break;case"researches":t("researchText").textContent=d.description[e],t("researchEffect").textContent=`${d.effectText[e][0]}${d.effect[e]}${d.effectText[e][1]}`,t("researchCost").textContent=`${i[e]===d.max[e]?0:d.cost[e]} ${l.resourceName[r.true-1]}.`;break;case"researchesAuto":t("researchText").textContent=y.description[e],e===1&&(y.effect[1]=g.name[Math.min(o[1]+1,g.name.length-1)]),t("researchEffect").textContent=`${y.effectText[e][0]}${y.effect[e]}${y.effectText[e][1]}`,t("researchCost").textContent=`${o[e]===y.max[e]?0:y.cost[e]} ${l.resourceName[r.true-1]}.`;break}},m=(e,n=e<1e3?2:0,r="number")=>{switch(r){case"number":if(n>0&&e<1e6)return String(Math.trunc(e*10**n)/10**n);if(n<=0&&e<1e6)return String(Math.trunc(e));{let s=Math.trunc(Math.log10(e));return`${Math.trunc(e/10**s*100)/100}e${s}`}case"time":return e>=1728e5?`${Math.trunc(e/864e5)} days`:e>=72e5?`${Math.trunc(e/36e5)} hours`:e>=6e5?`${Math.trunc(e/6e4)} minutes`:`${Math.trunc(e/1e3)} seconds`}},K=()=>{let{stage:e,discharge:n,upgrades:r,researches:s,researchesAuto:i}=u,{stageInfo:o,dischargeInfo:l,buildingsInfo:g,researchesInfo:f,researchesAutoInfo:d}=c,y=document.body.style;t("upgradeCost").classList.remove("orangeText","cyanText"),t("researchCost").classList.remove("orangeText","cyanText");for(let a=2;a<b.buildings.length;a++)t(`building${a}`).style.display="none";if(e.true===1){g.name=["Quarks","Particles","Atoms","Molecules"],x.buildingsInfo.cost=[0,3,24,3],l.next=10**n.current,t("upgradeCost").classList.add("orangeText"),t("researchCost").classList.add("orangeText");for(let a=0;a<b.upgrades.length;a++)r[a]===1?t(`upgrade${[a+1]}`).style.backgroundColor="green":t(`upgrade${[a+1]}`).style.backgroundColor="";for(let a=0;a<b.researches.length;a++)t(`research${a+1}Stage1Level`).textContent=String(s[a]),t(`research${a+1}Stage1Level`).classList.remove("redText","orchidText","greenText"),P(a,"researches"),s[a]===f.max[a]?t(`research${a+1}Stage1Level`).classList.add("greenText"):s[a]===0?t(`research${a+1}Stage1Level`).classList.add("redText"):t(`research${a+1}Stage1Level`).classList.add("orchidText");t("quarkStat").style.display="",t("particles").style.display="",t("atoms").style.display="",t("molecules").style.display="",t("dischargeToggleReset").style.display="";for(let a=1;a<=4;a++)t(`upgrade${a}`).style.display="";for(let a=1;a<=b.researches.length;a++)t(`research${a}Stage1`).style.display="";t("stageToggleReset").style.display="none",t("themeArea").style.display="none"}else e.true===2&&(g.name=["Water drops",""],x.buildingsInfo.cost=[0,1],t("upgradeCost").classList.add("cyanText"),t("researchCost").classList.add("cyanText"),t("waterStat").style.display="");for(let a=1;a<g.name.length;a++)t(`building${a}Name`).textContent=g.name[a],w(a);d.max[1]=g.name.length-1;for(let a=0;a<b.researchesAuto.length;a++)t(`researchAuto${a+1}Level`).textContent=String(i[a]),t(`researchAuto${a+1}Level`).classList.remove("redText","orchidText","greenText"),P(a,"researchesAuto"),i[a]===d.max[a]?t(`researchAuto${a+1}Level`).classList.add("greenText"):i[a]===0?t(`researchAuto${a+1}Level`).classList.add("redText"):t(`researchAuto${a+1}Level`).classList.add("orchidText");if(t("researchAuto2Max").textContent=String(d.max[1]),e.true!==1){t("quarkStat").style.display="none",t("energyStat").style.display="none",t("particles").style.display="none",t("atoms").style.display="none",t("molecules").style.display="none",t("discharge").style.display="none",t("dischargeToggleReset").style.display="none";for(let a=1;a<=b.upgrades.length;a++)t(`upgrade${a}`).style.display="none";for(let a=1;a<=b.researches.length;a++)t(`research${a}Stage1`).style.display="none";t("upgrades").style.display="",t("resetToggles").style.display="",t("researchTabBtn").style.display="",t("stage").style.display="",t("stageToggleReset").style.display="",t("themeArea").style.display=""}if(e.true!==2&&(t("waterStat").style.display="none"),t("stageReset").textContent="You are not ready",t("stageWord").textContent=o.word[e.true-1],e.true===1?(y.removeProperty("--border-image"),y.removeProperty("--border-stage"),y.removeProperty("--stage-text-color")):(y.setProperty("--border-image",`url(Used_art/Stage${e.true}%20border.png)`),e.true===2&&(y.setProperty("--border-stage","#1460a8"),y.setProperty("--stage-text-color","dodgerblue"))),c.screenReader){t("invisibleBought").textContent=`Current stage is '${o.word[e.true-1]}'`,t("invisibleGetResource1").style.display=e.true===1?"":"none";for(let a=2;a<b.buildings.length;a++)t(`invisibleGetBuilding${a}`).style.display="none";for(let a=0;a<g.name.length;a++)t(`invisibleGetBuilding${a}`).textContent=`Get information for ${g.name[a]}`}};var z=(e,n=!1)=>{let{theme:r}=c;n?(r.default=!0,localStorage.removeItem("theme")):(r.default=!1,r.stage=e,localStorage.setItem("theme",String(e))),Y()},Y=()=>{let{stage:e}=u,{stageInfo:n,theme:r}=c,s=document.body.style;switch(s.setProperty("--transition","1s"),r.default?(r.stage=e.true,t("currentTheme").textContent="Default"):t("currentTheme").textContent=n.word[r.stage-1],s.removeProperty("--background-color"),s.removeProperty("--window-color"),s.removeProperty("--window-border"),s.removeProperty("--footer-color"),s.removeProperty("--button-main-color"),s.removeProperty("--button-main-border"),s.removeProperty("--button-main-hover"),s.removeProperty("--button-extra-hover"),s.removeProperty("--main-text-color"),s.removeProperty("--blue-text-color"),r.stage){case 2:s.setProperty("--background-color","#070026"),s.setProperty("--window-color","#000052"),s.setProperty("--window-border","blue"),s.setProperty("--footer-color","#0000db"),s.setProperty("--button-main-color","blue"),s.setProperty("--button-main-border","#427be1"),s.setProperty("--button-main-hover","#1515cf"),s.setProperty("--button-extra-hover","#2400d7"),s.setProperty("--main-text-color","dodgerblue"),s.setProperty("--blue-text-color","#82cb3b");break}setTimeout(()=>{s.removeProperty("--transition")},1e3)},p=e=>{let n=t("blocker");if(t("blocker").style.display==="block")return console.warn("Wasn't able to show another window (alert)");t("alertText").textContent=e;let r=t("confirmBtn");n.style.display="block";let s=()=>{n.style.display="none",r.removeEventListener("click",s)};r.addEventListener("click",s)},C=async e=>await new Promise(n=>{let r=t("blocker");r.style.display==="block"&&(console.warn("Wasn't able to show another window (confirm)"),n(!1)),t("alertText").textContent=e;let s=t("cancelBtn"),i=t("confirmBtn");r.style.display="block",s.style.display="block";let o=async()=>{r.style.display="none",s.style.display="none",i.removeEventListener("click",o),s.removeEventListener("click",l),n(!0)},l=async()=>{r.style.display="none",s.style.display="none",i.removeEventListener("click",o),s.removeEventListener("click",l),n(!1)};i.addEventListener("click",o),s.addEventListener("click",l)}),H=async e=>await new Promise(n=>{let r=t("blocker");r.style.display==="block"&&(console.warn("Wasn't able to show another window (prompt)"),n(null)),t("alertText").textContent=e;let s=t("inputArea"),i="",o=t("cancelBtn"),l=t("confirmBtn");r.style.display="block",o.style.display="block",s.style.display="block";let g=()=>{i=s.value},f=async()=>{r.style.display="none",o.style.display="none",s.style.display="none",s.value="",l.removeEventListener("click",f),o.removeEventListener("click",d),s.removeEventListener("blur",g),n(i)},d=async()=>{r.style.display="none",o.style.display="none",s.style.display="none",s.value="",l.removeEventListener("click",f),o.removeEventListener("click",d),s.removeEventListener("blur",g),n(null)};l.addEventListener("click",f),o.addEventListener("click",d),s.addEventListener("blur",g)}),N=()=>{let e=t("footer"),n=t("footerColor"),r=t("hideToggle"),s=t("hideText"),i=t("hideArrow");c.footer=!c.footer,r.removeEventListener("click",N),c.footer?(n.style.display="",i.style.transform="",e.style.animation="hide 1s forwards reverse",i.style.animation="rotate 1s forwards reverse",s.textContent="Hide"):(e.style.animation="hide 1s backwards",i.style.animation="rotate 1s backwards",s.textContent="Show",setTimeout(()=>{n.style.display="none",i.style.transform="rotate(180deg)"},1e3)),setTimeout(()=>{e.style.animation="",i.style.animation="",r.addEventListener("click",N)},1e3)},M=(e=!1,n="toggle",r="building")=>{var s;switch(n){case"toggle":{let i=e,o=Boolean((s=localStorage.getItem("screen reader"))!=null?s:!1),l=t("screenReaderToggle");i&&(o=!o),o?(l.textContent="ON",l.style.borderColor="crimson",l.setAttribute("aria-label","Screen reader support is ON"),localStorage.setItem("screen reader","true"),c.screenReader=!0,u.buyToggle.strict=!1,c.intervals.main=100,c.intervals.numbers=1e3,i&&p(`For full support please refresh page. This will allow to buy upgrades on focus (because I have no idea how to make an image clickable with a keyboard), also you will get a special tab where you can check how much you own and more.
(For non screen readers this will cause issues)`)):(l.textContent="OFF",l.style.borderColor="",l.setAttribute("aria-label","Screen reader support is OFF"),localStorage.removeItem("screen reader"),c.screenReader=!1);break}case"button":{let i=e,{energy:o,buildings:l,upgrades:g,researchesAuto:f,toggles:d}=u,{dischargeInfo:y,buildingsInfo:a}=c,v=t("invisibleBought");r==="building"?i===0?v.textContent=`You have ${m(l[0].current)} ${a.name[0]}`:v.textContent=`You have ${m(l[i].current)} ${a.name[i]}, next one will cost ${m(a.cost[i])} ${a.name[i-1]}, they are producing ${m(a.producing[i])} ${a.name[i-1]} per second${f[1]>=i?`, auto is ${d[i+3]?"on":"off"}`:""}`:v.textContent=`You have ${o.current} Energy${g[3]===1?`, next discharge goal is ${m(y.next)} Energy`:""}`;break}}},R=(e=!1)=>{let n=document.body.style,r=t("customFontSize"),s=localStorage.getItem("fontSize");u.toggles[3]?((s===null||Number(s)<10||Number(s)>32||e)&&(s=String(Math.min(Math.max(Math.trunc(Number(r.value)*10)/10,10),32)),localStorage.setItem("fontSize",s)),n.setProperty("--font-size",`${s}px`),r.value=s):(n.setProperty("--font-size","1em"),localStorage.removeItem("fontSize"))};var u={stage:{true:1,current:0},energy:{current:0,total:0},discharge:{current:0},time:{updated:Date.now(),started:Date.now()},buildings:[{current:3,total:3},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0}],upgrades:[],researches:[],researchesAuto:[],toggles:[],buyToggle:{howMany:1,input:10,strict:!0}},c={tab:"stage",footer:!0,screenReader:!1,lastSave:0,energyType:[0,1,5,20],stageInfo:{word:["Microworld","Submerged"],resourceName:["Energy","Water drops"]},theme:{stage:1,default:!0},dischargeInfo:{next:1},intervals:{main:50,numbers:50,visual:1,autoSave:180},intervalsId:{main:0,numbers:0,visual:0,autoSave:0},buildingsInfo:{name:["Quarks","Particles","Atoms","Molecules"],cost:[0,3,24,3],increase:1.4,producing:[0,0,0,0]},upgradesInfo:{description:[],effect:[],effectText:[],cost:[]},researchesInfo:{description:[],effect:[],effectText:[],cost:[],scalling:[],max:[]},researchesAutoInfo:{description:[],effect:[],effectText:[],cost:[],scalling:[],max:[]}};function W(e,n,r,s,i,o=[],l=[]){Object.assign(u,{[e]:X(n.length)}),String(e).includes("researches")?Object.assign(c,{[e+"Info"]:{description:s,effect:r,effectText:i,cost:n,scalling:o,max:l}}):Object.assign(c,{[e+"Info"]:{description:s,effect:r,effectText:i,cost:n}})}var X=(e,n="number")=>{let r=[];for(let s=0;s<e;s++)n==="number"?r.push(0):s===4||s===5||s===6?r.push(!1):r.push(!0);return r},Z=document.getElementsByClassName("toggle").length;Object.assign(u,{toggles:X(Z,"toggles")});W("upgrades",[9,12,36,300,800,5e3,15e3,36e3],[10,10,5,4,.2,1.01,"",""],["Bigger electrons. Particles cost decreased.","Stronger protons. Particles produce more.","More neutrons. Increased gain of Particles.","Superposition. Unlocks new reset tier.","Protium. Basic.","Deuterium. Heavy.","Tritium. Radioactive.","Nuclear fusion. More energy."],[["Particle cost is "," times cheaper."],["Particles produce "," times more Quarks."],["Atoms produce "," times more Particles."],["Abbility to reset at any time and boost production for all buildings by ",", if had enough energy."],["Cost scalling is decreased by ","."],["Buildings (only bought one's) boost themselfs by "," times."],["Molecules produce Molecules. At a reduced rate.",""],["Unspent energy boost Molecules production of themselfs 1 to 1.",""]]);W("researches",[2e3,6500,2e4,12e3,42e3],[.01,.01,12,1,2],["Effect of 'Protium' upgrade is stronger.","Effect of 'Deuterium' upgrade is bigger.","Effect of 'Tritium' upgrade is better.","Discharge bonus improved.","Gain more energy from buying a building."],[["Cost scalling is "," smaller for each level."],["Each bought building boost each other by additional ","."],["Molecules now produce themselfs "," times quicker."],["Discharge is now gives extra +"," bonus per reached goal."],["A single building now gives "," times more energy."]],[300,1500,1800,0,38e3],[9,3,9,1,2]);W("researchesAuto",[300,3e3],["","Particles"],["Buy toggles.","Automatization for buying upgrades."],[["Unlock abbility to buy multiple buildings at same time.",""],["Will automatically buy "," for you."]],[0,5e3],[1,3]);var b=structuredClone(u),x=structuredClone(c),O=e=>{let n;return e==="p"?n=structuredClone(b):n=structuredClone(x),n},Q=e=>{if(Object.prototype.hasOwnProperty.call(e,"player")&&Object.prototype.hasOwnProperty.call(e,"global")){let n=O("p");for(let r in b)Object.prototype.hasOwnProperty.call(e.player,r)||(e.player[r]=n[r]);if(b.upgrades.length>e.player.upgrades.length)for(let r=e.player.upgrades.length;r<b.upgrades.length;r++)e.player.upgrades[r]=0;if(b.researches.length>e.player.researches.length)for(let r=e.player.researches.length;r<b.researches.length;r++)e.player.researches[r]=0;if(b.researchesAuto.length>e.player.researchesAuto.length)for(let r=e.player.researchesAuto.length;r<b.researchesAuto.length;r++)e.player.researchesAuto[r]=0;if(b.toggles.length>e.player.toggles.length)for(let r=e.player.toggles.length;r<b.toggles.length;r++)e.player.toggles[r]=n.toggles[r];e.player.stage.current===void 0&&(e.player.stage.current=e.player.stage.true),Object.assign(u,e.player),c.intervals=e.global.intervals}else p("Save file coudn't be loaded as its missing important info.")};var t=e=>{let n=document.getElementById(e);if(n!==null)return n;throw p("Some ID failed to load, game won't be working properly. Please refresh."),new TypeError(`ID "${e}" not found.`)},q=async(e=!1)=>{if(e){let s=localStorage.getItem("save"),i=localStorage.getItem("theme");if(s!==null){let o=JSON.parse(atob(s));Q(o),u.toggles[0]&&p(`Welcome back, you were away for ${m(Date.now()-u.time.updated,0,"time")}.`)}else p("Welcome. This is a test-project. Since I don't expect anyone to play this, save file can get corrupted with a new version.");i!==null&&(c.theme.default=!1,c.theme.stage=Number(i))}let{time:n,toggles:r}=u;M(),K(),S(),R();for(let s=0;s<b.toggles.length;s++)G(s,!1);$(),Y(),e&&!r[0]&&await C(`Welcome back, you were away for ${m(Date.now()-n.updated,0,"time")}. Game was set to have offline time disabled. Press confirm to NOT to gain offline time.`)&&(n.updated=Date.now()),h(!1,"all")};q(!0);var{screenReader:D}=c;for(let e=0;e<b.toggles.length;e++)t(`toggle${e}`).addEventListener("click",()=>G(e));for(let e=1;e<b.buildings.length;e++)t(`building${e}Btn`).addEventListener("click",()=>I(u.buildings,e));for(let e=0;e<b.upgrades.length;e++)t(`upgrade${e+1}`).addEventListener("mouseover",()=>T(e)),t(`upgrade${e+1}`).addEventListener("click",()=>k(e)),D&&t(`upgrade${e+1}`).addEventListener("focus",()=>k(e));t("dischargeReset").addEventListener("click",async()=>await _());t("stageReset").addEventListener("click",async()=>await V());t("buy1x").addEventListener("click",()=>$("1"));t("buyAny").addEventListener("click",()=>$("any"));t("buyAnyInput").addEventListener("blur",()=>$("any"));t("buyMax").addEventListener("click",()=>$("max"));t("buyStrict").addEventListener("click",()=>$("strict"));for(let e=0;e<b.researches.length;e++)t(`research${e+1}Stage1Image`).addEventListener("mouseover",()=>T(e,"researches")),t(`research${e+1}Stage1Image`).addEventListener("click",()=>k(e,"researches")),D&&t(`research${e+1}Stage1Image`).addEventListener("focus",()=>k(e,"researches"));for(let e=0;e<b.researchesAuto.length;e++)t(`researchAuto${e+1}Image`).addEventListener("mouseover",()=>T(e,"researchesAuto")),t(`researchAuto${e+1}Image`).addEventListener("click",()=>k(e,"researchesAuto")),D&&t(`researchAuto${e+1}Image`).addEventListener("focus",()=>k(e,"researchesAuto"));t("save").addEventListener("click",async()=>await E("save"));t("file").addEventListener("change",async()=>await E("load"));t("export").addEventListener("click",async()=>await E("export"));t("delete").addEventListener("click",async()=>await E("delete"));t("switchTheme0").addEventListener("click",()=>z(0,!0));for(let e=1;e<=c.stageInfo.word.length;e++)t(`switchTheme${e}`).addEventListener("click",()=>z(e));t("mainInterval").addEventListener("blur",()=>h(!1,"main"));t("numbersInterval").addEventListener("blur",()=>h(!1,"numbers"));t("visualInterval").addEventListener("blur",()=>h(!1,"visual"));t("autoSaveInterval").addEventListener("blur",()=>h(!1,"autoSave"));t("pauseGame").addEventListener("click",async()=>await ee());t("toggle3").addEventListener("click",()=>R());t("customFontSize").addEventListener("blur",()=>R(!0));t("screenReaderToggle").addEventListener("click",()=>M(!0));if(D){for(let e=0;e<b.buildings.length;e++)t(`invisibleGetBuilding${e}`).addEventListener("click",()=>M(e,"button"));t("invisibleGetResource1").addEventListener("click",()=>M(0,"button","resource")),t("specialTabBtn").addEventListener("click",()=>S("special"))}else t("specialTabBtn").style.display="none";t("hideToggle").addEventListener("click",N);t("stageTabBtn").addEventListener("click",()=>S("stage"));t("researchTabBtn").addEventListener("click",()=>S("research"));t("settingsTabBtn").addEventListener("click",()=>S("settings"));function h(e=!1,n=""){let{intervals:r,intervalsId:s}=c;if(n!==""){let i=t("mainInterval"),o=t("numbersInterval"),l=t("visualInterval"),g=t("autoSaveInterval");if(n==="main")r.main=Math.min(Math.max(Math.trunc(Number(i.value)),20),1e3),r.main>r.numbers&&(r.numbers=r.main);else if(n==="numbers"){let f=Math.min(Math.max(Math.trunc(Number(o.value)),20),1e3);r.numbers=Math.max(f,r.main)}else n==="visual"?r.visual=Math.min(Math.max(Math.trunc(Number(l.value)*10)/10,.5),10):n==="autoSave"&&(r.autoSave=Math.min(Math.max(Math.trunc(Number(g.value)),60),1800));i.value=String(r.main),o.value=String(r.numbers),l.value=String(r.visual),g.value=String(r.autoSave)}clearInterval(s.main),clearInterval(s.numbers),clearInterval(s.visual),clearInterval(s.autoSave),e||(s.main=setInterval(A,r.main),s.numbers=setInterval(L,r.numbers),s.visual=setInterval(j,r.visual*1e3),s.autoSave=setInterval(E,r.autoSave*1e3,"save"))}async function E(e){switch(e){case"load":{let n=t("file"),r=n.files;if(r===null)return p("Loaded file wasn't found.");let s=await r[0].text();try{let i=JSON.parse(atob(s));h(!0),Q(i),await C(`This save file was set to have offline progress disabled (currently ${m(Date.now()-u.time.updated,0,"time")}). Press confirm to NOT to gain offline time.`)&&(u.time.updated=Date.now()),q()}catch(i){p("Incorrect save file format.")}finally{n.value=""}break}case"save":{let n=btoa(`{"player":${JSON.stringify(u)},"global":{"intervals":${JSON.stringify(c.intervals)}}}`);localStorage.setItem("save",n),t("isSaved").textContent="Saved",c.lastSave=0;break}case"export":{await E("save");let n=localStorage.getItem("save");if(n===null)return p("Save file wasn't found. Even though game was saved just now...");let r=document.createElement("a");r.href="data:text/plain;charset=utf-8,"+n,r.download="Fundamental.txt",r.click();break}case"delete":{let n=await H(`This will truly delete your save file!
Type 'delete' to confirm.`);(n==null?void 0:n.toLowerCase())==="delete"?(h(!0),localStorage.clear(),Object.assign(u,O("p")),Object.assign(c,O("g")),u.time.started=Date.now(),u.time.updated=u.time.started,q()):n!==null&&n!==""&&p(`You wrote '${n}', so save file wasn't deleted.`);break}}}var ee=async()=>{h(!0);let e=await H("Game is currently paused. Press any button bellow to unpause it. If you want you can enter 'NoOffline' to NOT to gain offline time. Offline timer has a limit.");(e==null?void 0:e.toLowerCase())==="nooffline"?u.time.updated=Date.now():e!==null&&e!==""&&p(`You wrote '${e}', so you gained offline time.`),h()};})();
