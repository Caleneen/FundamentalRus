"use strict";(()=>{var U=e=>{let{stage:r,buildings:s}=u;switch(e){case"discharge":u.energy.current=0;for(let n=0;n<=3;n++)n===0?(s[0].current=3,s[0].total+=3):(s[n].current=0,s[n].true=0);break;case"stage":{let{upgrades:n,researches:o,researchesAuto:i}=u;switch(r.true){case 1:U("discharge"),u.energy.total=0,u.discharge.current=0;for(let a=0;a<=3;a++)a===0?(s[0].current=3,s[0].total=3):s[a].total=0;for(let a=0;a<m.upgrades.length;a++)n[a]=0;for(let a=0;a<m.researches.length;a++)o[a]=0;i[1]=0;break;case 2:for(let a=0;a<=1;a++)a===0?(s[0].current=1,s[0].total=1):(s[a].current=0,s[a].true=0,s[a].total=0);i[1]=0;break}break}}};var $=(e,r,s=!1)=>{let{stage:n,energy:o,researchesAuto:i,buyToggle:a}=u,{energyType:g,buildingsInfo:d}=c;if(e[r-1].current<d.cost[r]*(s?2:1)){c.screenReader&&!s&&(t("invisibleBought").textContent=`Coudn't buy '${d.name[r]}', because didn't had enough of '${d.name[r-1]}'`);return}if(n.true===1&&(g[r]=B.energyType[r]*2**u.researches[4]),a.howMany!==1&&i[0]>0||s){let b=e[r-1].current/(s?2:1),l=d.cost[r],C=0,D=s?-1:a.howMany;for(var f=0;b>=l&&f!==D;f++)C+=l,b-=l,l*=d.increase;if(f<D&&D!==-1&&a.strict)return;e[r-1].current-=C,e[r].current+=f,e[r].true+=f,e[r].total+=f,n.true===1&&(o.current+=g[r]*f,o.total+=g[r]*f,c.screenReader&&!s&&(t("invisibleBought").textContent=`Bought ${y(f)} '${d.name[r]}', gained ${y(g[r]*f)} energy`))}else(a.howMany===1||i[0]===0)&&(e[r-1].current-=d.cost[r],e[r].current++,e[r].true++,e[r].total++,n.true===1&&(o.current+=g[r],o.total+=g[r],c.screenReader&&(t("invisibleBought").textContent=`Bought 1 '${d.name[r]}', gained ${g[r]} energy`)));v(r),A(),T()},v=e=>{let{stage:r,buildings:s,upgrades:n,researches:o}=u,{buildingsInfo:i,upgradesInfo:a}=c;r.true===1&&(a.effect[4]=Math.trunc((.2+o[0]*.01)*100)/100,i.increase=Math.trunc((1.4-(n[4]===1?a.effect[4]:0))*100)/100),i.cost[e]=B.buildingsInfo.cost[e]*i.increase**s[e].true,e===1&&n[0]===1&&(i.cost[1]/=10)},P=(e,r)=>{u[r][e]!==c[r+"Info"].max[e]&&(c[r+"Info"].cost[e]=B[r+"Info"].cost[e]+c[r+"Info"].scalling[e]*u[r][e])},E=(e,r)=>{let{stage:s,buildings:n}=u,{buildingsInfo:o}=c,i=n[e].current;if(s.true===1&&e===3){if(o.producing[3]<=1)return;n[e].current+=Math.log(o.producing[e])*r*12**u.researches[2]*(u.upgrades[7]===1?u.energy.current:1)}else n[e].current+=o.producing[e+1]*r;n[e].total+=n[e].current-i},x=(e,r="normal")=>{let{energy:s,upgrades:n,researches:o,researchesAuto:i}=u,{upgradesInfo:a,researchesInfo:g,researchesAutoInfo:d}=c;switch(c.screenReader&&w(e,r),r){case"normal":if(n[e]===1||s.current<a.cost[e])return;if(n[e]=1,s.current-=a.cost[e],t(`upgrade${e+1}`).style.backgroundColor="green",e===0)v(1);else if(e===3)t("discharge").style.display="";else if(e===4)for(let f=1;f<=3;f++)v(f);c.screenReader&&(t("invisibleBought").textContent=`You have bought upgrade '${a.description[e]}'`);break;case"researches":{if(o[e]===g.max[e]||s.current<g.cost[e])return;let f=t(`research${e+1}Stage1Level`);if(o[e]++,s.current-=g.cost[e],f.textContent=String(o[e]),o[e]!==g.max[e]?f.classList.replace("redText","orchidText"):(f.classList.remove("redText","orchidText"),f.classList.add("greenText")),e===0)for(let b=1;b<=3;b++)v(b);c.screenReader&&(t("invisibleBought").textContent=`You have researched '${g.description[e]}', level is now ${o[e]} ${o[e]===g.max[e]?"maxed":""}`);break}case"researchesAuto":{if(i[e]===d.max[e]||s.current<d.cost[e])return;let f=t(`researchAuto${e+1}Level`);i[e]++,s.current-=d.cost[e],f.textContent=String(i[e]),i[e]!==d.max[e]?f.classList.replace("redText","orchidText"):(f.classList.remove("redText","orchidText"),f.classList.add("greenText")),c.screenReader&&(t("invisibleBought").textContent=`You have researched '${d.description[e]}', level is now ${i[e]} ${i[e]===d.max[e]?"maxed":""}`);break}}T(),r.includes("researches")&&P(e,r),w(e,r)},j=(e,r=!0)=>{var o,i,a,g;let{toggles:s}=u,n=t(`toggle${e}`);r&&(s[e]=!s[e]),n.classList.contains("auto")?s[e]?(n.textContent="Auto ON",n.style.borderColor=""):(n.textContent="Auto OFF",n.style.borderColor="crimson"):s[e]?(n.textContent="ON",n.style.borderColor="",c.screenReader&&(n.ariaLabel=(g=(a=n.ariaLabel)==null?void 0:a.replace(" OFF"," ON"))!=null?g:"")):(n.textContent="OFF",n.style.borderColor="crimson",c.screenReader&&(n.ariaLabel=(i=(o=n.ariaLabel)==null?void 0:o.replace(" ON"," OFF"))!=null?i:""))},k=(e="none")=>{let{buyToggle:r}=u,s=t("buyAnyInput");switch(e){case"1":r.howMany=1;break;case"max":r.howMany=-1;break;case"any":r.input=Math.max(Math.trunc(Number(s.value)),-1),r.input===0&&(r.input=1),r.howMany=r.input;break;case"strict":r.strict=!r.strict;break;default:s.value=String(r.input)}t("buyStrict").style.borderColor=r.strict?"":"crimson",t("buy1x").style.backgroundColor=r.howMany===1?"green":"",t("buyAny").style.backgroundColor=Math.abs(r.howMany)!==1?"green":"",t("buyMax").style.backgroundColor=r.howMany===-1?"green":""},J=async()=>{let{stage:e,buildings:r}=u;e.true===1&&(r[3].current>=1e21?h("There is nothing past stage 1 for now"):h("There are more molecules in a single drop than that you know."))},V=async()=>{let{energy:e}=u,{dischargeInfo:r}=c;if(u.upgrades[3]===1&&u.buildings[1].true>0&&u.stage.true===1){let s=!0;if(u.toggles[1]&&e.current<r.next?s=await L("This will reset all of your current buildings and energy. You will NOT gain production boost. Continue?"):u.toggles[1]&&e.current>=r.next&&(s=await L("You have enough energy to gain boost. Continue?")),s){e.current>=r.next?(r.next*=10,u.discharge.current++,c.screenReader&&(t("invisibleBought").textContent="Progress was reset for 4x boost")):c.screenReader&&e.current<r.next&&(t("invisibleBought").textContent="Buildings and energy were reset, no boost"),U("discharge");for(let n=1;n<c.buildingsInfo.name.length;n++)v(n);T()}}};var I=(e="none")=>{if(c.tab!==e){t("stageTab").style.display="none",t("stageTabBtn").style.borderColor="",t("researchTab").style.display="none",t("researchTabBtn").style.borderColor="",t("settingsTab").style.display="none",t("settingsTabBtn").style.borderColor="";let r=["#e3e3e3","#a10000"][c.theme.stage-1],s=t("invisibleTab");t("specialTab").style.display="none",e!=="none"?c.tab=e:c.tab="stage",t(`${c.tab}Tab`).style.display="",t(`${c.tab}TabBtn`).style.borderColor=r,s.textContent=`Current tab: ${c.tab} tab`,z(),T()}},A=()=>{let{stage:e,discharge:r,time:s,upgrades:n,researches:o,researchesAuto:i,buildings:a,toggles:g}=u,{buildingsInfo:d,upgradesInfo:f}=c,b=Date.now()-s.updated,l=b/1e3;if(s.updated=Date.now(),b<0)return console.warn("Negative passed time detected.");switch(c.lastSave+=b,l>3600&&(l=3600,console.log("Max offline progress is 1 hour.")),e.true){case 1:f.effect[5]=Math.trunc((1.02+.01*o[1])*100)/100,f.effect[3]=4+1*o[3],n[6]===1&&E(3,l),g[6]&&i[1]>=3&&$(a,3,!0),d.producing[3]=.3*a[3].current*f.effect[3]**r.current,n[5]===1&&(d.producing[3]*=f.effect[5]**a[3].true),E(2,l),g[5]&&i[1]>=2&&$(a,2,!0),d.producing[2]=.4*a[2].current*f.effect[3]**r.current,n[2]===1&&(d.producing[2]*=5),n[5]===1&&(d.producing[2]*=f.effect[5]**a[2].true),E(1,l),g[4]&&i[1]>=1&&$(a,1,!0),d.producing[1]=.5*a[1].current*f.effect[3]**r.current,n[1]===1&&(d.producing[1]*=10),n[5]===1&&(d.producing[1]*=f.effect[5]**a[1].true),E(0,l);break}},T=()=>{let{stage:e,energy:r,buildings:s,upgrades:n}=u,{tab:o,lastSave:i,dischargeInfo:a,buildingsInfo:g,upgradesInfo:d}=c;c.footer&&(e.true===1&&(t("quarks").textContent=`Quarks: ${y(s[0].current)}`),r.total>=9&&e.true===1&&(t("energy").textContent=`Energy: ${y(r.current,0)}`)),o==="stage"&&e.true===1&&(t("building1Cur").textContent=y(s[1].current),t("building1Prod").textContent=y(g.producing[1]),g.cost[1]<=s[0].current?(t("building1Btn").classList.add("availableBuilding"),t("building1Btn").textContent=`Buy for: ${y(g.cost[1])} Quarks`):(t("building1Btn").classList.remove("availableBuilding"),t("building1Btn").textContent=`Need: ${y(g.cost[1])} Quarks`),s[1].total>=11&&(t("building2Cur").textContent=y(s[2].current),t("building2Prod").textContent=y(g.producing[2]),g.cost[2]<=s[1].current?(t("building2Btn").classList.add("availableBuilding"),t("building2Btn").textContent=`Buy for: ${y(g.cost[2])} Particles`):(t("building2Btn").classList.remove("availableBuilding"),t("building2Btn").textContent=`Need: ${y(g.cost[2])} Particles`)),s[2].total>=2&&(t("building3Cur").textContent=y(s[3].current),t("building3Prod").textContent=y(g.producing[3]),g.cost[3]<=s[2].current?(t("building3Btn").classList.add("availableBuilding"),t("building3Btn").textContent=`Buy for: ${y(g.cost[3])} Atoms`):(t("building3Btn").classList.remove("availableBuilding"),t("building3Btn").textContent=`Need: ${y(g.cost[3])} Atoms`)),n[3]===1&&(t("dischargeReset").textContent=`Next goal is ${y(a.next,0)} energy`,t("dischargeEffect").textContent=String(d.effect[3]))),o==="settings"&&i>=1e3&&(t("isSaved").textContent=`${y(i,0,"time")} ago`)},z=()=>{let{stage:e,energy:r,discharge:s,buildings:n,upgrades:o,researchesAuto:i}=u;if(e.true===1){t("energyStat").style.display=r.total>=9?"":"none",t("atomsMain").style.display=n[1].total>=11?"":"none",t("moleculesMain").style.display=n[2].total>=2?"":"none",t("discharge").style.display=o[3]>0?"":"none";for(let a=5;a<=8;a++)s.current>=3?t(`upgrade${a}`).style.display="":t(`upgrade${a}`).style.display="none";n[3].current>=1e21&&(t("stageReset").textContent="Enter next stage"),c.screenReader&&(t("invisibleGetBuilding2").style.display=n[2].total>0?"":"none",t("invisibleGetBuilding3").style.display=n[3].total>0?"":"none")}t("upgrades").style.display=r.total>=9||e.true>1?"":"none",t("resetToggles").style.display=s.current>=1||e.true>1?"":"none",t("researchTabBtn").style.display=s.current>=4||e.true!==1?"":"none",t("toggleBuy").style.display=i[0]>0?"":"none";for(let a=1;a<=3;a++)i[1]>=a?t(`toggle${a+3}`).style.display="":t(`toggle${a+3}`).style.display="none";t("stage").style.display=o[7]===1||e.true>1?"":"none",t("stageToggleReset").style.display=e.true>1?"":"none",t("themeArea").style.display=e.true>1?"":"none"},w=(e,r="normal")=>{let{upgrades:s,researches:n,researchesAuto:o}=u,{buildingsInfo:i,upgradesInfo:a,researchesInfo:g,researchesAutoInfo:d}=c;switch(r){case"normal":t("upgradeText").textContent=a.description[e],t("upgradeEffect").textContent=`${a.effectText[e][0]}${a.effect[e]}${a.effectText[e][1]}`,t("upgradeCost").textContent=`${s[e]===1?0:a.cost[e]} Energy.`;break;case"researches":t("researchText").textContent=g.description[e],t("researchEffect").textContent=`${g.effectText[e][0]}${g.effect[e]}${g.effectText[e][1]}`,t("researchCost").textContent=`${n[e]===g.max[e]?0:g.cost[e]} Energy.`;break;case"researchesAuto":t("researchText").textContent=d.description[e],e===1&&(d.effect[1]=i.name[Math.min(o[1]+1,i.name.length-1)]),t("researchEffect").textContent=`${d.effectText[e][0]}${d.effect[e]}${d.effectText[e][1]}`,t("researchCost").textContent=`${o[e]===d.max[e]?0:d.cost[e]} Energy.`;break}},y=(e,r=e<1e3?2:0,s="number")=>{switch(s){case"number":if(r>0&&e<1e6)return String(Math.trunc(e*10**r)/10**r);if(r<=0&&e<1e6)return String(Math.trunc(e));{let n=Math.trunc(Math.log10(e));return`${Math.trunc(e/10**n*100)/100}e${n}`}case"time":return e>=1728e5?`${Math.trunc(e/864e5)} days`:e>=72e5?`${Math.trunc(e/36e5)} hours`:e>=6e5?`${Math.trunc(e/6e4)} minutes`:`${Math.trunc(e/1e3)} seconds`}},_=()=>{let{stage:e,discharge:r,upgrades:s,researches:n,researchesAuto:o}=u,{stageInfo:i,dischargeInfo:a,buildingsInfo:g,researchesInfo:d,researchesAutoInfo:f}=c,b=document.body.style;if(e.true===1){a.next=10**r.current;for(let l=0;l<m.upgrades.length;l++)s[l]===1?t(`upgrade${[l+1]}`).style.backgroundColor="green":t(`upgrade${[l+1]}`).style.backgroundColor="";for(let l=0;l<m.researches.length;l++)t(`research${l+1}Stage1Level`).textContent=String(n[l]),t(`research${l+1}Stage1Level`).classList.remove("redText","orchidText","greenText"),P(l,"researches"),n[l]===d.max[l]?t(`research${l+1}Stage1Level`).classList.add("greenText"):n[l]===0?t(`research${l+1}Stage1Level`).classList.add("redText"):t(`research${l+1}Stage1Level`).classList.add("orchidText");t("quarkStat").style.display="",t("particlesMain").style.display="",t("dischargeToggleReset").style.display="";for(let l=1;l<=4;l++)t(`upgrade${l}`).style.display="";for(let l=1;l<=m.researches.length;l++)t(`research${l}Stage1`).style.display=""}for(let l=1;l<g.name.length;l++)v(l);for(let l=0;l<m.researchesAuto.length;l++)t(`researchAuto${l+1}Level`).textContent=String(o[l]),t(`researchAuto${l+1}Level`).classList.remove("redText","orchidText","greenText"),P(l,"researchesAuto"),o[l]===f.max[l]?t(`researchAuto${l+1}Level`).classList.add("greenText"):o[l]===0?t(`researchAuto${l+1}Level`).classList.add("redText"):t(`researchAuto${l+1}Level`).classList.add("orchidText");if(e.true!==1){t("quarkStat").style.display="none",t("energyStat").style.display="none",t("particlesMain").style.display="none",t("atomsMain").style.display="none",t("moleculesMain").style.display="none",t("discharge").style.display="none",t("dischargeToggleReset").style.display="none";for(let l=1;l<=m.upgrades.length;l++)t(`upgrade${l}`).style.display="none";for(let l=1;l<=m.researches.length;l++)t(`research${l}Stage1`).style.display="none"}t("stageReset").textContent="You are not ready",t("stageWord").textContent=i.word[e.true-1],t("stageWord").style.color=i.wordColor[e.true-1],e.true===1?(b.removeProperty("--border-image"),b.removeProperty("--border-stage")):(b.setProperty("--border-image",`url(Used_art/Stage${e.true}%20border.png)`),e.true===2?b.setProperty("--border-stage","#1460a8"):e.true===3?b.setProperty("--border-stage","#5b5b75"):b.setProperty("--border-stage","#f28100")),c.screenReader&&(t("invisibleBought").textContent=`Current stage is '${i.word[e.true-1]}'`)};var G=(e,r=!1)=>{let{theme:s}=c;r?(s.default=!0,localStorage.removeItem("theme")):(s.default=!1,s.stage=e,localStorage.setItem("theme",String(e))),Y()},Y=()=>{let{stage:e}=u,{stageInfo:r,theme:s}=c,n=document.body.style;switch(n.setProperty("--transition","1s"),s.default?(s.stage=e.true,t("currentTheme").textContent="Default"):t("currentTheme").textContent=r.word[s.stage-1],n.removeProperty("--background-color"),n.removeProperty("--window-color"),n.removeProperty("--window-border"),n.removeProperty("--footer-color"),n.removeProperty("--button-main-color"),n.removeProperty("--button-main-border"),n.removeProperty("--button-main-hover"),n.removeProperty("--stage-text-color"),n.removeProperty("--cyan-text-color"),n.removeProperty("--blue-text-color"),s.stage){case 2:n.setProperty("--background-color","#070026"),n.setProperty("--window-color","#000052"),n.setProperty("--window-border","blue"),n.setProperty("--footer-color","#0000db"),n.setProperty("--button-main-color","blue"),n.setProperty("--button-main-border","#427be1"),n.setProperty("--button-main-hover","#1515cf"),n.setProperty("--stage-text-color","dodgerblue"),n.setProperty("--cyan-text-color","cyan"),n.setProperty("--blue-text-color","#82cb3b");break}setTimeout(()=>{n.removeProperty("--transition")},1e3)},h=e=>{let r=t("blocker");if(t("blocker").style.display==="block")return console.warn("Wasn't able to show another window (alert)");t("alertText").textContent=e;let s=t("confirmBtn");r.style.display="block";let n=()=>{r.style.display="none",s.removeEventListener("click",n)};s.addEventListener("click",n)},L=async e=>await new Promise(r=>{let s=t("blocker");s.style.display==="block"&&(console.warn("Wasn't able to show another window (confirm)"),r(!1)),t("alertText").textContent=e;let n=t("cancelBtn"),o=t("confirmBtn");s.style.display="block",n.style.display="block";let i=async()=>{s.style.display="none",n.style.display="none",o.removeEventListener("click",i),n.removeEventListener("click",a),r(!0)},a=async()=>{s.style.display="none",n.style.display="none",o.removeEventListener("click",i),n.removeEventListener("click",a),r(!1)};o.addEventListener("click",i),n.addEventListener("click",a)}),H=async e=>await new Promise(r=>{let s=t("blocker");s.style.display==="block"&&(console.warn("Wasn't able to show another window (prompt)"),r(null)),t("alertText").textContent=e;let n=t("inputArea"),o="",i=t("cancelBtn"),a=t("confirmBtn");s.style.display="block",i.style.display="block",n.style.display="block";let g=()=>{o=n.value},d=async()=>{s.style.display="none",i.style.display="none",n.style.display="none",n.value="",a.removeEventListener("click",d),i.removeEventListener("click",f),n.removeEventListener("blur",g),r(o)},f=async()=>{s.style.display="none",i.style.display="none",n.style.display="none",n.value="",a.removeEventListener("click",d),i.removeEventListener("click",f),n.removeEventListener("blur",g),r(null)};a.addEventListener("click",d),i.addEventListener("click",f),n.addEventListener("blur",g)}),O=()=>{let e=t("footer"),r=t("footerColor"),s=t("hideToggle"),n=t("hideText"),o=t("hideArrow");c.footer=!c.footer,s.removeEventListener("click",O),c.footer?(r.style.display="",o.style.transform="",e.style.animation="hide 1s forwards reverse",o.style.animation="rotate 1s forwards reverse",n.textContent="Hide"):(e.style.animation="hide 1s backwards",o.style.animation="rotate 1s backwards",n.textContent="Show",setTimeout(()=>{r.style.display="none",o.style.transform="rotate(180deg)"},1e3)),setTimeout(()=>{e.style.animation="",o.style.animation="",s.addEventListener("click",O)},1e3)},M=(e=!1,r="toggle",s="building")=>{var n;switch(r){case"toggle":{let o=e,i=Boolean((n=localStorage.getItem("screen reader"))!=null?n:!1),a=t("screenReaderToggle");o&&(i=!i),i?(a.textContent="ON",a.style.borderColor="crimson",a.setAttribute("aria-label","Screen reader support is ON"),localStorage.setItem("screen reader","true"),c.screenReader=!0,u.buyToggle.strict=!1,c.intervals.main=100,c.intervals.numbers=1e3,o&&h(`For full support please refresh page. This will allow to buy upgrades on focus (because I have no idea how to make an image clickable with a keyboard), also you will get a special tab where you can check how much you own and more.
(For non screen readers this will cause issues)`)):(a.textContent="OFF",a.style.borderColor="",a.setAttribute("aria-label","Screen reader support is OFF"),localStorage.removeItem("screen reader"),c.screenReader=!1);break}case"button":{let o=e,{energy:i,buildings:a,upgrades:g,researchesAuto:d,toggles:f}=u,{dischargeInfo:b,buildingsInfo:l}=c,C=t("invisibleBought");s==="building"?o===0?C.textContent=`You have ${y(a[0].current)} ${l.name[0]}`:C.textContent=`You have ${y(a[o].current)} ${l.name[o]}, next one will cost ${y(l.cost[o])} ${l.name[o-1]}, they are producing ${y(l.producing[o])} ${l.name[o-1]} per second${d[1]>=o?`, auto is ${f[o+3]?"on":"off"}`:""}`:C.textContent=`You have ${i.current} Energy${g[3]===1?`, next discharge goal is ${y(b.next)} Energy`:""}`;break}}},R=(e=!1)=>{let r=document.body.style,s=t("customFontSize"),n=localStorage.getItem("fontSize");u.toggles[3]?((n===null||Number(n)<10||Number(n)>32||e)&&(n=String(Math.min(Math.max(Math.trunc(Number(s.value)*10)/10,10),32)),localStorage.setItem("fontSize",n)),r.setProperty("--font-size",`${n}px`),s.value=n):(r.setProperty("--font-size","1em"),localStorage.removeItem("fontSize"))};var u={stage:{true:1},energy:{current:0,total:0},discharge:{current:0},time:{updated:Date.now(),started:Date.now()},buildings:[{current:3,total:3},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0}],upgrades:[],researches:[],researchesAuto:[],toggles:[],buyToggle:{howMany:1,input:10,strict:!0}},c={tab:"stage",footer:!0,screenReader:!1,lastSave:0,energyType:[0,1,5,20],stageInfo:{word:["Microworld","Submerged"],wordColor:["#03d3d3","dodgerblue"]},theme:{stage:1,default:!0},dischargeInfo:{next:1},intervals:{main:50,numbers:50,visual:1,autoSave:180},intervalsId:{main:0,numbers:0,visual:0,autoSave:0},buildingsInfo:{name:["Quarks","Particles","Atoms","Molecules"],cost:[0,3,24,3],increase:1.4,producing:[0,0,0,0]},upgradesInfo:{description:[],effect:[],effectText:[],cost:[]},researchesInfo:{description:[],effect:[],effectText:[],cost:[],scalling:[],max:[]},researchesAutoInfo:{description:[],effect:[],effectText:[],cost:[],scalling:[],max:[]}};function W(e,r,s,n,o,i=[],a=[]){Object.assign(u,{[e]:K(r.length)}),String(e).includes("researches")?Object.assign(c,{[e+"Info"]:{description:n,effect:s,effectText:o,cost:r,scalling:i,max:a}}):Object.assign(c,{[e+"Info"]:{description:n,effect:s,effectText:o,cost:r}})}var K=(e,r="number")=>{let s=[];for(let n=0;n<e;n++)r==="number"?s.push(0):n===4||n===5||n===6?s.push(!1):s.push(!0);return s},X=document.getElementsByClassName("toggle").length;Object.assign(u,{toggles:K(X,"toggles")});W("upgrades",[9,12,36,300,800,5e3,15e3,36e3],[10,10,5,4,.2,1.01,"",""],["Bigger electrons. Particles cost decreased.","Stronger protons. Particles produce more.","More neutrons. Increased gain of Particles.","Superposition. Unlocks new reset tier.","Protium. Basic.","Deuterium. Heavy.","Tritium. Radioactive.","Nuclear fusion. More energy."],[["Particle cost is "," times cheaper."],["Particles produce "," times more Quarks."],["Atoms produce "," times more Particles."],["Abbility to reset at any time and boost production for all buildings by ",", if had enough energy."],["Cost scalling is decreased by ","."],["Buildings (only bought one's) boost themselfs by "," times."],["Molecules produce Molecules. At a reduced rate.",""],["Unspent energy boost Molecules production of themselfs 1 to 1.",""]]);W("researches",[2e3,6500,2e4,12e3,42e3],[.01,.01,12,1,2],["Effect of 'Protium' upgrade is stronger.","Effect of 'Deuterium' upgrade is bigger.","Effect of 'Tritium' upgrade is better.","Discharge bonus improved.","Gain more energy from buying a building."],[["Cost scalling is "," smaller for each level."],["Each bought building boost each other by additional ","."],["Molecules now produce themselfs "," times quicker."],["Discharge is now gives extra +"," bonus per reached goal."],["A single building now gives "," times more energy."]],[300,1500,1800,0,38e3],[9,3,9,1,2]);W("researchesAuto",[300,3e3],["","Particles"],["Buy toggles.","Automatization for buying upgrades."],[["Unlock abbility to buy multiple buildings at same time.",""],["Will automatically buy "," for you."]],[0,5e3],[1,3]);var m=structuredClone(u),B=structuredClone(c),N=e=>{let r;return e==="p"?r=structuredClone(m):r=structuredClone(B),r},Q=e=>{if(Object.prototype.hasOwnProperty.call(e,"player")&&Object.prototype.hasOwnProperty.call(e,"global")){let r=N("p");for(let s in m)Object.prototype.hasOwnProperty.call(e.player,s)||(e.player[s]=r[s]);if(m.upgrades.length>e.player.upgrades.length)for(let s=e.player.upgrades.length;s<m.upgrades.length;s++)e.player.upgrades[s]=0;if(m.researches.length>e.player.researches.length)for(let s=e.player.researches.length;s<m.researches.length;s++)e.player.researches[s]=0;if(m.researchesAuto.length>e.player.researchesAuto.length)for(let s=e.player.researchesAuto.length;s<m.researchesAuto.length;s++)e.player.researchesAuto[s]=0;if(m.toggles.length>e.player.toggles.length)for(let s=e.player.toggles.length;s<m.toggles.length;s++)e.player.toggles[s]=r.toggles[s];Object.assign(u,e.player),c.intervals=e.global.intervals}else h("Save file coudn't be loaded as its missing important info.")};var t=e=>{let r=document.getElementById(e);if(r!==null)return r;throw h("Some ID failed to load, game won't be working properly. Please refresh."),new TypeError(`ID "${e}" not found.`)},q=async(e=!1)=>{if(e){let n=localStorage.getItem("save"),o=localStorage.getItem("theme");if(n!==null){let i=JSON.parse(atob(n));Q(i),u.toggles[0]&&h(`Welcome back, you were away for ${y(Date.now()-u.time.updated,0,"time")}.`)}else h("Welcome. This is a test-project. Since I don't expect anyone to play this, save file can get corrupted with a new version.");o!==null&&(c.theme.default=!1,c.theme.stage=Number(o))}let{time:r,toggles:s}=u;M(),I(),R(),_();for(let n=0;n<m.toggles.length;n++)j(n,!1);k(),Y(),e&&!s[0]&&await L(`Welcome back, you were away for ${y(Date.now()-r.updated,0,"time")}. Game was set to have offline time disabled. Press confirm to NOT to gain offline time.`)&&(r.updated=Date.now()),p(!1,"all")};q(!0);var{screenReader:F}=c;for(let e=0;e<m.toggles.length;e++)t(`toggle${e}`).addEventListener("click",()=>j(e));for(let e=1;e<m.buildings.length;e++)t(`building${e}Btn`).addEventListener("click",()=>$(u.buildings,e));for(let e=0;e<m.upgrades.length;e++)t(`upgrade${e+1}`).addEventListener("mouseover",()=>w(e)),t(`upgrade${e+1}`).addEventListener("click",()=>x(e)),F&&t(`upgrade${e+1}`).addEventListener("focus",()=>x(e));t("dischargeReset").addEventListener("click",async()=>await V());t("stageReset").addEventListener("click",async()=>await J());t("buy1x").addEventListener("click",()=>k("1"));t("buyAny").addEventListener("click",()=>k("any"));t("buyAnyInput").addEventListener("blur",()=>k("any"));t("buyMax").addEventListener("click",()=>k("max"));t("buyStrict").addEventListener("click",()=>k("strict"));for(let e=0;e<m.researches.length;e++)t(`research${e+1}Stage1Image`).addEventListener("mouseover",()=>w(e,"researches")),t(`research${e+1}Stage1Image`).addEventListener("click",()=>x(e,"researches")),F&&t(`research${e+1}Stage1Image`).addEventListener("focus",()=>x(e,"researches"));for(let e=0;e<m.researchesAuto.length;e++)t(`researchAuto${e+1}Image`).addEventListener("mouseover",()=>w(e,"researchesAuto")),t(`researchAuto${e+1}Image`).addEventListener("click",()=>x(e,"researchesAuto")),F&&t(`researchAuto${e+1}Image`).addEventListener("focus",()=>x(e,"researchesAuto"));t("save").addEventListener("click",async()=>await S("save"));t("file").addEventListener("change",async()=>await S("load"));t("export").addEventListener("click",async()=>await S("export"));t("delete").addEventListener("click",async()=>await S("delete"));t("switchTheme0").addEventListener("click",()=>G(0,!0));for(let e=1;e<=c.stageInfo.word.length;e++)t(`switchTheme${e}`).addEventListener("click",()=>G(e));t("mainInterval").addEventListener("blur",()=>p(!1,"main"));t("numbersInterval").addEventListener("blur",()=>p(!1,"numbers"));t("visualInterval").addEventListener("blur",()=>p(!1,"visual"));t("autoSaveInterval").addEventListener("blur",()=>p(!1,"autoSave"));t("pauseGame").addEventListener("click",async()=>await Z());t("toggle3").addEventListener("click",()=>R());t("customFontSize").addEventListener("blur",()=>R(!0));t("screenReaderToggle").addEventListener("click",()=>M(!0));if(F){for(let e=0;e<m.buildings.length;e++)t(`invisibleGetBuilding${e}`).addEventListener("click",()=>M(e,"button"));t("invisibleGetResource1").addEventListener("click",()=>M(0,"button","resource")),t("specialTabBtn").addEventListener("click",()=>I("special"))}else t("specialTabBtn").style.display="none";t("hideToggle").addEventListener("click",O);t("stageTabBtn").addEventListener("click",()=>I("stage"));t("researchTabBtn").addEventListener("click",()=>I("research"));t("settingsTabBtn").addEventListener("click",()=>I("settings"));function p(e=!1,r=""){let{intervals:s,intervalsId:n}=c;if(r!==""){let o=t("mainInterval"),i=t("numbersInterval"),a=t("visualInterval"),g=t("autoSaveInterval");if(r==="main")s.main=Math.min(Math.max(Math.trunc(Number(o.value)),20),1e3),s.main>s.numbers&&(s.numbers=s.main);else if(r==="numbers"){let d=Math.min(Math.max(Math.trunc(Number(i.value)),20),1e3);s.numbers=Math.max(d,s.main)}else r==="visual"?s.visual=Math.min(Math.max(Math.trunc(Number(a.value)*10)/10,.5),10):r==="autoSave"&&(s.autoSave=Math.min(Math.max(Math.trunc(Number(g.value)),60),1800));o.value=String(s.main),i.value=String(s.numbers),a.value=String(s.visual),g.value=String(s.autoSave)}clearInterval(n.main),clearInterval(n.numbers),clearInterval(n.visual),clearInterval(n.autoSave),e||(n.main=setInterval(A,s.main),n.numbers=setInterval(T,s.numbers),n.visual=setInterval(z,s.visual*1e3),n.autoSave=setInterval(S,s.autoSave*1e3,"save"))}async function S(e){switch(e){case"load":{let r=t("file"),s=r.files;if(s===null)return h("Loaded file wasn't found.");let n=await s[0].text();try{let o=JSON.parse(atob(n));p(!0),Q(o),await L(`This save file was set to have offline progress disabled (currently ${y(Date.now()-u.time.updated,0,"time")}). Press confirm to NOT to gain offline time.`)&&(u.time.updated=Date.now()),q()}catch(o){h("Incorrect save file format.")}finally{r.value=""}break}case"save":{let r=btoa(`{"player":${JSON.stringify(u)},"global":{"intervals":${JSON.stringify(c.intervals)}}}`);localStorage.setItem("save",r),t("isSaved").textContent="Saved",c.lastSave=0;break}case"export":{await S("save");let r=localStorage.getItem("save");if(r===null)return h("Save file wasn't found. Even though game was saved just now...");let s=document.createElement("a");s.href="data:text/plain;charset=utf-8,"+r,s.download="Fundamental.txt",s.click();break}case"delete":{let r=await H(`This will truly delete your save file!
Type 'delete' to confirm.`);(r==null?void 0:r.toLowerCase())==="delete"?(p(!0),localStorage.clear(),Object.assign(u,N("p")),Object.assign(c,N("g")),u.time.started=Date.now(),u.time.updated=u.time.started,q()):r!==null&&r!==""&&h(`You wrote '${r}', so save file wasn't deleted.`);break}}}var Z=async()=>{p(!0);let e=await H("Game is currently paused. Press any button bellow to unpause it. If you want you can enter 'NoOffline' to NOT to gain offline time. Offline timer has a limit.");(e==null?void 0:e.toLowerCase())==="nooffline"?u.time.updated=Date.now():e!==null&&e!==""&&h(`You wrote '${e}', so you gained offline time.`),p()};})();
