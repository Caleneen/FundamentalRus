"use strict";(()=>{var V=e=>{let{stage:s,buildings:r}=i;switch(e){case"discharge":i.energy.current=0;for(let n=0;n<p.buildings.length;n++)n===0?(r[0].current=3,r[0].total+=3):(r[n].current=0,r[n].true=0,v(n));break;case"stage":{i.upgrades=[],i.researches=[];let{upgrades:n,researches:l}=i;for(let a=1;a<p.buildings.length;a++)r[a].current=0,r[a].true=0,r[a].total=0;switch(s.current){case 1:i.energy.current=0,i.energy.total=0,i.discharge.current=0,r[0].current=3,r[0].total=3;for(let a=0;a<o.upgradesInfo.cost.length;a++)n[a]=0;for(let a=0;a<o.researchesInfo.cost.length;a++)l[a]=0;break;case 2:r[0].current=.0028,r[0].total=.0028;for(let a=0;a<o.upgradesS2Info.cost.length;a++)n[a]=0;for(let a=0;a<o.researchesS2Info.cost.length;a++)l[a]=0;break}W(),B(),P();break}}T()};var k=(e,s=!1)=>{let{stage:r,buildings:n}=i,{buildingsInfo:l,screenReader:a}=o,d=e-1;if(r.current===2&&e>2&&(d=1),!isFinite(l.cost[e])){a&&!s&&(t("invisibleBought").textContent=`Coudn't buy '${l.name[e]}', because cost is infinity`);return}if(n[d].current<l.cost[e]*(s?2:1)){a&&!s&&(t("invisibleBought").textContent=`Coudn't buy '${l.name[e]}', because didn't had enough of '${l.name[d]}'`);return}let{researchesAuto:g,buyToggle:c}=i,{stageInfo:f}=o;if(r.current===1&&(o.energyType[e]=x.energyType[e]*3**i.researches[4]),c.howMany!==1&&g[0]>0||s){let h=n[d].current;s&&(h/=2);let N=l.cost[e],Q=0,H=s?-1:c.howMany;for(var u=0;h>=N&&u!==H;u++)Q+=N,h-=N,N*=l.increase;if(u<H&&H!==-1&&c.strict)return;n[d].current-=Q,n[e].current+=u,n[e].true+=u,n[e].total+=u,r.current===1&&(i.energy.current+=o.energyType[e]*u,i.energy.total+=o.energyType[e]*u),o.screenReader&&!s&&(t("invisibleBought").textContent=`Bought ${y(u)} '${l.name[e]}'${r.current===1?`, gained ${y(o.energyType[e]*u)} ${f.resourceName[r.current]}`:""}`)}else(c.howMany===1||g[0]===0)&&(n[d].current-=l.cost[e],n[e].current++,n[e].true++,n[e].total++,r.current===1&&(i.energy.current+=o.energyType[e],i.energy.total+=o.energyType[e]),o.screenReader&&(t("invisibleBought").textContent=`Bought 1 '${l.name[e]}'${r.current===1?`, gained ${o.energyType[e]} ${f.resourceName[r.current]}`:""}`));v(e),F(),T()},v=e=>{let{stage:s,buildings:r,upgrades:n,researches:l}=i,{buildingsInfo:a}=o;s.current===1&&(o.upgradesInfo.effect[4]=Math.trunc((.2+l[0]*.01)*100)/100,a.increase=Math.trunc((1.4-(n[4]===1?o.upgradesInfo.effect[4]:0))*100)/100),a.cost[e]=x.buildingsInfo.cost[e]*a.increase**r[e].true,s.current===1&&e===1&&n[0]===1&&(a.cost[1]/=10)},A=(e,s,r=s+"Info")=>{i[s][e]!==o[r].max[e]&&(i.stage.current===1?o[r].cost[e]=x[r].cost[e]+o[r].scalling[e]*i[s][e]:o[r].cost[e]=Math.trunc(x[r].cost[e]*o[r].scalling[e]**i[s][e]))},S=(e,s)=>{let{buildings:r}=i,{buildingsInfo:n}=o,l=r[e].current,a;if(i.stage.current===1&&e===3){if(n.producing[3]<=1)return;a=Math.log(n.producing[e])*s*12**i.researches[2],i.upgrades[7]===1&&(a*=i.energy.current)}else a=n.producing[e+1]*s;let d=r[e].current+a;if(isFinite(d))r[e].current=d;else return;d=r[e].total+(r[e].current-l),isFinite(d)&&(r[e].total=d)},b=(e,s="upgrades",r=s+"Info")=>{let{stage:n}=i,l;if(n.current===1?l=i.energy:l=i.buildings[1],s!=="upgrades"){if(i[s][e]===o[r].max[e]||l.current<o[r].cost[e])return;i[s][e]++,l.current-=o[r].cost[e];let a;if(s==="researchesAuto"?a=t(`researchAuto${e+1}Level`):n.current===1?a=t(`research${e+1}Level`):a=t(`researchW${e+1}Level`),a.textContent=String(i[s][e]),i[s][e]!==o[r].max[e]?a.classList.replace("redText","orchidText"):(a.classList.remove("redText","orchidText"),a.classList.add("greenText")),n.current===1&&s==="researches"&&e===0)for(let d=1;d<o.buildingsInfo.name.length;d++)v(d);o.screenReader&&(t("invisibleBought").textContent=`You have researched '${o[r].description[e]}', level is now ${i[s][e]} ${i[s][e]===o[r].max[e]?"maxed":""}`),A(e,s,r)}else{if(i[s][e]===1||l.current<o[r].cost[e])return;i[s][e]=1,l.current-=o[r].cost[e];let a;if(n.current===1?a=t(`upgrade${e+1}`):a=t(`upgradeW${e+1}`),a.style.backgroundColor="green",n.current===1){if(e===0)v(1);else if(e===3)t("discharge").style.display="";else if(e===4)for(let d=1;d<o.buildingsInfo.name.length;d++)v(d)}o.screenReader&&(t("invisibleBought").textContent=`You have bought upgrade '${o[r].description[e]}'`)}T(),I(e,s,r)},z=(e,s=!0)=>{var l,a,d,g;let{toggles:r}=i,n=t(`toggle${e}`);s&&(r[e]=!r[e]),n.classList.contains("auto")?r[e]?(n.textContent="Auto ON",n.style.borderColor=""):(n.textContent="Auto OFF",n.style.borderColor="crimson"):r[e]?(n.textContent="ON",n.style.borderColor="",o.screenReader&&(n.ariaLabel=(g=(d=n.ariaLabel)==null?void 0:d.replace(" OFF"," ON"))!=null?g:"")):(n.textContent="OFF",n.style.borderColor="crimson",o.screenReader&&(n.ariaLabel=(a=(l=n.ariaLabel)==null?void 0:l.replace(" ON"," OFF"))!=null?a:""))},$=(e="none")=>{let{buyToggle:s}=i,r=t("buyAnyInput");switch(e){case"1":s.howMany=1;break;case"max":s.howMany=-1;break;case"any":s.input=Math.max(Math.trunc(Number(r.value)),-1),s.input===0&&(s.input=1),s.howMany=s.input;break;case"strict":s.strict=!s.strict;break;default:r.value=String(s.input)}t("buyStrict").style.borderColor=s.strict?"":"crimson",t("buy1x").style.backgroundColor=s.howMany===1?"green":"",t("buyAny").style.backgroundColor=Math.abs(s.howMany)!==1?"green":"",t("buyMax").style.backgroundColor=s.howMany===-1?"green":""},_=async()=>{let{stage:e,buildings:s,researchesAuto:r,toggles:n}=i,l=!1;if(e.current===1)if(s[3].current>=167e19){let a=!0;n[2]&&m("Stage 2 is being worked on, might come out around 20.09.2022."),a=!1,a&&(r[0]===0&&r[0]++,l=!0)}else m("There are more molecules in a single drop than that you know.");else m("Not yet in game")},K=async()=>{let{energy:e}=i,{dischargeInfo:s}=o;if(i.upgrades[3]===1&&i.buildings[1].true>0&&i.stage.current===1){let r=!0;i.toggles[1]&&e.current<s.next?r=await L("This will reset all of your current buildings and energy. You will NOT gain production boost. Continue?"):i.toggles[1]&&e.current>=s.next&&(r=await L("You have enough energy to gain boost. Continue?")),r&&(e.current>=s.next?(s.next*=10,i.discharge.current++,o.screenReader&&(t("invisibleBought").textContent="Buildings and energy were reset for some boost")):o.screenReader&&e.current<s.next&&(t("invisibleBought").textContent="Buildings and energy were reset, no boost"),V("discharge"))}};var C=(e="none")=>{if(o.tab!==e){t("stageTab").style.display="none",t("stageTabBtn").style.borderColor="",t("researchTab").style.display="none",t("researchTabBtn").style.borderColor="",t("settingsTab").style.display="none",t("settingsTabBtn").style.borderColor="";let s=["#e3e3e3","#a10000"][o.theme.stage-1],r=t("invisibleTab");t("specialTab").style.display="none",e!=="none"?o.tab=e:o.tab="stage",t(`${o.tab}Tab`).style.display="",t(`${o.tab}TabBtn`).style.borderColor=s,r.textContent=`Current tab: ${o.tab} tab`,B(),T()}},F=()=>{let{stage:e,time:s,buildings:r,upgrades:n,researches:l,researchesAuto:a,toggles:d}=i,{buildingsInfo:g}=o,c=Date.now()-s.updated,f=c/1e3;if(s.updated=Date.now(),c<0)return console.warn("Negative passed time detected.");if(o.lastSave+=c,f>3600&&(f=3600,console.log("Max offline progress is 1 hour.")),e.current===1){let{discharge:u}=i,{upgradesInfo:h}=o;d[6]&&a[1]>=3&&k(3,!0),g.producing[3]=.3*r[3].current*h.effect[3]**u.current,n[5]===1&&(g.producing[3]*=h.effect[5]**r[3].true),S(2,f),h.effect[5]=Math.trunc((1.02+.01*l[1])*100)/100,h.effect[3]=4+1*l[3],n[6]===1&&S(3,f),d[5]&&a[1]>=2&&k(2,!0),g.producing[2]=.4*r[2].current*h.effect[3]**u.current,n[2]===1&&(g.producing[2]*=5),n[5]===1&&(g.producing[2]*=h.effect[5]**r[2].true),S(1,f),d[4]&&a[1]>=1&&k(1,!0),g.producing[1]=.5*r[1].current*h.effect[3]**u.current,n[1]===1&&(g.producing[1]*=10),n[5]===1&&(g.producing[1]*=h.effect[5]**r[1].true),S(0,f)}else e.current===2&&(r[0].current<.0028&&r[1].current===0&&(r[0].current=.0028),r[1].current<r[1].true&&(r[1].true=Math.trunc(r[1].current),v(1)),g.producing[1]=4e-4*r[1].current,l[0]>0&&(g.producing[1]*=3**l[0]),S(0,f))},T=()=>{let{stage:e,buildings:s,upgrades:r}=i,{tab:n,buildingsInfo:l}=o;if(o.footer&&(e.current===1?(t("quarks").textContent=`Quarks: ${y(s[0].current)}`,i.energy.total>=9&&(t("energy").textContent=`Energy: ${y(i.energy.current,0)}`)):e.current===2&&(t("water").textContent=`Moles: ${y(s[0].current)}`,n!=="stage"&&(t("dropExtra").textContent=`Drops: ${y(s[1].current)}`))),n==="stage"){for(let a=1;a<l.name.length;a++){t(`building${a}Cur`).textContent=y(s[a].current),t(`building${a}Prod`).textContent=y(l.producing[a]);let d=a-1;e.current===2&&a>2&&(d=1),l.cost[a]<=s[d].current?(t(`building${a}Btn`).classList.add("availableBuilding"),t(`building${a}Btn`).textContent=`Buy for: ${y(l.cost[a])} ${l.name[d]}`):(t(`building${a}Btn`).classList.remove("availableBuilding"),t(`building${a}Btn`).textContent=`Need: ${y(l.cost[a])} ${l.name[d]}`)}e.current===1&&r[3]===1&&(t("dischargeReset").textContent=`Next goal is ${y(o.dischargeInfo.next,0)} Energy`,t("dischargeEffect").textContent=String(o.upgradesInfo.effect[3]))}else n==="settings"&&o.lastSave>=1e3&&(t("isSaved").textContent=`${y(o.lastSave,0,"time")} ago`)},B=()=>{let{stage:e,buildings:s,upgrades:r,researchesAuto:n}=i;if(e.current===1){let{energy:l,discharge:a}=i;t("energyStat").style.display=l.total>=9?"":"none",t("building2").style.display=s[1].total>=11?"":"none",t("building3").style.display=s[2].total>=2?"":"none",l.total>=9&&(t("upgrades").style.display=""),t("discharge").style.display=r[3]>0?"":"none",a.current>=1&&(t("resetToggles").style.display="");for(let d=5;d<=8;d++)a.current>=3?t(`upgrade${d}`).style.display="":t(`upgrade${d}`).style.display="none";a.current>=4&&(t("researchTabBtn").style.display=""),r[7]===1&&(t("stage").style.display=""),s[3].current>=167e19&&(t("stageReset").textContent="Enter next stage")}else e.current===2&&(t("dropStat").style.display=o.tab!=="stage"?"":"none",t("building2").style.display=s[1].total>=400?"":"none");for(let l=1;l<p.buildings.length;l++)n[1]>=l?t(`toggle${l+3}`).style.display="":t(`toggle${l+3}`).style.display="none";t("toggleBuy").style.display=n[0]>0?"":"none",o.screenReader&&(t("invisibleGetBuilding2").style.display=s[2].total>0?"":"none",t("invisibleGetBuilding3").style.display=s[3].total>0?"":"none",t("invisibleGetBuilding4").style.display=s[4].total>0?"":"none",t("invisibleGetBuilding5").style.display=s[5].total>0?"":"none")},I=(e,s="upgrades",r=s+"Info")=>{s.includes("researches")?(t("researchText").textContent=o[r].description[e],s==="researchesAuto"&&e===1&&(o.researchesAutoInfo.effect[1]=o.buildingsInfo.name[Math.min(i.researchesAuto[1]+1,o.buildingsInfo.name.length-1)]),o[r].effect[e]!==0?t("researchEffect").textContent=`${o[r].effectText[e][0]}${o[r].effect[e]}${o[r].effectText[e][1]}`:t("researchEffect").textContent=o[r].effectText[e][0],t("researchCost").textContent=`${i[s][e]===o[r].max[e]?0:o[r].cost[e]} ${o.stageInfo.resourceName[i.stage.current-1]}.`):(t("upgradeText").textContent=o[r].description[e],o[r].effect[e]!==0?t("upgradeEffect").textContent=`${o[r].effectText[e][0]}${o[r].effect[e]}${o[r].effectText[e][1]}`:t("upgradeEffect").textContent=o[r].effectText[e][0],t("upgradeCost").textContent=`${i[s][e]===1?0:o[r].cost[e]} ${o.stageInfo.resourceName[i.stage.current-1]}.`)},y=(e,s=e<1e3?e<1?4:2:0,r="number")=>{switch(r){case"number":if(s>0&&e<1e6)return String(Math.trunc(e*10**s)/10**s);if(s<=0&&e<1e6)return String(Math.trunc(e));{let n=Math.trunc(Math.log10(e));return`${Math.trunc(e/10**n*100)/100}e${n}`}case"time":return e>=1728e5?`${Math.trunc(e/864e5)} days`:e>=72e5?`${Math.trunc(e/36e5)} hours`:e>=6e5?`${Math.trunc(e/6e4)} minutes`:`${Math.trunc(e/1e3)} seconds`}},W=()=>{let{stage:e,upgrades:s,researches:r,researchesAuto:n}=i,{stageInfo:l,buildingsInfo:a,researchesAutoInfo:d}=o,g=document.body.style;t("upgradeCost").classList.remove("orangeText","cyanText"),t("researchCost").classList.remove("orangeText","cyanText");for(let c=2;c<p.buildings.length;c++)t(`building${c}`).style.display="none";if(e.current===1){let{upgradesInfo:c,researchesInfo:f}=o;a.name=["Quarks","Particles","Atoms","Molecules"],x.buildingsInfo.cost=[0,3,24,3],d.cost[1]=3e3,d.scalling[1]=5e3,o.dischargeInfo.next=10**i.discharge.current,t("upgradeCost").classList.add("orangeText"),t("researchCost").classList.add("orangeText");for(let u=0;u<c.cost.length;u++)s[u]===1?t(`upgrade${[u+1]}`).style.backgroundColor="green":t(`upgrade${[u+1]}`).style.backgroundColor="";for(let u=0;u<f.cost.length;u++)t(`research${u+1}Level`).textContent=String(r[u]),t(`research${u+1}Level`).classList.remove("redText","orchidText","greenText"),A(u,"researches"),r[u]===f.max[u]?t(`research${u+1}Level`).classList.add("greenText"):r[u]===0?t(`research${u+1}Level`).classList.add("redText"):t(`research${u+1}Level`).classList.add("orchidText");t("quarkStat").style.display="",t("particles").style.display="",t("atoms").style.display="",t("molecules").style.display="",t("dischargeToggleReset").style.display="";for(let u=1;u<=4;u++)t(`upgrade${u}`).style.display="";for(let u=1;u<=f.cost.length;u++)t(`research${u}`).style.display="";e.true===1&&(t("upgrades").style.display="none",t("resetToggles").style.display="none",t("researchTabBtn").style.display="none",t("stage").style.display="none",t("stageToggleReset").style.display="none",t("themeArea").style.display="none")}else if(e.current===2){let{upgradesS2Info:c,researchesS2Info:f}=o;a.name=["Moles","Drops","Puddles","Ponds","Lakes","Seas"],a.increase=1.2,x.buildingsInfo.cost=[0,.0028,100,9e99,9e99,9e99],t("upgradeCost").classList.add("cyanText"),t("researchCost").classList.add("cyanText");for(let u=0;u<c.cost.length;u++)s[u]===1?t(`upgradeW${[u+1]}`).style.backgroundColor="green":t(`upgradeW${[u+1]}`).style.backgroundColor="";for(let u=0;u<f.cost.length;u++)t(`researchW${u+1}Level`).textContent=String(r[u]),t(`researchW${u+1}Level`).classList.remove("redText","orchidText","greenText"),A(u,"researches","researchesS2Info"),r[u]===f.max[u]?t(`researchW${u+1}Level`).classList.add("greenText"):r[u]===0?t(`researchW${u+1}Level`).classList.add("redText"):t(`researchW${u+1}Level`).classList.add("orchidText");t("waterStat").style.display="",t("drops").style.display="",t("puddles").style.display="",t("ponds").style.display="",t("lakes").style.display="",t("seas").style.display="";for(let u=1;u<=0;u++)t(`upgradeW${u}`).style.display="";for(let u=1;u<=f.cost.length;u++)t(`researchW${u}`).style.display=""}for(let c=1;c<a.name.length;c++)t(`building${c}Name`).textContent=a.name[c],v(c);d.max[1]=a.name.length-1;for(let c=0;c<d.cost.length;c++)t(`researchAuto${c+1}Level`).textContent=String(n[c]),t(`researchAuto${c+1}Level`).classList.remove("redText","orchidText","greenText"),A(c,"researchesAuto"),n[c]===d.max[c]?t(`researchAuto${c+1}Level`).classList.add("greenText"):n[c]===0?t(`researchAuto${c+1}Level`).classList.add("redText"):t(`researchAuto${c+1}Level`).classList.add("orchidText");if(t("researchAuto2Max").textContent=String(d.max[1]),e.current!==1){t("quarkStat").style.display="none",t("energyStat").style.display="none",t("particles").style.display="none",t("atoms").style.display="none",t("molecules").style.display="none",t("discharge").style.display="none",t("dischargeToggleReset").style.display="none";for(let c=1;c<=o.upgradesInfo.cost.length;c++)t(`upgrade${c}`).style.display="none";for(let c=1;c<=o.researchesInfo.cost.length;c++)t(`research${c}`).style.display="none"}if(e.current!==2){t("waterStat").style.display="none",t("dropStat").style.display="none",t("drops").style.display="none",t("puddles").style.display="none",t("ponds").style.display="none",t("lakes").style.display="none",t("seas").style.display="none";for(let c=1;c<=o.upgradesS2Info.cost.length;c++)t(`upgradeW${c}`).style.display="none";for(let c=1;c<=o.researchesS2Info.cost.length;c++)t(`researchW${c}`).style.display="none"}if(e.true>1&&(t("upgrades").style.display="",t("resetToggles").style.display="",t("researchTabBtn").style.display="",t("stage").style.display="",t("stageToggleReset").style.display="",t("themeArea").style.display=""),t("stageReset").textContent="You are not ready",t("stageWord").textContent=l.word[e.current-1],e.current===1?(g.removeProperty("--border-image"),g.removeProperty("--border-stage"),g.removeProperty("--stage-text-color")):(g.setProperty("--border-image",`url(Used_art/Stage${e.current}%20border.png)`),e.current===2&&(g.setProperty("--border-stage","#1460a8"),g.setProperty("--stage-text-color","dodgerblue"))),o.screenReader){t("invisibleBought").textContent=`Current stage is '${l.word[e.current-1]}'`,t("invisibleGetResource1").style.display=e.current===1?"":"none";for(let c=0;c<a.name.length;c++)t(`invisibleGetBuilding${c}`).textContent=`Get information for ${a.name[c]}`}};var Y=(e,s=!1)=>{let{theme:r}=o;s?(r.default=!0,localStorage.removeItem("theme")):(r.default=!1,r.stage=e,localStorage.setItem("theme",String(e))),P()},P=()=>{let{stage:e}=i,{stageInfo:s,theme:r}=o,n=document.body.style;switch(n.setProperty("--transition","1s"),r.default?(r.stage=e.current,t("currentTheme").textContent="Default"):t("currentTheme").textContent=s.word[r.stage-1],n.removeProperty("--background-color"),n.removeProperty("--window-color"),n.removeProperty("--window-border"),n.removeProperty("--footer-color"),n.removeProperty("--button-main-color"),n.removeProperty("--button-main-border"),n.removeProperty("--button-main-hover"),n.removeProperty("--button-extra-hover"),n.removeProperty("--main-text-color"),n.removeProperty("--blue-text-color"),r.stage){case 2:n.setProperty("--background-color","#070026"),n.setProperty("--window-color","#000052"),n.setProperty("--window-border","blue"),n.setProperty("--footer-color","#0000db"),n.setProperty("--button-main-color","blue"),n.setProperty("--button-main-border","#427be1"),n.setProperty("--button-main-hover","#1515cf"),n.setProperty("--button-extra-hover","#2400d7"),n.setProperty("--main-text-color","dodgerblue"),n.setProperty("--blue-text-color","#82cb3b");break}setTimeout(()=>{n.removeProperty("--transition")},1e3)},m=e=>{let s=t("blocker");if(t("blocker").style.display==="block")return console.warn("Wasn't able to show another window (alert)");t("alertText").textContent=e;let r=t("confirmBtn");s.style.display="block";let n=()=>{s.style.display="none",r.removeEventListener("click",n)};r.addEventListener("click",n)},L=async e=>await new Promise(s=>{let r=t("blocker");r.style.display==="block"&&(console.warn("Wasn't able to show another window (confirm)"),s(!1)),t("alertText").textContent=e;let n=t("cancelBtn"),l=t("confirmBtn");r.style.display="block",n.style.display="block";let a=async()=>{r.style.display="none",n.style.display="none",l.removeEventListener("click",a),n.removeEventListener("click",d),s(!0)},d=async()=>{r.style.display="none",n.style.display="none",l.removeEventListener("click",a),n.removeEventListener("click",d),s(!1)};l.addEventListener("click",a),n.addEventListener("click",d)}),j=async e=>await new Promise(s=>{let r=t("blocker");r.style.display==="block"&&(console.warn("Wasn't able to show another window (prompt)"),s(null)),t("alertText").textContent=e;let n=t("inputArea"),l="",a=t("cancelBtn"),d=t("confirmBtn");r.style.display="block",a.style.display="block",n.style.display="block";let g=()=>{l=n.value},c=async()=>{r.style.display="none",a.style.display="none",n.style.display="none",n.value="",d.removeEventListener("click",c),a.removeEventListener("click",f),n.removeEventListener("blur",g),s(l)},f=async()=>{r.style.display="none",a.style.display="none",n.style.display="none",n.value="",d.removeEventListener("click",c),a.removeEventListener("click",f),n.removeEventListener("blur",g),s(null)};d.addEventListener("click",c),a.addEventListener("click",f),n.addEventListener("blur",g)}),D=()=>{let e=t("footer"),s=t("footerColor"),r=t("hideToggle"),n=t("hideText"),l=t("hideArrow");o.footer=!o.footer,r.removeEventListener("click",D),o.footer?(s.style.display="",l.style.transform="",e.style.animation="hide 1s forwards reverse",l.style.animation="rotate 1s forwards reverse",n.textContent="Hide"):(e.style.animation="hide 1s backwards",l.style.animation="rotate 1s backwards",n.textContent="Show",setTimeout(()=>{s.style.display="none",l.style.transform="rotate(180deg)"},1e3)),setTimeout(()=>{e.style.animation="",l.style.animation="",r.addEventListener("click",D)},1e3)},R=(e=!1,s="toggle",r="building")=>{var n;switch(s){case"toggle":{let l=e,a=Boolean((n=localStorage.getItem("screen reader"))!=null?n:!1),d=t("screenReaderToggle");l&&(a=!a),a?(d.textContent="ON",d.style.borderColor="crimson",d.setAttribute("aria-label","Screen reader support is ON"),localStorage.setItem("screen reader","true"),o.screenReader=!0,r==="reload"&&(i.buyToggle.strict=!1,o.intervals.main=100,o.intervals.numbers=1e3),l&&m(`For full support please refresh page. This will allow to buy upgrades on focus (because I have no idea how to make an image clickable with a keyboard), also you will get a special tab where you can check how much you own and more.
(For non screen readers this will cause issues)`)):(d.textContent="OFF",d.style.borderColor="",d.setAttribute("aria-label","Screen reader support is OFF"),localStorage.removeItem("screen reader"),o.screenReader=!1);break}case"button":{let l=e,{stage:a}=i,d=t("invisibleBought");if(r==="building"){let{buildings:g}=i,{buildingsInfo:c}=o,f=l-1;a.current===2&&l>2&&(f=1),l===0?d.textContent=`You have ${y(g[0].current)} ${c.name[0]}`:d.textContent=`You have ${y(g[l].current)} ${c.name[l]}, next one will cost ${y(c.cost[l])} ${c.name[f]}, they are producing ${y(c.producing[l])} ${c.name[f]} per second${i.researchesAuto[1]>=l?`, auto is ${i.toggles[l+3]?"on":"off"}`:""}`}else a.current===1&&(d.textContent=`You have ${i.energy.current} Energy${i.upgrades[3]===1?`, next discharge goal is ${y(o.dischargeInfo.next)} Energy`:""}`);break}}},U=(e=!1)=>{let s=document.body.style,r=t("customFontSize"),n=localStorage.getItem("fontSize");i.toggles[3]?((n===null||Number(n)<10||Number(n)>32||e)&&(n=String(Math.min(Math.max(Math.trunc(Number(r.value)*10)/10,10),32)),localStorage.setItem("fontSize",n)),s.setProperty("--font-size",`${n}px`),r.value=n):(s.setProperty("--font-size","1em"),localStorage.removeItem("fontSize"))};var i={stage:{true:1,current:1},energy:{current:0,total:0},discharge:{current:0,bonus:0},time:{updated:Date.now(),started:Date.now()},buildings:[{current:3,total:3},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0}],upgrades:[0,0,0,0,0,0,0,0],researches:[0,0,0,0,0],researchesAuto:[0,0],toggles:[],buyToggle:{howMany:1,input:10,strict:!0}},o={tab:"stage",footer:!0,screenReader:!1,lastSave:0,energyType:[0,1,5,20],stageInfo:{word:["Microworld","Submerged"],resourceName:["Energy","Water drops"]},theme:{stage:1,default:!0},dischargeInfo:{next:1},intervals:{main:50,numbers:50,visual:1,autoSave:180},intervalsId:{main:0,numbers:0,visual:0,autoSave:0},buildingsInfo:{name:["Quarks","Particles","Atoms","Molecules"],cost:[0,3,24,3],increase:1.4,producing:[0,0,0,0,0,0]},upgradesInfo:{description:["Bigger electrons. Particles cost decreased.","Stronger protons. Particles produce more.","More neutrons. Increased gain of Particles.","Superposition. Unlocks new reset tier.","Protium. Basic.","Deuterium. Heavy.","Tritium. Radioactive.","Nuclear fusion. More energy."],effectText:[["Particle cost is "," times cheaper."],["Particles produce "," times more Quarks."],["Atoms produce "," times more Particles."],["Abbility to reset at any time and boost production for all buildings by ",", if had enough energy."],["Cost scalling is decreased by ","."],["Buildings (only bought one's) boost themselfs by "," times."],["Molecules produce Molecules. At a reduced rate."],["Unspent energy boost Molecules production of themselfs 1 to 1."]],effect:[10,10,5,4,.2,1.01,0,0],cost:[9,12,36,300,800,5e3,15e3,36e3]},upgradesS2Info:{description:[],effectText:[],effect:[],cost:[]},researchesInfo:{description:["Effect of 'Protium' upgrade is stronger.","Effect of 'Deuterium' upgrade is bigger.","Effect of 'Tritium' upgrade is better.","Discharge bonus improved.","Gain more energy from buying a building."],effectText:[["Cost scalling is "," smaller for each level."],["Each bought building boost each other by additional ","."],["Molecules now produce themselfs "," times quicker."],["Discharge is now gives extra +"," bonus per reached goal."],["A single building now gives "," times more energy."]],effect:[.01,.01,12,1,3],cost:[2e3,6500,2e4,12e3,42e3],scalling:[300,1500,1800,0,81456],max:[9,3,9,1,2]},researchesS2Info:{description:["More moles."],effectText:[["Drops produce "," times more moles."]],effect:[3],cost:[20],scalling:[1.2],max:[9]},researchesAutoInfo:{description:["Buy toggles.","Automatization for buying upgrades."],effectText:[["Unlock abbility to buy multiple buildings at same time."],["Will automatically buy "," for you."]],effect:[0,"Particles"],cost:[300,3e3],scalling:[0,5e3],max:[1,3]}},X=e=>{let s=[];for(let r=0;r<e;r++)r>=4&&r<=8?s.push(!1):s.push(!0);return s},Z=document.getElementsByClassName("toggle").length;Object.assign(i,{toggles:X(Z)});var p=structuredClone(i),x=structuredClone(o),G=e=>{let s;return e==="p"?s=structuredClone(p):s=structuredClone(x),s},q=e=>{if(Object.prototype.hasOwnProperty.call(e,"player")&&Object.prototype.hasOwnProperty.call(e,"global")){let s=G("p");for(let r in p)Object.prototype.hasOwnProperty.call(e.player,r)||(e.player[r]=s[r]);if(e.player.stage.current===2){if(o.upgradesS2Info.cost.length>e.player.upgrades.length)for(let r=e.player.upgrades.length;r<o.upgradesS2Info.cost.length;r++)e.player.upgrades[r]=0;if(o.researchesS2Info.cost.length>e.player.researches.length)for(let r=e.player.researches.length;r<o.researchesS2Info.cost.length;r++)e.player.researches[r]=0}if(p.buildings.length>e.player.buildings.length)for(let r=e.player.buildings.length;r<p.buildings.length;r++)e.player.buildings[r]={current:0,true:0,total:0};if(p.researchesAuto.length>e.player.researchesAuto.length)for(let r=e.player.researchesAuto.length;r<p.researchesAuto.length;r++)e.player.researchesAuto[r]=0;if(p.toggles.length>e.player.toggles.length)for(let r=e.player.toggles.length;r<p.toggles.length;r++)e.player.toggles[r]=s.toggles[r];Object.assign(i,e.player),o.intervals=e.global.intervals}else m("Save file coudn't be loaded as its missing important info.")};var t=e=>{let s=document.getElementById(e);if(s!==null)return s;throw m("Some ID failed to load, game won't be working properly. Please refresh."),new TypeError(`ID "${e}" not found.`)},J=async(e=!1)=>{if(e){let s=localStorage.getItem("save"),r=localStorage.getItem("theme");if(s!==null){let n=JSON.parse(atob(s));q(n),i.toggles[0]&&m(`Welcome back, you were away for ${y(Date.now()-i.time.updated,0,"time")}.`)}else m("Welcome. This is a test-project. Since I don't expect anyone to play this, save file can get corrupted with a new version.");r!==null&&(o.theme.default=!1,o.theme.stage=Number(r))}R(!1,"toggle","reload"),W(),C(),U();for(let s=0;s<p.toggles.length;s++)z(s,!1);$(),P(),e&&!i.toggles[0]&&await L(`Welcome back, you were away for ${y(Date.now()-i.time.updated,0,"time")}. Game was set to have offline time disabled. Press confirm to NOT to gain offline time.`)&&(i.time.updated=Date.now()),w(!1,"all")};J(!0);var{screenReader:E}=o;for(let e=0;e<p.toggles.length;e++)t(`toggle${e}`).addEventListener("click",()=>z(e));for(let e=1;e<p.buildings.length;e++)t(`building${e}Btn`).addEventListener("click",()=>k(e));for(let e=0;e<o.upgradesInfo.cost.length;e++)t(`upgrade${e+1}`).addEventListener("mouseover",()=>I(e)),t(`upgrade${e+1}`).addEventListener("click",()=>b(e)),E&&t(`upgrade${e+1}`).addEventListener("focus",()=>b(e));for(let e=0;e<o.upgradesS2Info.cost.length;e++)t(`upgradeW${e+1}`).addEventListener("mouseover",()=>I(e,"upgrades","upgradesS2Info")),t(`upgradeW${e+1}`).addEventListener("click",()=>b(e,"upgrades","upgradesS2Info")),E&&t(`upgradeW${e+1}`).addEventListener("focus",()=>b(e,"upgrades","upgradesS2Info"));t("dischargeReset").addEventListener("click",async()=>await K());t("stageReset").addEventListener("click",async()=>await _());t("buy1x").addEventListener("click",()=>$("1"));t("buyAny").addEventListener("click",()=>$("any"));t("buyAnyInput").addEventListener("blur",()=>$("any"));t("buyMax").addEventListener("click",()=>$("max"));t("buyStrict").addEventListener("click",()=>$("strict"));for(let e=0;e<o.researchesInfo.cost.length;e++)t(`research${e+1}Image`).addEventListener("mouseover",()=>I(e,"researches")),t(`research${e+1}Image`).addEventListener("click",()=>b(e,"researches")),E&&t(`research${e+1}Image`).addEventListener("focus",()=>b(e,"researches"));for(let e=0;e<o.researchesS2Info.cost.length;e++)t(`researchW${e+1}Image`).addEventListener("mouseover",()=>I(e,"researches","researchesS2Info")),t(`researchW${e+1}Image`).addEventListener("click",()=>b(e,"researches","researchesS2Info")),E&&t(`researchW${e+1}Image`).addEventListener("focus",()=>b(e,"researches","researchesS2Info"));for(let e=0;e<o.researchesAutoInfo.cost.length;e++)t(`researchAuto${e+1}Image`).addEventListener("mouseover",()=>I(e,"researchesAuto")),t(`researchAuto${e+1}Image`).addEventListener("click",()=>b(e,"researchesAuto")),E&&t(`researchAuto${e+1}Image`).addEventListener("focus",()=>b(e,"researchesAuto"));t("save").addEventListener("click",async()=>await M("save"));t("file").addEventListener("change",async()=>await M("load"));t("export").addEventListener("click",async()=>await M("export"));t("delete").addEventListener("click",async()=>await M("delete"));t("switchTheme0").addEventListener("click",()=>Y(0,!0));for(let e=1;e<=o.stageInfo.word.length;e++)t(`switchTheme${e}`).addEventListener("click",()=>Y(e));t("mainInterval").addEventListener("blur",()=>w(!1,"main"));t("numbersInterval").addEventListener("blur",()=>w(!1,"numbers"));t("visualInterval").addEventListener("blur",()=>w(!1,"visual"));t("autoSaveInterval").addEventListener("blur",()=>w(!1,"autoSave"));t("pauseGame").addEventListener("click",async()=>await O());t("toggle3").addEventListener("click",()=>U());t("customFontSize").addEventListener("blur",()=>U(!0));t("screenReaderToggle").addEventListener("click",()=>R(!0));if(E){for(let e=0;e<p.buildings.length;e++)t(`invisibleGetBuilding${e}`).addEventListener("click",()=>R(e,"button"));t("invisibleGetResource1").addEventListener("click",()=>R(0,"button","resource")),t("specialTabBtn").addEventListener("click",()=>C("special"))}else t("specialTabBtn").style.display="none";t("hideToggle").addEventListener("click",D);t("stageTabBtn").addEventListener("click",()=>C("stage"));t("researchTabBtn").addEventListener("click",()=>C("research"));t("settingsTabBtn").addEventListener("click",()=>C("settings"));function w(e=!1,s=""){let{intervals:r,intervalsId:n}=o;if(s!==""){let l=t("mainInterval"),a=t("numbersInterval"),d=t("visualInterval"),g=t("autoSaveInterval");if(s==="main")r.main=Math.min(Math.max(Math.trunc(Number(l.value)),20),1e3),r.main>r.numbers&&(r.numbers=r.main);else if(s==="numbers"){let c=Math.min(Math.max(Math.trunc(Number(a.value)),20),1e3);r.numbers=Math.max(c,r.main)}else s==="visual"?r.visual=Math.min(Math.max(Math.trunc(Number(d.value)*10)/10,.5),10):s==="autoSave"&&(r.autoSave=Math.min(Math.max(Math.trunc(Number(g.value)),60),1800));l.value=String(r.main),a.value=String(r.numbers),d.value=String(r.visual),g.value=String(r.autoSave)}clearInterval(n.main),clearInterval(n.numbers),clearInterval(n.visual),clearInterval(n.autoSave),e||(n.main=setInterval(F,r.main),n.numbers=setInterval(T,r.numbers),n.visual=setInterval(B,r.visual*1e3),n.autoSave=setInterval(M,r.autoSave*1e3,"save"))}async function M(e){switch(e){case"load":{let s=t("file"),r=s.files;if(r===null)return m("Loaded file wasn't found.");let n=await r[0].text();try{let l=JSON.parse(atob(n));w(!0),q(l),await L(`This save file was set to have offline progress disabled (currently ${y(Date.now()-i.time.updated,0,"time")}). Press confirm to NOT to gain offline time.`)&&(i.time.updated=Date.now()),J()}catch(l){m("Incorrect save file format.")}finally{s.value=""}break}case"save":{let s=btoa(`{"player":${JSON.stringify(i)},"global":{"intervals":${JSON.stringify(o.intervals)}}}`);localStorage.setItem("save",s),t("isSaved").textContent="Saved",o.lastSave=0;break}case"export":{await M("save");let s=localStorage.getItem("save");if(s===null)return m("Save file wasn't found. Even though game was saved just now...");let r=document.createElement("a");r.href="data:text/plain;charset=utf-8,"+s,r.download="Fundamental.txt",r.click();break}case"delete":{let s=await j(`This will truly delete your save file!
Type 'delete' to confirm.`);(s==null?void 0:s.toLowerCase())==="delete"?(w(!0),localStorage.clear(),Object.assign(i,G("p")),Object.assign(o,G("g")),i.time.started=Date.now(),i.time.updated=i.time.started,J()):s!==null&&s!==""&&m(`You wrote '${s}', so save file wasn't deleted.`);break}}}var O=async()=>{w(!0);let e=await j("Game is currently paused. Press any button bellow to unpause it. If you want you can enter 'NoOffline' to NOT to gain offline time. Offline timer has a limit.");(e==null?void 0:e.toLowerCase())==="nooffline"?i.time.updated=Date.now():e!==null&&e!==""&&m(`You wrote '${e}', so you gained offline time.`),w()};})();
