"use strict";(()=>{var H=e=>{let{stage:s,buildings:n}=i;switch(e){case"discharge":i.energy.current=0,n[0].current=3;break;case"vaporization":n[0].current=.0028;for(let r=0;r<o.upgradesS2Info.cost.length;r++)r!==3&&(i.upgrades[r]=0,$(r));for(let r=0;r<o.researchesS2Info.cost.length;r++)i.researches[r]=0,$(r,"researches");break;case"stage":{i.upgrades=[],i.researches=[];let{upgrades:r,researches:a}=i;for(let l=1;l<p.buildings.length;l++)n[l].current=0,n[l].true=0,n[l].total=0;let c="upgradesInfo",u="researchesInfo";s.current!==1&&(c=`upgradesS${s.current}Info`,u=`researchesS${s.current}Info`);for(let l=0;l<o[c].cost.length;l++)r[l]=0;for(let l=0;l<o[u].cost.length;l++)a[l]=0;switch(s.current){case 1:n[0].current=3,n[0].total=3,i.energy.current=0,i.energy.total=0,i.discharge.current=0;break;case 2:n[0].current=.0028,n[0].total=.0028,i.vaporization.current=0,i.vaporization.clouds=1;break}N(),B(),R();break}}if(e!=="stage")for(let r=1;r<p.buildings.length;r++)n[r].current=0,n[r].true=0,x(r);S()};var E=(e,s=!1)=>{let{stage:n,buildings:r}=i,{buildingsInfo:a,screenReader:c}=o,u=e-1;if(n.current===2&&e>2&&(u=1),!isFinite(a.cost[e])){c&&!s&&(t("invisibleBought").textContent=`Coudn't buy '${a.name[e]}', because cost is infinity`);return}if(r[u].current<a.cost[e]*(s?2:1)){c&&!s&&(t("invisibleBought").textContent=`Coudn't buy '${a.name[e]}', because didn't had enough of '${a.name[u]}'`);return}let{researchesAuto:l,buyToggle:g}=i;if(n.current===1&&(o.energyType[e]=v.energyType[e]*3**i.researches[4]),g.howMany!==1&&l[0]>0||s){let m=r[u].current;s&&(m/=2);let h=a.cost[e],b=0,W=s?-1:g.howMany;for(var f=0;m>=h&&f!==W;f++)b+=h,m-=h,h*=a.increase;if(f<W&&W!==-1&&g.strict)return;r[u].current-=b,r[e].current+=f,r[e].true+=f,r[e].total+=f,n.current===1&&(i.energy.current+=o.energyType[e]*f,i.energy.total+=o.energyType[e]*f),o.screenReader&&!s&&(t("invisibleBought").textContent=`Bought ${d(f)} '${a.name[e]}'${n.current===1?`, gained ${d(o.energyType[e]*f)} ${o.stageInfo.resourceName[n.current-1]}`:""}`)}else(g.howMany===1||l[0]===0)&&(r[u].current-=a.cost[e],r[e].current++,r[e].true++,r[e].total++,n.current===1&&(i.energy.current+=o.energyType[e],i.energy.total+=o.energyType[e]),o.screenReader&&(t("invisibleBought").textContent=`Bought 1 '${a.name[e]}'${n.current===1?`, gained ${o.energyType[e]} ${o.stageInfo.resourceName[n.current-1]}`:""}`));x(e),D(),S()},x=e=>{let{stage:s,buildings:n,upgrades:r,researches:a}=i,{buildingsInfo:c}=o;s.current===1&&(o.upgradesInfo.effect[4]=Math.trunc((.2+a[0]*.01)*100)/100,c.increase=Math.trunc((1.4-(r[4]===1?o.upgradesInfo.effect[4]:0))*100)/100),c.cost[e]=v.buildingsInfo.cost[e]*c.increase**n[e].true,s.current===1&&e===1&&r[0]===1&&(c.cost[1]/=10)},z=(e,s)=>{let{stage:n}=i,r="researchesAutoInfo";s!=="researchesAuto"&&(r=`${s}${n.current>1?`S${n.current}`:""}Info`),i[s][e]!==o[r].max[e]&&(n.current===1?o[r].cost[e]=v[r].cost[e]+o[r].scalling[e]*i[s][e]:o[r].cost[e]=Math.trunc(v[r].cost[e]*o[r].scalling[e]**i[s][e]))},k=(e,s)=>{let{buildings:n}=i,{buildingsInfo:r}=o,a=n[e].current,c;if(i.stage.current===1&&e===3){if(r.producing[3]<=1)return;c=Math.log(r.producing[e])*s*12**i.researches[2],i.upgrades[7]===1&&(c*=i.energy.current)}else c=r.producing[e+1]*s;let u=n[e].current+c;if(isFinite(u))n[e].current=u;else return;u=n[e].total+(n[e].current-a),isFinite(u)&&(n[e].total=u)},I=(e,s="upgrades")=>{let{stage:n}=i,r;if(n.current===1?r=i.energy:r=i.buildings[1],s!=="upgrades"){let a="researchesAutoInfo";if(s!=="researchesAuto"&&(a=`${s}${n.current>1?`S${n.current}`:""}Info`),s==="researchesAuto"&&n.current===1&&e>1||i[s][e]===o[a].max[e]||r.current<o[a].cost[e])return;if(i[s][e]++,r.current-=o[a].cost[e],n.current===1&&s==="researches"&&e===0)for(let c=1;c<o.buildingsInfo.name.length;c++)x(c);o.screenReader&&(t("invisibleBought").textContent=`You have researched '${o[a].description[e]}', level is now ${i[s][e]} ${i[s][e]===o[a].max[e]?"maxed":""}`),z(e,s)}else{let a=`${s}${n.current>1?`S${n.current}`:""}Info`;if(i[s][e]===1||r.current<o[a].cost[e])return;if(i[s][e]=1,r.current-=o[a].cost[e],n.current===1){if(e===0)x(1);else if(e===3)t("discharge").style.display="";else if(e===4)for(let c=1;c<o.buildingsInfo.name.length;c++)x(c)}o.screenReader&&(t("invisibleBought").textContent=`You have bought upgrade '${o[a].description[e]}'`)}S(),C(e,s),$(e,s)},Y=(e,s=!0)=>{var a,c,u,l;let{toggles:n}=i,r=t(`toggle${e}`);s&&(n[e]=!n[e]),r.classList.contains("auto")?n[e]?(r.textContent="Auto ON",r.style.borderColor=""):(r.textContent="Auto OFF",r.style.borderColor="crimson"):n[e]?(r.textContent="ON",r.style.borderColor="",o.screenReader&&(r.ariaLabel=(l=(u=r.ariaLabel)==null?void 0:u.replace(" OFF"," ON"))!=null?l:"")):(r.textContent="OFF",r.style.borderColor="crimson",o.screenReader&&(r.ariaLabel=(c=(a=r.ariaLabel)==null?void 0:a.replace(" ON"," OFF"))!=null?c:""))},L=(e="none")=>{let{buyToggle:s}=i,n=t("buyAnyInput");switch(e){case"1":s.howMany=1;break;case"max":s.howMany=-1;break;case"any":s.input=Math.max(Math.trunc(Number(n.value)),-1),s.input===0&&(s.input=1),s.howMany=s.input;break;case"strict":s.strict=!s.strict;break;default:n.value=String(s.input)}t("buyStrict").style.borderColor=s.strict?"":"crimson",t("buy1x").style.backgroundColor=s.howMany===1?"green":"",t("buyAny").style.backgroundColor=Math.abs(s.howMany)!==1?"green":"",t("buyMax").style.backgroundColor=s.howMany===-1?"green":""},Q=async()=>{let{stage:e,buildings:s,researchesAuto:n,toggles:r}=i,a=!1;if(e.current===1)if(s[3].current>=167e19){let c=!0;r[2]&&y("Stage 2 is being worked on, might come out soon (-ish). (It's only around 33% done)"),c=!1,c&&(n[0]===0&&n[0]++,a=!0)}else y("There are more molecules in a single drop than that you know.");else y("Not yet in game")},_=async()=>{let{energy:e}=i,{dischargeInfo:s}=o;if(i.upgrades[3]===1&&i.buildings[1].true>0&&i.stage.current===1){let n=!0;i.toggles[1]&&e.current<s.next?n=await T("This will reset all of your current buildings and energy. You will NOT gain production boost. Continue?"):i.toggles[1]&&e.current>=s.next&&(n=await T("You have enough energy to gain boost. Continue?")),n&&(e.current>=s.next?(i.discharge.current++,s.next*=10,o.screenReader&&(t("invisibleBought").textContent="Buildings and energy were reset for some boost")):o.screenReader&&e.current<s.next&&(t("invisibleBought").textContent="Buildings and energy were reset, no boost"),H("discharge"))}},K=async()=>{let e=i.buildings[1].current/1e10;if(i.upgrades[3]===1&&e>=1&&i.stage.current===2){let{vaporization:s}=i,n=!0;i.toggles[9]&&(n=await T(`Do you wish to reset buildings, upgrades and researches for ${d(e)} Clouds?`)),n&&(s.current++,s.clouds+=e,H("vaporization"),o.screenReader&&(t("invisibleBought").textContent=`Progress were reset for ${d(e)} Clouds`))}};var M=(e="none")=>{if(o.tab!==e){t("stageTab").style.display="none",t("stageTabBtn").style.borderColor="",t("researchTab").style.display="none",t("researchTabBtn").style.borderColor="",t("settingsTab").style.display="none",t("settingsTabBtn").style.borderColor="";let s=["#e3e3e3","#a10000"][o.theme.stage-1],n=t("invisibleTab");t("specialTab").style.display="none",e!=="none"?o.tab=e:o.tab="stage",t(`${o.tab}Tab`).style.display="",t(`${o.tab}TabBtn`).style.borderColor=s,n.textContent=`Current tab: ${o.tab} tab`,B(),S()}},D=()=>{let{stage:e,time:s,buildings:n,upgrades:r,researches:a,researchesAuto:c,toggles:u}=i,{timeSpecial:l,buildingsInfo:g}=o,f=Date.now()-s.updated,m=f/1e3;if(s.updated=Date.now(),f<0)return console.warn("Negative passed time detected.");if(l.lastSave+=f,l.maxOffline=3600,c[2]>0&&(l.maxOffline+=3600*c[2]),m>l.maxOffline&&(m=l.maxOffline,console.log(`Max offline progress is ${l.maxOffline/3600} hours.`)),e.current===1){let{discharge:h}=i,{upgradesInfo:b}=o;u[6]&&c[1]>=3&&E(3,!0),g.producing[3]=.3*n[3].current*b.effect[3]**h.current,r[5]===1&&(g.producing[3]*=b.effect[5]**n[3].true),k(2,m),b.effect[5]=Math.trunc((1.02+.01*a[1])*100)/100,b.effect[3]=4+1*a[3],r[6]===1&&k(3,m),u[5]&&c[1]>=2&&E(2,!0),g.producing[2]=.4*n[2].current*b.effect[3]**h.current,r[2]===1&&(g.producing[2]*=5),r[5]===1&&(g.producing[2]*=b.effect[5]**n[2].true),k(1,m),u[4]&&c[1]>=1&&E(1,!0),g.producing[1]=.5*n[1].current*b.effect[3]**h.current,r[1]===1&&(g.producing[1]*=10),r[5]===1&&(g.producing[1]*=b.effect[5]**n[1].true),k(0,m)}else if(e.current===2){let{upgradesS2Info:h}=o;g.producing[3]=2*n[3].current,r[1]===1&&(g.producing[3]*=1.5),g.producing[2]=2*n[2].current,h.effect[0]=1.03+a[2]*.01,r[0]===1&&(g.producing[2]*=h.effect[0]**n[2].true),n[3].current>=1&&(g.producing[2]*=g.producing[3]),a[1]>=1&&n[1].true>1&&(g.producing[2]*=Math.log10(n[1].true)),k(1,m),n[0].current<.0028&&n[1].current===0&&(n[0].current=.0028),n[1].current<n[1].true&&(n[1].true=Math.trunc(n[1].current),x(1)),g.producing[1]=4e-4*n[1].current,a[0]>0&&(g.producing[1]*=3**a[0]),k(0,m)}},S=()=>{let{stage:e,buildings:s,upgrades:n}=i,{tab:r,buildingsInfo:a}=o;if(o.footer&&(e.current===1?(t("quarks").textContent=`Quarks: ${d(s[0].current)}`,i.energy.total>=9&&(t("energy").textContent=`Energy: ${d(i.energy.current,0)}`)):e.current===2&&(t("water").textContent=`Moles: ${d(s[0].current)}`,r!=="stage"&&(t("dropExtra").textContent=`Drops: ${d(s[1].current)}`),n[3]===1&&(t("clouds").textContent=`Clouds: ${d(i.vaporization.clouds)}`))),r==="stage"){for(let c=1;c<a.name.length;c++){t(`building${c}Cur`).textContent=d(s[c].current),t(`building${c}Prod`).textContent=d(a.producing[c]);let u=c-1;e.current===2&&c>2&&(u=1),a.cost[c]<=s[u].current?(t(`building${c}Btn`).classList.add("availableBuilding"),t(`building${c}Btn`).textContent=`Buy for: ${d(a.cost[c])} ${a.name[u]}`):(t(`building${c}Btn`).classList.remove("availableBuilding"),t(`building${c}Btn`).textContent=`Need: ${d(a.cost[c])} ${a.name[u]}`)}e.current===1?n[3]===1&&(t("dischargeReset").textContent=`Next goal is ${d(o.dischargeInfo.next,0)} Energy`,t("dischargeEffect").textContent=String(o.upgradesInfo.effect[3])):e.current===2&&n[3]===1&&(t("vaporizationReset").textContent=`Reset for ${d(s[1].current/1e10)} Clouds`)}else r==="settings"&&o.timeSpecial.lastSave>=1e3&&(t("isSaved").textContent=`${d(o.timeSpecial.lastSave,0,"time")} ago`)},B=()=>{let{stage:e,buildings:s,upgrades:n,researchesAuto:r}=i,{screenReader:a}=o;if(e.current===1){let{energy:c,discharge:u}=i;t("energyStat").style.display=c.total>=9?"":"none",t("discharge").style.display=n[3]===1?"":"none",s[1].total>=11&&(t("building2").style.display=""),s[2].total>=2&&(t("building3").style.display=""),c.total>=9&&(t("upgrades").style.display=""),u.current>=1&&(t("resetToggles").style.display="");for(let l=5;l<=8;l++)t(`upgrade${l}`).style.display=u.current>=3?"":"none";u.current>=4&&(t("researchTabBtn").style.display=""),n[7]===1&&(t("stage").style.display=""),s[3].current>=167e19&&(t("stageReset").textContent="Enter next stage"),a&&(t("invisibleGetResource1").style.display=c.total>0?"":"none")}else e.current===2&&(t("dropStat").style.display=o.tab!=="stage"?"":"none",t("cloudStat").style.display=n[3]===1?"":"none",t("vaporization").style.display=n[3]===1?"":"none",t("vaporizationToggleReset").style.display=i.vaporization.current>0?"":"none",s[1].total>=400&&(t("building2").style.display=""),s[1].total>=1e7&&(t("building3").style.display=""),a&&(t("invisibleGetResource1").style.display=n[3]===1?"":"none"));for(let c=1;c<p.buildings.length;c++)t(`toggle${c+3}`).style.display=r[1]>=c?"":"none";t("toggleBuy").style.display=r[0]>0?"":"none",a&&(t("invisibleGetBuilding2").style.display=s[2].total>0?"":"none",t("invisibleGetBuilding3").style.display=s[3].total>0?"":"none",t("invisibleGetBuilding4").style.display=s[4].total>0?"":"none",t("invisibleGetBuilding5").style.display=s[5].total>0?"":"none")},C=(e,s="upgrades")=>{let{stage:n}=i;if(s!=="upgrades"){let r="researchesAutoInfo";s!=="researchesAuto"&&(r=`${s}${n.current>1?`S${n.current}`:""}Info`),t("researchText").textContent=o[r].description[e],s==="researchesAuto"&&e===1&&(o.researchesAutoInfo.effect[1]=o.buildingsInfo.name[Math.min(i.researchesAuto[1]+1,o.buildingsInfo.name.length-1)]),o[r].effect[e]!==0?t("researchEffect").textContent=`${o[r].effectText[e][0]}${d(o[r].effect[e])}${o[r].effectText[e][1]}`:t("researchEffect").textContent=o[r].effectText[e][0],t("researchCost").textContent=`${i[s][e]===o[r].max[e]?0:d(o[r].cost[e])} ${o.stageInfo.priceName[i.stage.current-1]}.`}else{let r=`${s}${n.current>1?`S${n.current}`:""}Info`;t("upgradeText").textContent=o[r].description[e],o[r].effect[e]!==0?t("upgradeEffect").textContent=`${o[r].effectText[e][0]}${d(o[r].effect[e])}${o[r].effectText[e][1]}`:t("upgradeEffect").textContent=o[r].effectText[e][0],t("upgradeCost").textContent=`${i[s][e]===1?0:d(o[r].cost[e])} ${o.stageInfo.priceName[i.stage.current-1]}.`}},$=(e,s="upgrades")=>{let{stage:n}=i,r="researchesAutoInfo";s!=="researchesAuto"&&(r=`${s}${n.current>1?`S${n.current}`:""}Info`);let a="";n.current===2&&(a="W");let c;if(s==="researchesAuto"?c=t(`researchAuto${e+1}Level`):s==="researches"?c=t(`research${a}${e+1}Level`):c=t(`upgrade${a}${e+1}`),Object.prototype.hasOwnProperty.call(o[r],"max"))c.textContent=String(i[s][e]),c.classList.remove("redText","orchidText","greenText"),i[s][e]===o[r].max[e]?c.classList.add("greenText"):i[s][e]===0?c.classList.add("redText"):c.classList.add("orchidText");else{let u="green";n.current===2&&(u="darkgreen"),t(`upgrade${a}${e+1}`).style.backgroundColor=i[s][e]===1?u:""}},d=(e,s=e<1e3?e<1?4:2:0,n="number")=>{if(typeof e!="number")return e;switch(n){case"number":if(s>0&&e<1e6)return String(Math.trunc(e*10**s)/10**s);if(s<=0&&e<1e6)return String(Math.trunc(e));{let r=Math.trunc(Math.log10(e));return`${Math.trunc(e/10**r*100)/100}e${r}`}case"time":return e>=1728e5?`${Math.trunc(e/864e5)} days`:e>=72e5?`${Math.trunc(e/36e5)} hours`:e>=6e5?`${Math.trunc(e/6e4)} minutes`:`${Math.trunc(e/1e3)} seconds`}},N=()=>{let{stage:e}=i,{stageInfo:s,buildingsInfo:n,researchesAutoInfo:r}=o;for(let l=2;l<p.buildings.length;l++)t(`building${l}`).style.display="none";t("upgradeText").textContent="Hover to see.",t("upgradeEffect").textContent="Hover to see.",t("upgradeCost").textContent="Resource.",t("researchText").textContent="Hover to see.",t("researchEffect").textContent="Hover to see.",t("researchCost").textContent="Resource.",t("quarkStat").style.display=e.current===1?"":"none",t("particles").style.display=e.current===1?"":"none",t("atoms").style.display=e.current===1?"":"none",t("molecules").style.display=e.current===1?"":"none",t("dischargeToggleReset").style.display=e.current===1?"":"none";for(let l=1;l<=o.researchesInfo.cost.length;l++)t(`research${l}`).style.display=e.current===1?"":"none";if(t("waterStat").style.display=e.current===2?"":"none",t("drops").style.display=e.current===2?"":"none",t("puddles").style.display=e.current===2?"":"none",t("ponds").style.display=e.current===2?"":"none",t("lakes").style.display=e.current===2?"":"none",t("seas").style.display=e.current===2?"":"none",t("researchAuto3").style.display=e.current>=2?"":"none",t("upgrades").style.display=e.true>1?"":"none",t("resetToggles").style.display=e.true>1?"":"none",t("researchTabBtn").style.display=e.true>1?"":"none",t("stage").style.display=e.true>1?"":"none",t("stageToggleReset").style.display=e.true>1?"":"none",t("themeArea").style.display=e.true>1||localStorage.getItem("theme")!==null?"":"none",t("switchTheme2").style.display=e.true>1?"":"none",e.current===1){n.name=["Quarks","Particles","Atoms","Molecules"],v.buildingsInfo.cost=[0,3,24,3],v.researchesAutoInfo.cost[1]=3e3,r.scalling[1]=5e3,o.dischargeInfo.next=10**i.discharge.current;for(let l=1;l<=4;l++)t(`upgrade${l}`).style.display=""}else if(e.current===2){n.name=["Moles","Drops","Puddles","Ponds","Lakes","Seas"],n.increase=1.2,v.buildingsInfo.cost=[0,.0028,100,1e7,9e99,9e99],v.researchesAutoInfo.cost[1]=1e10,r.scalling[1]=1e3;for(let l=1;l<=o.upgradesS2Info.cost.length;l++)t(`upgradeW${l}`).style.display="";for(let l=1;l<=o.researchesS2Info.cost.length;l++)t(`researchW${l}`).style.display=""}for(let l=1;l<n.name.length;l++)t(`building${l}Name`).textContent=n.name[l],x(l);let a=`upgrades${e.current>1?`S${e.current}`:""}Info`,c=`researches${e.current>1?`S${e.current}`:""}Info`;for(let l=0;l<o[a].cost.length;l++)i.upgrades[l]>1&&(i.upgrades[l]=1,console.error(`Upgrade (${l+1}) had an illegal value`)),$(l,"upgrades");for(let l=0;l<o[c].cost.length;l++)i.researches[l]>o[c].max[l]&&(i.researches[l]=o[c].max[l],console.error(`Research (${l+1}) had level above maxium`)),z(l,"researches"),$(l,"researches");r.max[1]=n.name.length-1;for(let l=0;l<r.cost.length;l++)i.researchesAuto[l]>o.researchesAutoInfo.max[l]&&(i.researchesAuto[l]=o.researchesAutoInfo.max[l],console.error(`Research (${l+1}) for automatization had level above maxium`)),z(l,"researchesAuto"),$(l,"researchesAuto");if(t("researchAuto2Max").textContent=String(r.max[1]),e.current!==1){t("energyStat").style.display="none",t("discharge").style.display="none";for(let l=1;l<=o.upgradesInfo.cost.length;l++)t(`upgrade${l}`).style.display="none"}if(e.current!==2){t("dropStat").style.display="none",t("cloudStat").style.display="none",t("vaporization").style.display="none",t("vaporizationToggleReset").style.display="none";for(let l=1;l<=o.upgradesS2Info.cost.length;l++)t(`upgradeW${l}`).style.display="none";for(let l=1;l<=o.researchesS2Info.cost.length;l++)t(`researchW${l}`).style.display="none"}let u=document.body.style;if(t("stageReset").textContent="You are not ready",t("stageWord").textContent=s.word[e.current-1],e.current===1?(u.removeProperty("--border-image"),u.removeProperty("--border-stage"),u.removeProperty("--stage-text-color")):(u.setProperty("--border-image",`url(Used_art/Stage${e.current}%20border.png)`),e.current===2&&(u.setProperty("--border-stage","#1460a8"),u.setProperty("--stage-text-color","dodgerblue"))),o.screenReader){t("invisibleBought").textContent=`Current stage is '${s.word[e.current-1]}'`,t("invisibleGetResource1").textContent=`Get information for ${s.resourceName[e.current-1]}`;for(let l=0;l<n.name.length;l++)t(`invisibleGetBuilding${l}`).textContent=`Get information for ${n.name[l]}`}};var j=(e,s=!1)=>{let{theme:n}=o;s?(n.default=!0,localStorage.removeItem("theme")):(n.default=!1,n.stage=e,localStorage.setItem("theme",String(e))),R()},R=()=>{let{stage:e}=i,{stageInfo:s,theme:n}=o,r=document.body.style;switch(r.setProperty("--transition","1s"),n.default?(n.stage=e.current,t("currentTheme").textContent="Default"):t("currentTheme").textContent=s.word[n.stage-1],t("upgradeCost").classList.remove("orangeText","cyanText"),t("researchCost").classList.remove("orangeText","cyanText"),r.removeProperty("--background-color"),r.removeProperty("--window-color"),r.removeProperty("--window-border"),r.removeProperty("--footer-color"),r.removeProperty("--button-main-color"),r.removeProperty("--button-main-border"),r.removeProperty("--button-main-hover"),r.removeProperty("--button-extra-hover"),r.removeProperty("--main-text-color"),r.removeProperty("--blue-text-color"),r.removeProperty("--gray-text-color"),n.stage){case 1:t("upgradeCost").classList.add("orangeText"),t("researchCost").classList.add("orangeText");break;case 2:t("upgradeCost").classList.add("cyanText"),t("researchCost").classList.add("cyanText"),r.setProperty("--background-color","#070026"),r.setProperty("--window-color","#000052"),r.setProperty("--window-border","blue"),r.setProperty("--footer-color","#0000db"),r.setProperty("--button-main-color","blue"),r.setProperty("--button-main-border","#427be1"),r.setProperty("--button-main-hover","#1515cf"),r.setProperty("--button-extra-hover","#2400d7"),r.setProperty("--main-text-color","dodgerblue"),r.setProperty("--blue-text-color","#82cb3b"),r.setProperty("--gray-text-color","#9b9b9b");break}setTimeout(()=>{r.removeProperty("--transition")},1e3)},y=e=>{let s=t("blocker");if(t("blocker").style.display==="block")return console.warn("Wasn't able to show another window (alert)");t("alertText").textContent=e;let n=t("confirmBtn");s.style.display="block";let r=()=>{s.style.display="none",n.removeEventListener("click",r)};n.addEventListener("click",r)},T=async e=>await new Promise(s=>{let n=t("blocker");n.style.display==="block"&&(console.warn("Wasn't able to show another window (confirm)"),s(!1)),t("alertText").textContent=e;let r=t("cancelBtn"),a=t("confirmBtn");n.style.display="block",r.style.display="block";let c=async()=>{n.style.display="none",r.style.display="none",a.removeEventListener("click",c),r.removeEventListener("click",u),s(!0)},u=async()=>{n.style.display="none",r.style.display="none",a.removeEventListener("click",c),r.removeEventListener("click",u),s(!1)};a.addEventListener("click",c),r.addEventListener("click",u)}),V=async e=>await new Promise(s=>{let n=t("blocker");n.style.display==="block"&&(console.warn("Wasn't able to show another window (prompt)"),s(null)),t("alertText").textContent=e;let r=t("inputArea"),a="",c=t("cancelBtn"),u=t("confirmBtn");n.style.display="block",c.style.display="block",r.style.display="block";let l=()=>{a=r.value},g=async()=>{n.style.display="none",c.style.display="none",r.style.display="none",r.value="",u.removeEventListener("click",g),c.removeEventListener("click",f),r.removeEventListener("blur",l),s(a)},f=async()=>{n.style.display="none",c.style.display="none",r.style.display="none",r.value="",u.removeEventListener("click",g),c.removeEventListener("click",f),r.removeEventListener("blur",l),s(null)};u.addEventListener("click",g),c.addEventListener("click",f),r.addEventListener("blur",l)}),U=()=>{let e=t("footer"),s=t("footerColor"),n=t("hideToggle"),r=t("hideText"),a=t("hideArrow");o.footer=!o.footer,n.removeEventListener("click",U),o.footer?(s.style.display="",a.style.transform="",e.style.animation="hide 1s forwards reverse",a.style.animation="rotate 1s forwards reverse",r.textContent="Hide"):(e.style.animation="hide 1s backwards",a.style.animation="rotate 1s backwards",r.textContent="Show",setTimeout(()=>{s.style.display="none",a.style.transform="rotate(180deg)"},1e3)),setTimeout(()=>{e.style.animation="",a.style.animation="",n.addEventListener("click",U)},1e3)},O=(e=!1,s="toggle",n="building")=>{var r;switch(s){case"toggle":{let a=e,c=Boolean((r=localStorage.getItem("screen reader"))!=null?r:!1),u=t("screenReaderToggle");a&&(c=!c),c?(u.textContent="ON",u.style.borderColor="crimson",u.setAttribute("aria-label","Screen reader support is ON"),localStorage.setItem("screen reader","true"),o.screenReader=!0,n==="reload"&&(i.buyToggle.strict=!1,o.intervals.main=100,o.intervals.numbers=1e3),a&&y(`For full support please refresh page. This will allow to buy upgrades on focus (because I have no idea how to make an image clickable with a keyboard), also you will get a special tab where you can check how much you own and more.
(For non screen readers this will cause issues)`)):(u.textContent="OFF",u.style.borderColor="",u.setAttribute("aria-label","Screen reader support is OFF"),localStorage.removeItem("screen reader"),o.screenReader=!1);break}case"button":{let a=e,{stage:c}=i,u=t("invisibleBought");if(n==="building"){let{buildings:l}=i,{buildingsInfo:g}=o,f=a-1;c.current===2&&a>2&&(f=1),a===0?u.textContent=`You have ${d(l[0].current)} ${g.name[0]}`:u.textContent=`You have ${d(l[a].current)} ${g.name[a]}, next one will cost ${d(g.cost[a])} ${g.name[f]}, they are producing ${d(g.producing[a])} ${g.name[f]} per second${i.researchesAuto[1]>=a?`, auto is ${i.toggles[a+3]?"on":"off"}`:""}`}else c.current===1?u.textContent=`You have ${i.energy.current} Energy${i.upgrades[3]===1?`, next discharge goal is ${d(o.dischargeInfo.next)} Energy`:""}`:c.current===2&&(u.textContent=`You have ${i.vaporization.clouds} Clouds`);break}}},F=(e=!1)=>{let s=document.body.style,n=t("customFontSize"),r=localStorage.getItem("fontSize");i.toggles[3]?((r===null||Number(r)<10||Number(r)>32||e)&&(r=String(Math.min(Math.max(Math.trunc(Number(n.value)*10)/10,10),32)),localStorage.setItem("fontSize",r)),s.setProperty("--font-size",`${r}px`),n.value=r):(s.setProperty("--font-size","1em"),localStorage.removeItem("fontSize"))};var i={stage:{true:1,current:1},energy:{current:0,total:0},discharge:{current:0,bonus:0},vaporization:{current:0,clouds:1},time:{updated:Date.now(),started:Date.now()},buildings:[{current:3,total:3},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0}],upgrades:[0,0,0,0,0,0,0,0],researches:[0,0,0,0,0],researchesAuto:[0,0,0],toggles:[],buyToggle:{howMany:1,input:10,strict:!0}},o={tab:"stage",footer:!0,screenReader:!1,energyType:[0,1,5,20],timeSpecial:{lastSave:0,maxOffline:3600},stageInfo:{word:["Microworld","Submerged"],priceName:["Energy","Drops"],resourceName:["Energy","Clouds"]},theme:{stage:1,default:!0},dischargeInfo:{next:1},intervals:{main:50,numbers:50,visual:1,autoSave:180},intervalsId:{main:0,numbers:0,visual:0,autoSave:0},buildingsInfo:{name:["Quarks","Particles","Atoms","Molecules"],cost:[0,3,24,3],increase:1.4,producing:[0,0,0,0,0,0]},upgradesInfo:{description:["Bigger electrons. Particles cost decreased.","Stronger protons. Particles produce more.","More neutrons. Increased gain of Particles.","Superposition. Unlocks new reset tier.","Protium. Basic.","Deuterium. Heavy.","Tritium. Radioactive.","Nuclear fusion. More energy."],effectText:[["Particle cost is "," times cheaper."],["Particles produce "," times more Quarks."],["Atoms produce "," times more Particles."],["Abbility to reset at any time and boost production for all buildings by ",", if had enough energy."],["Cost scalling is decreased by ","."],["Buildings (only bought one's) boost themselfs by "," times."],["Molecules produce Molecules. At a reduced rate."],["Unspent energy boost Molecules production of themselfs 1 to 1."]],effect:[10,10,5,4,.2,1.01,0,0],cost:[9,12,36,300,800,5e3,15e3,36e3]},upgradesS2Info:{description:["Surface tension. Allows for bigger Puddles.","Streams. Spread quicker.","","Vaporization. Unlock new reset tier.","",""],effectText:[["Each Puddle boost Puddle production by ","."],["Ponds boost to Puddles produtcion is now "," times bigger."],["",""],["Gain ability to convert Drops into Clouds. ("," per 1)"],["",""],["",""]],effect:[1.03,1.5,0,1e10,0,0],cost:[1e3,2e8,0,1e10,0,0]},researchesInfo:{description:["Effect of 'Protium' upgrade is stronger.","Effect of 'Deuterium' upgrade is bigger.","Effect of 'Tritium' upgrade is better.","Discharge bonus improved.","Gain more energy from buying a building."],effectText:[["Cost scalling is "," smaller for each level."],["Each bought building boost each other by additional ","."],["Molecules now produce themselfs "," times quicker."],["Discharge is now gives extra +"," bonus per reached goal."],["A single building now gives "," times more energy."]],effect:[.01,.01,12,1,3],cost:[2e3,6500,2e4,12e3,42e3],scalling:[300,1500,1800,0,81456],max:[9,3,9,1,2]},researchesS2Info:{description:["More moles.","Production of Drops is boosted.","Surface stress."],effectText:[["Drops produce "," times more moles."],["Drops now give boost to what produces them based of bought amount, at a reduced rate."],["Surface tension upgrade is now +"," stronger."]],effect:[3,0,.01],cost:[20,1e9,1e5],scalling:[1.2,0,10],max:[9,1,2]},researchesAutoInfo:{description:["Buy toggles.","Automatization for buying upgrades.","More max offline time."],effectText:[["Unlock abbility to buy multiple buildings at same time."],["Will automatically buy "," for you."],["Research this to make max offline timer +"," hours."]],effect:[0,"Particles",1],cost:[300,3e3,1e11],scalling:[0,5e3,0],max:[1,3,1]}},X=e=>{let s=[];for(let n=0;n<e;n++)n>=4&&n<=8?s.push(!1):s.push(!0);return s},Z=document.getElementsByClassName("toggle").length;Object.assign(i,{toggles:X(Z)});var p=structuredClone(i),v=structuredClone(o),G=e=>{let s;return e==="p"?s=structuredClone(p):s=structuredClone(v),s},q=e=>{if(Object.prototype.hasOwnProperty.call(e,"player")&&Object.prototype.hasOwnProperty.call(e,"global")){let s=G("p");for(let a in p)Object.prototype.hasOwnProperty.call(e.player,a)||(e.player[a]=s[a]);let n=`upgrades${e.player.stage.current>1?`S${e.player.stage.current}`:""}Info`,r=`researches${e.player.stage.current>1?`S${e.player.stage.current}`:""}Info`;if(o[n].cost.length>e.player.upgrades.length)for(let a=e.player.upgrades.length;a<o[n].cost.length;a++)e.player.upgrades[a]=0;if(o[r].cost.length>e.player.researches.length)for(let a=e.player.researches.length;a<o[r].cost.length;a++)e.player.researches[a]=0;if(p.buildings.length>e.player.buildings.length)for(let a=e.player.buildings.length;a<p.buildings.length;a++)e.player.buildings[a]={current:0,true:0,total:0};if(p.researchesAuto.length>e.player.researchesAuto.length)for(let a=e.player.researchesAuto.length;a<p.researchesAuto.length;a++)e.player.researchesAuto[a]=0;if(p.toggles.length>e.player.toggles.length)for(let a=e.player.toggles.length;a<p.toggles.length;a++)e.player.toggles[a]=s.toggles[a];Object.assign(i,e.player),o.intervals=e.global.intervals}else y("Save file coudn't be loaded as its missing important info.")};var t=e=>{let s=document.getElementById(e);if(s!==null)return s;throw y("Some ID failed to load, game won't be working properly. Please refresh."),new TypeError(`ID "${e}" not found.`)},J=async(e=!1)=>{if(e){let s=localStorage.getItem("save"),n=localStorage.getItem("theme");if(s!==null){let r=JSON.parse(atob(s));q(r),i.toggles[0]&&y(`Welcome back, you were away for ${d(Date.now()-i.time.updated,0,"time")}.`)}else y("Welcome. This is a test-project. Since I don't expect anyone to play this, save file can get corrupted with a new version.");n!==null&&(o.theme.default=!1,o.theme.stage=Number(n))}O(!1,"toggle","reload"),N(),M(),F();for(let s=0;s<p.toggles.length;s++)Y(s,!1);L(),R(),e&&!i.toggles[0]&&await T(`Welcome back, you were away for ${d(Date.now()-i.time.updated,0,"time")}. Game was set to have offline time disabled. Press confirm to NOT to gain offline time.`)&&(i.time.updated=Date.now()),w(!1,"all")};J(!0);var{screenReader:P}=o;for(let e=0;e<p.toggles.length;e++)t(`toggle${e}`).addEventListener("click",()=>Y(e));for(let e=1;e<p.buildings.length;e++)t(`building${e}Btn`).addEventListener("click",()=>E(e));for(let e=0;e<o.upgradesInfo.cost.length;e++)t(`upgrade${e+1}`).addEventListener("mouseover",()=>C(e)),t(`upgrade${e+1}`).addEventListener("click",()=>I(e)),P&&t(`upgrade${e+1}`).addEventListener("focus",()=>I(e));for(let e=0;e<o.upgradesS2Info.cost.length;e++)t(`upgradeW${e+1}`).addEventListener("mouseover",()=>C(e)),t(`upgradeW${e+1}`).addEventListener("click",()=>I(e)),P&&t(`upgradeW${e+1}`).addEventListener("focus",()=>I(e));t("dischargeReset").addEventListener("click",async()=>await _());t("vaporizationReset").addEventListener("click",async()=>await K());t("stageReset").addEventListener("click",async()=>await Q());t("buy1x").addEventListener("click",()=>L("1"));t("buyAny").addEventListener("click",()=>L("any"));t("buyAnyInput").addEventListener("blur",()=>L("any"));t("buyMax").addEventListener("click",()=>L("max"));t("buyStrict").addEventListener("click",()=>L("strict"));for(let e=0;e<o.researchesInfo.cost.length;e++)t(`research${e+1}Image`).addEventListener("mouseover",()=>C(e,"researches")),t(`research${e+1}Image`).addEventListener("click",()=>I(e,"researches")),P&&t(`research${e+1}Image`).addEventListener("focus",()=>I(e,"researches"));for(let e=0;e<o.researchesS2Info.cost.length;e++)t(`researchW${e+1}Image`).addEventListener("mouseover",()=>C(e,"researches")),t(`researchW${e+1}Image`).addEventListener("click",()=>I(e,"researches")),P&&t(`researchW${e+1}Image`).addEventListener("focus",()=>I(e,"researches"));for(let e=0;e<o.researchesAutoInfo.cost.length;e++)t(`researchAuto${e+1}Image`).addEventListener("mouseover",()=>C(e,"researchesAuto")),t(`researchAuto${e+1}Image`).addEventListener("click",()=>I(e,"researchesAuto")),P&&t(`researchAuto${e+1}Image`).addEventListener("focus",()=>I(e,"researchesAuto"));t("save").addEventListener("click",async()=>await A("save"));t("file").addEventListener("change",async()=>await A("load"));t("export").addEventListener("click",async()=>await A("export"));t("delete").addEventListener("click",async()=>await A("delete"));t("switchTheme0").addEventListener("click",()=>j(0,!0));for(let e=1;e<=o.stageInfo.word.length;e++)t(`switchTheme${e}`).addEventListener("click",()=>j(e));t("mainInterval").addEventListener("blur",()=>w(!1,"main"));t("numbersInterval").addEventListener("blur",()=>w(!1,"numbers"));t("visualInterval").addEventListener("blur",()=>w(!1,"visual"));t("autoSaveInterval").addEventListener("blur",()=>w(!1,"autoSave"));t("pauseGame").addEventListener("click",async()=>await ee());t("toggle3").addEventListener("click",()=>F());t("customFontSize").addEventListener("blur",()=>F(!0));t("screenReaderToggle").addEventListener("click",()=>O(!0));if(P){for(let e=0;e<p.buildings.length;e++)t(`invisibleGetBuilding${e}`).addEventListener("click",()=>O(e,"button"));t("invisibleGetResource1").addEventListener("click",()=>O(0,"button","resource")),t("specialTabBtn").addEventListener("click",()=>M("special"))}else t("specialTabBtn").style.display="none";t("hideToggle").addEventListener("click",U);t("stageTabBtn").addEventListener("click",()=>M("stage"));t("researchTabBtn").addEventListener("click",()=>M("research"));t("settingsTabBtn").addEventListener("click",()=>M("settings"));function w(e=!1,s=""){let{intervals:n,intervalsId:r}=o;if(s!==""){let a=t("mainInterval"),c=t("numbersInterval"),u=t("visualInterval"),l=t("autoSaveInterval");if(s==="main")n.main=Math.min(Math.max(Math.trunc(Number(a.value)),20),1e3),n.main>n.numbers&&(n.numbers=n.main);else if(s==="numbers"){let g=Math.min(Math.max(Math.trunc(Number(c.value)),20),1e3);n.numbers=Math.max(g,n.main)}else s==="visual"?n.visual=Math.min(Math.max(Math.trunc(Number(u.value)*10)/10,.5),10):s==="autoSave"&&(n.autoSave=Math.min(Math.max(Math.trunc(Number(l.value)),60),1800));a.value=String(n.main),c.value=String(n.numbers),u.value=String(n.visual),l.value=String(n.autoSave)}clearInterval(r.main),clearInterval(r.numbers),clearInterval(r.visual),clearInterval(r.autoSave),e||(r.main=setInterval(D,n.main),r.numbers=setInterval(S,n.numbers),r.visual=setInterval(B,n.visual*1e3),r.autoSave=setInterval(A,n.autoSave*1e3,"save"))}async function A(e){switch(e){case"load":{let s=t("file"),n=s.files;if(n===null)return y("Loaded file wasn't found.");let r=await n[0].text();try{let a=JSON.parse(atob(r));w(!0),q(a),i.toggles[0]||await T(`This save file was set to have offline progress disabled (currently ${d(Date.now()-i.time.updated,0,"time")}). Press confirm to NOT to gain offline time.`)&&(i.time.updated=Date.now()),J()}catch(a){y("Incorrect save file format.")}finally{s.value=""}break}case"save":{let s=btoa(`{"player":${JSON.stringify(i)},"global":{"intervals":${JSON.stringify(o.intervals)}}}`);localStorage.setItem("save",s),t("isSaved").textContent="Saved",o.timeSpecial.lastSave=0;break}case"export":{await A("save");let s=localStorage.getItem("save");if(s===null)return y("Save file wasn't found. Even though game was saved just now...");let n=document.createElement("a");n.href="data:text/plain;charset=utf-8,"+s,n.download="Fundamental.txt",n.click();break}case"delete":{let s=await V(`This will truly delete your save file!
Type 'delete' to confirm.`);(s==null?void 0:s.toLowerCase())==="delete"?(w(!0),localStorage.clear(),Object.assign(i,G("p")),Object.assign(o,G("g")),i.time.started=Date.now(),i.time.updated=i.time.started,J()):s!==null&&s!==""&&y(`You wrote '${s}', so save file wasn't deleted.`);break}}}var ee=async()=>{w(!0);let e=await V(`Game is currently paused. Press any button bellow to unpause it. If you want you can enter 'NoOffline' to NOT to gain offline time. (Max offline time is ${o.timeSpecial.maxOffline/3600} hours)`);(e==null?void 0:e.toLowerCase())==="nooffline"?i.time.updated=Date.now():e!==null&&e!==""&&y(`You wrote '${e}', so you gained offline time.`),w()};})();
