"use strict";(()=>{var q=e=>{let{stage:r,buildings:s}=l;switch(e){case"discharge":l.energy.current=0;for(let n=0;n<m.buildings.length;n++)n===0?(s[0].current=3,s[0].total+=3):(s[n].current=0,s[n].true=0,v(n));break;case"stage":{l.upgrades=[],l.researches=[];let{upgrades:n,researches:o}=l;for(let a=1;a<m.buildings.length;a++)s[a].current=0,s[a].true=0,s[a].total=0;switch(r.current){case 1:l.energy.current=0,l.energy.total=0,l.discharge.current=0,s[0].current=3,s[0].total=3;for(let a=0;a<i.upgradesInfo.cost.length;a++)n[a]=0;for(let a=0;a<i.researchesInfo.cost.length;a++)o[a]=0;break;case 2:s[0].current=.0025,s[0].total=.0025;break}P(),B();break}}x()};var $=(e,r,s=!1)=>{if(e[r-1].current<i.buildingsInfo.cost[r]*(s?2:1)){i.screenReader&&!s&&(t("invisibleBought").textContent=`Coudn't buy '${i.buildingsInfo.name[r]}', because didn't had enough of '${i.buildingsInfo.name[r-1]}'`);return}let{stage:n,researchesAuto:o,buyToggle:a}=l,{stageInfo:u,buildingsInfo:g}=i;if(n.current===1&&(i.energyType[r]=w.energyType[r]*2**l.researches[4]),a.howMany!==1&&o[0]>0||s){let y=e[r-1].current/(s?2:1),d=g.cost[r],b=0,U=s?-1:a.howMany;for(var c=0;y>=d&&c!==U;c++)b+=d,y-=d,d*=g.increase;if(c<U&&U!==-1&&a.strict)return;e[r-1].current-=b,e[r].current+=c,e[r].true+=c,e[r].total+=c,n.current===1&&(l.energy.current+=i.energyType[r]*c,l.energy.total+=i.energyType[r]*c),i.screenReader&&!s&&(t("invisibleBought").textContent=`Bought ${f(c)} '${g.name[r]}'${n.current===1?`, gained ${f(i.energyType[r]*c)} ${u.resourceName[n.current]}`:""}`)}else(a.howMany===1||o[0]===0)&&(e[r-1].current-=g.cost[r],e[r].current++,e[r].true++,e[r].total++,n.current===1&&(l.energy.current+=i.energyType[r],l.energy.total+=i.energyType[r]),i.screenReader&&(t("invisibleBought").textContent=`Bought 1 '${g.name[r]}'${n.current===1?`, gained ${i.energyType[r]} ${u.resourceName[n.current]}`:""}`));v(r),N(),x()},v=e=>{let{stage:r,buildings:s,upgrades:n,researches:o}=l,{buildingsInfo:a}=i;r.current===1&&(i.upgradesInfo.effect[4]=Math.trunc((.2+o[0]*.01)*100)/100,a.increase=Math.trunc((1.4-(n[4]===1?i.upgradesInfo.effect[4]:0))*100)/100),a.cost[e]=w.buildingsInfo.cost[e]*a.increase**s[e].true,e===1&&n[0]===1&&r.current===1&&(a.cost[1]/=10)},M=(e,r,s=r+"Info")=>{l[r][e]!==i[s].max[e]&&(i[s].cost[e]=w[s].cost[e]+i[s].scalling[e]*l[r][e])},I=(e,r)=>{let{buildings:s}=l,{buildingsInfo:n}=i,o=s[e].current;if(l.stage.current===1&&e===3){if(n.producing[3]<=1)return;s[e].current+=Math.log(n.producing[e])*r*12**l.researches[2]*(l.upgrades[7]===1?l.energy.current:1)}else s[e].current+=n.producing[e+1]*r;s[e].total+=s[e].current-o},C=(e,r="upgrade")=>{let{stage:s}=l;switch(r){case"upgrade":{let{upgrades:n}=l;if(s.current===1){let{energy:o}=l,{upgradesInfo:a}=i;if(n[e]===1||o.current<a.cost[e])return;if(n[e]=1,o.current-=a.cost[e],t(`upgrade${e+1}`).style.backgroundColor="green",e===0)v(1);else if(e===3)t("discharge").style.display="";else if(e===4)for(let u=1;u<i.buildingsInfo.name.length;u++)v(u);i.screenReader&&(t("invisibleBought").textContent=`You have bought upgrade '${a.description[e]}'`)}break}case"research":{let{researches:n}=l;if(s.current===1){let{energy:o}=l,{researchesInfo:a}=i;if(n[e]===a.max[e]||o.current<a.cost[e])return;let u=t(`research${e+1}Stage1Level`);if(n[e]++,o.current-=a.cost[e],u.textContent=String(n[e]),n[e]!==a.max[e]?u.classList.replace("redText","orchidText"):(u.classList.remove("redText","orchidText"),u.classList.add("greenText")),e===0)for(let g=1;g<i.buildingsInfo.name.length;g++)v(g);i.screenReader&&(t("invisibleBought").textContent=`You have researched '${a.description[e]}', level is now ${n[e]} ${n[e]===a.max[e]?"maxed":""}`),M(e,"researches")}break}case"researchAuto":{let{researchesAuto:n}=l,{researchesAutoInfo:o}=i,a=t(`researchAuto${e+1}Level`);if(s.current===1){let{energy:u}=l;if(n[e]===o.max[e]||u.current<o.cost[e]||e>1)return;n[e]++,u.current-=o.cost[e]}else if(s.current===2)return;a.textContent=String(n[e]),n[e]!==o.max[e]?a.classList.replace("redText","orchidText"):(a.classList.remove("redText","orchidText"),a.classList.add("greenText")),i.screenReader&&(t("invisibleBought").textContent=`You have researched '${o.description[e]}', level is now ${n[e]} ${n[e]===o.max[e]?"maxed":""}`),M(e,"researchesAuto");break}}x(),L(e,r)},G=(e,r=!0)=>{var o,a,u,g;let{toggles:s}=l,n=t(`toggle${e}`);r&&(s[e]=!s[e]),n.classList.contains("auto")?s[e]?(n.textContent="Auto ON",n.style.borderColor=""):(n.textContent="Auto OFF",n.style.borderColor="crimson"):s[e]?(n.textContent="ON",n.style.borderColor="",i.screenReader&&(n.ariaLabel=(g=(u=n.ariaLabel)==null?void 0:u.replace(" OFF"," ON"))!=null?g:"")):(n.textContent="OFF",n.style.borderColor="crimson",i.screenReader&&(n.ariaLabel=(a=(o=n.ariaLabel)==null?void 0:o.replace(" ON"," OFF"))!=null?a:""))},k=(e="none")=>{let{buyToggle:r}=l,s=t("buyAnyInput");switch(e){case"1":r.howMany=1;break;case"max":r.howMany=-1;break;case"any":r.input=Math.max(Math.trunc(Number(s.value)),-1),r.input===0&&(r.input=1),r.howMany=r.input;break;case"strict":r.strict=!r.strict;break;default:s.value=String(r.input)}t("buyStrict").style.borderColor=r.strict?"":"crimson",t("buy1x").style.backgroundColor=r.howMany===1?"green":"",t("buyAny").style.backgroundColor=Math.abs(r.howMany)!==1?"green":"",t("buyMax").style.backgroundColor=r.howMany===-1?"green":""},J=async()=>{let{stage:e,buildings:r,researchesAuto:s,toggles:n}=l,o=!1;if(e.current===1)if(r[3].current>=1e21){let a=!0;n[2]&&(a=await T("Ready to enter next stage?")),a&&(s[0]===0&&s[0]++,o=!0)}else p("There are more molecules in a single drop than that you know.");else p("Not yet in game");o&&p("There is nothing past stage 1 for now")},V=async()=>{let{energy:e}=l,{dischargeInfo:r}=i;if(l.upgrades[3]===1&&l.buildings[1].true>0&&l.stage.current===1){let s=!0;l.toggles[1]&&e.current<r.next?s=await T("This will reset all of your current buildings and energy. You will NOT gain production boost. Continue?"):l.toggles[1]&&e.current>=r.next&&(s=await T("You have enough energy to gain boost. Continue?")),s&&(e.current>=r.next?(r.next*=10,l.discharge.current++,i.screenReader&&(t("invisibleBought").textContent="Buildings and energy were reset for some boost")):i.screenReader&&e.current<r.next&&(t("invisibleBought").textContent="Buildings and energy were reset, no boost"),q("discharge"))}};var S=(e="none")=>{if(i.tab!==e){t("stageTab").style.display="none",t("stageTabBtn").style.borderColor="",t("researchTab").style.display="none",t("researchTabBtn").style.borderColor="",t("settingsTab").style.display="none",t("settingsTabBtn").style.borderColor="";let r=["#e3e3e3","#a10000"][i.theme.stage-1],s=t("invisibleTab");t("specialTab").style.display="none",e!=="none"?i.tab=e:i.tab="stage",t(`${i.tab}Tab`).style.display="",t(`${i.tab}TabBtn`).style.borderColor=r,s.textContent=`Current tab: ${i.tab} tab`,j(),x()}},N=()=>{let{stage:e,time:r,buildings:s,upgrades:n,researches:o,researchesAuto:a,toggles:u}=l,{buildingsInfo:g}=i,c=Date.now()-r.updated,y=c/1e3;if(r.updated=Date.now(),c<0)return console.warn("Negative passed time detected.");if(i.lastSave+=c,y>3600&&(y=3600,console.log("Max offline progress is 1 hour.")),e.current===1){let{discharge:d}=l,{upgradesInfo:b}=i;u[6]&&a[1]>=3&&$(s,3,!0),g.producing[3]=.3*s[3].current*b.effect[3]**d.current,n[5]===1&&(g.producing[3]*=b.effect[5]**s[3].true),I(2,y),b.effect[5]=Math.trunc((1.02+.01*o[1])*100)/100,b.effect[3]=4+1*o[3],n[6]===1&&I(3,y),u[5]&&a[1]>=2&&$(s,2,!0),g.producing[2]=.4*s[2].current*b.effect[3]**d.current,n[2]===1&&(g.producing[2]*=5),n[5]===1&&(g.producing[2]*=b.effect[5]**s[2].true),I(1,y),u[4]&&a[1]>=1&&$(s,1,!0),g.producing[1]=.5*s[1].current*b.effect[3]**d.current,n[1]===1&&(g.producing[1]*=10),n[5]===1&&(g.producing[1]*=b.effect[5]**s[1].true),I(0,y)}else e.current===2&&(g.producing[1]=4e-4*s[1].current,I(0,y))},x=()=>{let{stage:e,buildings:r,upgrades:s}=l,{tab:n,buildingsInfo:o}=i;i.footer&&(e.current===1?(t("quarks").textContent=`Quarks: ${f(r[0].current)}`,l.energy.total>=9&&(t("energy").textContent=`Energy: ${f(l.energy.current,0)}`)):e.current===2&&(t("water").textContent=`Moles: ${f(r[0].current,4)}`)),n==="stage"?(t("building1Cur").textContent=f(r[1].current),t("building1Prod").textContent=f(o.producing[1]),e.current===1?(o.cost[1]<=r[0].current?(t("building1Btn").classList.add("availableBuilding"),t("building1Btn").textContent=`Buy for: ${f(o.cost[1])} Quarks`):(t("building1Btn").classList.remove("availableBuilding"),t("building1Btn").textContent=`Need: ${f(o.cost[1])} Quarks`),r[1].total>=11&&(t("building2Cur").textContent=f(r[2].current),t("building2Prod").textContent=f(o.producing[2]),o.cost[2]<=r[1].current?(t("building2Btn").classList.add("availableBuilding"),t("building2Btn").textContent=`Buy for: ${f(o.cost[2])} Particles`):(t("building2Btn").classList.remove("availableBuilding"),t("building2Btn").textContent=`Need: ${f(o.cost[2])} Particles`)),r[2].total>=2&&(t("building3Cur").textContent=f(r[3].current),t("building3Prod").textContent=f(o.producing[3]),o.cost[3]<=r[2].current?(t("building3Btn").classList.add("availableBuilding"),t("building3Btn").textContent=`Buy for: ${f(o.cost[3])} Atoms`):(t("building3Btn").classList.remove("availableBuilding"),t("building3Btn").textContent=`Need: ${f(o.cost[3])} Atoms`)),s[3]===1&&(t("dischargeReset").textContent=`Next goal is ${f(i.dischargeInfo.next,0)} Energy`,t("dischargeEffect").textContent=String(i.upgradesInfo.effect[3]))):e.current===2&&(o.cost[1]<=r[0].current?(t("building1Btn").classList.add("availableBuilding"),t("building1Btn").textContent=`Buy for: ${f(o.cost[1],4)} Moles`):(t("building1Btn").classList.remove("availableBuilding"),t("building1Btn").textContent=`Need: ${f(o.cost[1],4)} Moles`))):n==="settings"&&i.lastSave>=1e3&&(t("isSaved").textContent=`${f(i.lastSave,0,"time")} ago`)},j=()=>{let{stage:e,buildings:r,upgrades:s,researchesAuto:n}=l;if(e.current===1){let{energy:o,discharge:a}=l;t("energyStat").style.display=o.total>=9?"":"none",t("building2").style.display=r[1].total>=11?"":"none",t("building3").style.display=r[2].total>=2?"":"none",o.total>=9&&(t("upgrades").style.display=""),t("discharge").style.display=s[3]>0?"":"none",a.current>=1&&(t("resetToggles").style.display="");for(let u=5;u<=8;u++)a.current>=3?t(`upgrade${u}`).style.display="":t(`upgrade${u}`).style.display="none";a.current>=4&&(t("researchTabBtn").style.display=""),s[7]===1&&(t("stage").style.display=""),r[3].current>=1e21&&(t("stageReset").textContent="Enter next stage"),i.screenReader&&(t("invisibleGetBuilding2").style.display=r[2].total>0?"":"none",t("invisibleGetBuilding3").style.display=r[3].total>0?"":"none")}for(let o=1;o<m.buildings.length;o++)n[1]>=o?t(`toggle${o+3}`).style.display="":t(`toggle${o+3}`).style.display="none";t("toggleBuy").style.display=n[0]>0?"":"none"},L=(e,r="upgrade")=>{let{stage:s}=l,{stageInfo:n}=i;switch(r){case"upgrade":{let{upgrades:o}=l;if(s.current===1){let{upgradesInfo:a}=i;t("upgradeText").textContent=a.description[e],t("upgradeEffect").textContent=`${a.effectText[e][0]}${a.effect[e]}${a.effectText[e][1]}`,t("upgradeCost").textContent=`${o[e]===1?0:a.cost[e]} ${n.resourceName[s.current-1]}.`}break}case"research":{let{researches:o}=l;if(s.current===1){let{researchesInfo:a}=i;t("researchText").textContent=a.description[e],t("researchEffect").textContent=`${a.effectText[e][0]}${a.effect[e]}${a.effectText[e][1]}`,t("researchCost").textContent=`${o[e]===a.max[e]?0:a.cost[e]} ${n.resourceName[s.current-1]}.`}break}case"researchAuto":{let{researchesAuto:o}=l,{researchesAutoInfo:a}=i;t("researchText").textContent=a.description[e],e===1&&(a.effect[1]=i.buildingsInfo.name[Math.min(o[1]+1,i.buildingsInfo.name.length-1)]),t("researchEffect").textContent=`${a.effectText[e][0]}${a.effect[e]}${a.effectText[e][1]}`,t("researchCost").textContent=`${o[e]===a.max[e]?0:a.cost[e]} ${n.resourceName[s.current-1]}.`;break}}},f=(e,r=e<1e3?2:0,s="number")=>{switch(s){case"number":if(l.stage.current===2&&r===4&&e>=1e3&&(r=0),r>0&&e<1e6)return String(Math.trunc(e*10**r)/10**r);if(r<=0&&e<1e6)return String(Math.trunc(e));{let n=Math.trunc(Math.log10(e));return`${Math.trunc(e/10**n*100)/100}e${n}`}case"time":return e>=1728e5?`${Math.trunc(e/864e5)} days`:e>=72e5?`${Math.trunc(e/36e5)} hours`:e>=6e5?`${Math.trunc(e/6e4)} minutes`:`${Math.trunc(e/1e3)} seconds`}},P=()=>{let{stage:e,upgrades:r,researches:s,researchesAuto:n}=l,{stageInfo:o,buildingsInfo:a,researchesAutoInfo:u}=i,g=document.body.style;t("upgradeCost").classList.remove("orangeText","cyanText"),t("researchCost").classList.remove("orangeText","cyanText");for(let c=2;c<m.buildings.length;c++)t(`building${c}`).style.display="none";if(e.current===1){let{upgradesInfo:c,researchesInfo:y}=i;a.name=["Quarks","Particles","Atoms","Molecules"],w.buildingsInfo.cost=[0,3,24,3],i.dischargeInfo.next=10**l.discharge.current,t("upgradeCost").classList.add("orangeText"),t("researchCost").classList.add("orangeText");for(let d=0;d<c.cost.length;d++)r[d]===1?t(`upgrade${[d+1]}`).style.backgroundColor="green":t(`upgrade${[d+1]}`).style.backgroundColor="";for(let d=0;d<y.cost.length;d++)t(`research${d+1}Stage1Level`).textContent=String(s[d]),t(`research${d+1}Stage1Level`).classList.remove("redText","orchidText","greenText"),M(d,"researches"),s[d]===y.max[d]?t(`research${d+1}Stage1Level`).classList.add("greenText"):s[d]===0?t(`research${d+1}Stage1Level`).classList.add("redText"):t(`research${d+1}Stage1Level`).classList.add("orchidText");t("quarkStat").style.display="",t("particles").style.display="",t("atoms").style.display="",t("molecules").style.display="",t("dischargeToggleReset").style.display="";for(let d=1;d<=4;d++)t(`upgrade${d}`).style.display="";for(let d=1;d<=y.cost.length;d++)t(`research${d}Stage1`).style.display="";e.true===1&&(t("upgrades").style.display="none",t("resetToggles").style.display="none",t("researchTabBtn").style.display="none",t("stage").style.display="none",t("stageToggleReset").style.display="none",t("themeArea").style.display="none")}else e.current===2&&(a.name=["Moles of water","Drops"],w.buildingsInfo.cost=[0,.0025],t("upgradeCost").classList.add("cyanText"),t("researchCost").classList.add("cyanText"),t("waterStat").style.display="",t("drops").style.display="");for(let c=1;c<a.name.length;c++)t(`building${c}Name`).textContent=a.name[c],v(c);u.max[1]=a.name.length-1;for(let c=0;c<u.cost.length;c++)t(`researchAuto${c+1}Level`).textContent=String(n[c]),t(`researchAuto${c+1}Level`).classList.remove("redText","orchidText","greenText"),M(c,"researchesAuto"),n[c]===u.max[c]?t(`researchAuto${c+1}Level`).classList.add("greenText"):n[c]===0?t(`researchAuto${c+1}Level`).classList.add("redText"):t(`researchAuto${c+1}Level`).classList.add("orchidText");if(t("researchAuto2Max").textContent=String(u.max[1]),e.current!==1){t("quarkStat").style.display="none",t("energyStat").style.display="none",t("particles").style.display="none",t("atoms").style.display="none",t("molecules").style.display="none",t("discharge").style.display="none",t("dischargeToggleReset").style.display="none";for(let c=1;c<=i.upgradesInfo.cost.length;c++)t(`upgrade${c}`).style.display="none";for(let c=1;c<=i.researchesInfo.cost.length;c++)t(`research${c}Stage1`).style.display="none"}if(e.current!==2&&(t("waterStat").style.display="none",t("drops").style.display="none"),e.true>1&&(t("upgrades").style.display="",t("resetToggles").style.display="",t("researchTabBtn").style.display="",t("stage").style.display="",t("stageToggleReset").style.display="",t("themeArea").style.display=""),t("stageReset").textContent="You are not ready",t("stageWord").textContent=o.word[e.current-1],e.current===1?(g.removeProperty("--border-image"),g.removeProperty("--border-stage"),g.removeProperty("--stage-text-color")):(g.setProperty("--border-image",`url(Used_art/Stage${e.current}%20border.png)`),e.current===2&&(g.setProperty("--border-stage","#1460a8"),g.setProperty("--stage-text-color","dodgerblue"))),i.screenReader){t("invisibleBought").textContent=`Current stage is '${o.word[e.current-1]}'`,t("invisibleGetResource1").style.display=e.current===1?"":"none";for(let c=2;c<m.buildings.length;c++)t(`invisibleGetBuilding${c}`).style.display="none";for(let c=0;c<a.name.length;c++)t(`invisibleGetBuilding${c}`).textContent=`Get information for ${a.name[c]}`}};var z=(e,r=!1)=>{let{theme:s}=i;r?(s.default=!0,localStorage.removeItem("theme")):(s.default=!1,s.stage=e,localStorage.setItem("theme",String(e))),B()},B=()=>{let{stage:e}=l,{stageInfo:r,theme:s}=i,n=document.body.style;switch(n.setProperty("--transition","1s"),s.default?(s.stage=e.current,t("currentTheme").textContent="Default"):t("currentTheme").textContent=r.word[s.stage-1],n.removeProperty("--background-color"),n.removeProperty("--window-color"),n.removeProperty("--window-border"),n.removeProperty("--footer-color"),n.removeProperty("--button-main-color"),n.removeProperty("--button-main-border"),n.removeProperty("--button-main-hover"),n.removeProperty("--button-extra-hover"),n.removeProperty("--main-text-color"),n.removeProperty("--blue-text-color"),s.stage){case 2:n.setProperty("--background-color","#070026"),n.setProperty("--window-color","#000052"),n.setProperty("--window-border","blue"),n.setProperty("--footer-color","#0000db"),n.setProperty("--button-main-color","blue"),n.setProperty("--button-main-border","#427be1"),n.setProperty("--button-main-hover","#1515cf"),n.setProperty("--button-extra-hover","#2400d7"),n.setProperty("--main-text-color","dodgerblue"),n.setProperty("--blue-text-color","#82cb3b");break}setTimeout(()=>{n.removeProperty("--transition")},1e3)},p=e=>{let r=t("blocker");if(t("blocker").style.display==="block")return console.warn("Wasn't able to show another window (alert)");t("alertText").textContent=e;let s=t("confirmBtn");r.style.display="block";let n=()=>{r.style.display="none",s.removeEventListener("click",n)};s.addEventListener("click",n)},T=async e=>await new Promise(r=>{let s=t("blocker");s.style.display==="block"&&(console.warn("Wasn't able to show another window (confirm)"),r(!1)),t("alertText").textContent=e;let n=t("cancelBtn"),o=t("confirmBtn");s.style.display="block",n.style.display="block";let a=async()=>{s.style.display="none",n.style.display="none",o.removeEventListener("click",a),n.removeEventListener("click",u),r(!0)},u=async()=>{s.style.display="none",n.style.display="none",o.removeEventListener("click",a),n.removeEventListener("click",u),r(!1)};o.addEventListener("click",a),n.addEventListener("click",u)}),Y=async e=>await new Promise(r=>{let s=t("blocker");s.style.display==="block"&&(console.warn("Wasn't able to show another window (prompt)"),r(null)),t("alertText").textContent=e;let n=t("inputArea"),o="",a=t("cancelBtn"),u=t("confirmBtn");s.style.display="block",a.style.display="block",n.style.display="block";let g=()=>{o=n.value},c=async()=>{s.style.display="none",a.style.display="none",n.style.display="none",n.value="",u.removeEventListener("click",c),a.removeEventListener("click",y),n.removeEventListener("blur",g),r(o)},y=async()=>{s.style.display="none",a.style.display="none",n.style.display="none",n.value="",u.removeEventListener("click",c),a.removeEventListener("click",y),n.removeEventListener("blur",g),r(null)};u.addEventListener("click",c),a.addEventListener("click",y),n.addEventListener("blur",g)}),R=()=>{let e=t("footer"),r=t("footerColor"),s=t("hideToggle"),n=t("hideText"),o=t("hideArrow");i.footer=!i.footer,s.removeEventListener("click",R),i.footer?(r.style.display="",o.style.transform="",e.style.animation="hide 1s forwards reverse",o.style.animation="rotate 1s forwards reverse",n.textContent="Hide"):(e.style.animation="hide 1s backwards",o.style.animation="rotate 1s backwards",n.textContent="Show",setTimeout(()=>{r.style.display="none",o.style.transform="rotate(180deg)"},1e3)),setTimeout(()=>{e.style.animation="",o.style.animation="",s.addEventListener("click",R)},1e3)},A=(e=!1,r="toggle",s="building")=>{var n;switch(r){case"toggle":{let o=e,a=Boolean((n=localStorage.getItem("screen reader"))!=null?n:!1),u=t("screenReaderToggle");o&&(a=!a),a?(u.textContent="ON",u.style.borderColor="crimson",u.setAttribute("aria-label","Screen reader support is ON"),localStorage.setItem("screen reader","true"),i.screenReader=!0,s==="reload"&&(l.buyToggle.strict=!1,i.intervals.main=100,i.intervals.numbers=1e3),o&&p(`For full support please refresh page. This will allow to buy upgrades on focus (because I have no idea how to make an image clickable with a keyboard), also you will get a special tab where you can check how much you own and more.
(For non screen readers this will cause issues)`)):(u.textContent="OFF",u.style.borderColor="",u.setAttribute("aria-label","Screen reader support is OFF"),localStorage.removeItem("screen reader"),i.screenReader=!1);break}case"button":{let o=e,{stage:a}=l,u=t("invisibleBought");if(s==="building"){let{buildings:g}=l,{buildingsInfo:c}=i;o===0?u.textContent=`You have ${f(g[0].current)} ${c.name[0]}`:u.textContent=`You have ${f(g[o].current)} ${c.name[o]}, next one will cost ${f(c.cost[o])} ${c.name[o-1]}, they are producing ${f(c.producing[o])} ${c.name[o-1]} per second${l.researchesAuto[1]>=o?`, auto is ${l.toggles[o+3]?"on":"off"}`:""}`}else a.current===1&&(u.textContent=`You have ${l.energy.current} Energy${l.upgrades[3]===1?`, next discharge goal is ${f(i.dischargeInfo.next)} Energy`:""}`);break}}},O=(e=!1)=>{let r=document.body.style,s=t("customFontSize"),n=localStorage.getItem("fontSize");l.toggles[3]?((n===null||Number(n)<10||Number(n)>32||e)&&(n=String(Math.min(Math.max(Math.trunc(Number(s.value)*10)/10,10),32)),localStorage.setItem("fontSize",n)),r.setProperty("--font-size",`${n}px`),s.value=n):(r.setProperty("--font-size","1em"),localStorage.removeItem("fontSize"))};var l={stage:{true:1,current:1},energy:{current:0,total:0},discharge:{current:0,bonus:0},time:{updated:Date.now(),started:Date.now()},buildings:[{current:3,total:3},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0}],upgrades:[],researches:[],researchesAuto:[],toggles:[],buyToggle:{howMany:1,input:10,strict:!0}},i={tab:"stage",footer:!0,screenReader:!1,lastSave:0,energyType:[0,1,5,20],stageInfo:{word:["Microworld","Submerged"],resourceName:["Energy","Water drops"]},theme:{stage:1,default:!0},dischargeInfo:{next:1},intervals:{main:50,numbers:50,visual:1,autoSave:180},intervalsId:{main:0,numbers:0,visual:0,autoSave:0},buildingsInfo:{name:["Quarks","Particles","Atoms","Molecules"],cost:[0,3,24,3],increase:1.4,producing:[0,0,0,0]},upgradesInfo:{description:[],effect:[],effectText:[],cost:[]},researchesInfo:{description:[],effect:[],effectText:[],cost:[],scalling:[],max:[]},researchesAutoInfo:{description:[],effect:[],effectText:[],cost:[],scalling:[],max:[]}};function H(e,r,s,n,o,a=[],u=[]){Object.assign(l,{[e]:_(r.length)}),String(e).includes("researches")?Object.assign(i,{[e+"Info"]:{description:n,effect:s,effectText:o,cost:r,scalling:a,max:u}}):Object.assign(i,{[e+"Info"]:{description:n,effect:s,effectText:o,cost:r}})}var _=(e,r="number")=>{let s=[];for(let n=0;n<e;n++)r==="number"?s.push(0):n===4||n===5||n===6?s.push(!1):s.push(!0);return s},K=document.getElementsByClassName("toggle").length;Object.assign(l,{toggles:_(K,"toggles")});H("upgrades",[9,12,36,300,800,5e3,15e3,36e3],[10,10,5,4,.2,1.01,"",""],["Bigger electrons. Particles cost decreased.","Stronger protons. Particles produce more.","More neutrons. Increased gain of Particles.","Superposition. Unlocks new reset tier.","Protium. Basic.","Deuterium. Heavy.","Tritium. Radioactive.","Nuclear fusion. More energy."],[["Particle cost is "," times cheaper."],["Particles produce "," times more Quarks."],["Atoms produce "," times more Particles."],["Abbility to reset at any time and boost production for all buildings by ",", if had enough energy."],["Cost scalling is decreased by ","."],["Buildings (only bought one's) boost themselfs by "," times."],["Molecules produce Molecules. At a reduced rate.",""],["Unspent energy boost Molecules production of themselfs 1 to 1.",""]]);H("researches",[2e3,6500,2e4,12e3,42e3],[.01,.01,12,1,2],["Effect of 'Protium' upgrade is stronger.","Effect of 'Deuterium' upgrade is bigger.","Effect of 'Tritium' upgrade is better.","Discharge bonus improved.","Gain more energy from buying a building."],[["Cost scalling is "," smaller for each level."],["Each bought building boost each other by additional ","."],["Molecules now produce themselfs "," times quicker."],["Discharge is now gives extra +"," bonus per reached goal."],["A single building now gives "," times more energy."]],[300,1500,1800,0,38e3],[9,3,9,1,2]);H("researchesAuto",[300,3e3],["","Particles"],["Buy toggles.","Automatization for buying upgrades."],[["Unlock abbility to buy multiple buildings at same time.",""],["Will automatically buy "," for you."]],[0,5e3],[1,3]);var m=structuredClone(l),w=structuredClone(i),D=e=>{let r;return e==="p"?r=structuredClone(m):r=structuredClone(w),r},W=e=>{if(Object.prototype.hasOwnProperty.call(e,"player")&&Object.prototype.hasOwnProperty.call(e,"global")){let r=D("p");for(let s in m)Object.prototype.hasOwnProperty.call(e.player,s)||(e.player[s]=r[s]);if(e.player.stage.current===1||e.player.stage.current,m.researchesAuto.length>e.player.researchesAuto.length)for(let s=e.player.researchesAuto.length;s<m.researchesAuto.length;s++)e.player.researchesAuto[s]=0;if(m.toggles.length>e.player.toggles.length)for(let s=e.player.toggles.length;s<m.toggles.length;s++)e.player.toggles[s]=r.toggles[s];(e.player.stage.current===void 0||e.player.stage.current===0)&&(e.player.stage.current=e.player.stage.true),e.player.discharge.bonus===void 0&&(e.player.discharge.bonus=0),Object.assign(l,e.player),i.intervals=e.global.intervals}else p("Save file coudn't be loaded as its missing important info.")};var t=e=>{let r=document.getElementById(e);if(r!==null)return r;throw p("Some ID failed to load, game won't be working properly. Please refresh."),new TypeError(`ID "${e}" not found.`)},Q=async(e=!1)=>{if(e){let r=localStorage.getItem("save"),s=localStorage.getItem("theme");if(r!==null){let n=JSON.parse(atob(r));W(n),l.toggles[0]&&p(`Welcome back, you were away for ${f(Date.now()-l.time.updated,0,"time")}.`)}else p("Welcome. This is a test-project. Since I don't expect anyone to play this, save file can get corrupted with a new version.");s!==null&&(i.theme.default=!1,i.theme.stage=Number(s))}A(!1,"toggle","reload"),P(),S(),O();for(let r=0;r<m.toggles.length;r++)G(r,!1);k(),B(),e&&!l.toggles[0]&&await T(`Welcome back, you were away for ${f(Date.now()-l.time.updated,0,"time")}. Game was set to have offline time disabled. Press confirm to NOT to gain offline time.`)&&(l.time.updated=Date.now()),h(!1,"all")};Q(!0);var{screenReader:F}=i;for(let e=0;e<m.toggles.length;e++)t(`toggle${e}`).addEventListener("click",()=>G(e));for(let e=1;e<m.buildings.length;e++)t(`building${e}Btn`).addEventListener("click",()=>$(l.buildings,e));for(let e=0;e<i.upgradesInfo.cost.length;e++)t(`upgrade${e+1}`).addEventListener("mouseover",()=>L(e)),t(`upgrade${e+1}`).addEventListener("click",()=>C(e)),F&&t(`upgrade${e+1}`).addEventListener("focus",()=>C(e));t("dischargeReset").addEventListener("click",async()=>await V());t("stageReset").addEventListener("click",async()=>await J());t("buy1x").addEventListener("click",()=>k("1"));t("buyAny").addEventListener("click",()=>k("any"));t("buyAnyInput").addEventListener("blur",()=>k("any"));t("buyMax").addEventListener("click",()=>k("max"));t("buyStrict").addEventListener("click",()=>k("strict"));for(let e=0;e<i.researchesInfo.cost.length;e++)t(`research${e+1}Stage1Image`).addEventListener("mouseover",()=>L(e,"research")),t(`research${e+1}Stage1Image`).addEventListener("click",()=>C(e,"research")),F&&t(`research${e+1}Stage1Image`).addEventListener("focus",()=>C(e,"research"));for(let e=0;e<i.researchesAutoInfo.cost.length;e++)t(`researchAuto${e+1}Image`).addEventListener("mouseover",()=>L(e,"researchAuto")),t(`researchAuto${e+1}Image`).addEventListener("click",()=>C(e,"researchAuto")),F&&t(`researchAuto${e+1}Image`).addEventListener("focus",()=>C(e,"researchAuto"));t("save").addEventListener("click",async()=>await E("save"));t("file").addEventListener("change",async()=>await E("load"));t("export").addEventListener("click",async()=>await E("export"));t("delete").addEventListener("click",async()=>await E("delete"));t("switchTheme0").addEventListener("click",()=>z(0,!0));for(let e=1;e<=i.stageInfo.word.length;e++)t(`switchTheme${e}`).addEventListener("click",()=>z(e));t("mainInterval").addEventListener("blur",()=>h(!1,"main"));t("numbersInterval").addEventListener("blur",()=>h(!1,"numbers"));t("visualInterval").addEventListener("blur",()=>h(!1,"visual"));t("autoSaveInterval").addEventListener("blur",()=>h(!1,"autoSave"));t("pauseGame").addEventListener("click",async()=>await X());t("toggle3").addEventListener("click",()=>O());t("customFontSize").addEventListener("blur",()=>O(!0));t("screenReaderToggle").addEventListener("click",()=>A(!0));if(F){for(let e=0;e<m.buildings.length;e++)t(`invisibleGetBuilding${e}`).addEventListener("click",()=>A(e,"button"));t("invisibleGetResource1").addEventListener("click",()=>A(0,"button","resource")),t("specialTabBtn").addEventListener("click",()=>S("special"))}else t("specialTabBtn").style.display="none";t("hideToggle").addEventListener("click",R);t("stageTabBtn").addEventListener("click",()=>S("stage"));t("researchTabBtn").addEventListener("click",()=>S("research"));t("settingsTabBtn").addEventListener("click",()=>S("settings"));function h(e=!1,r=""){let{intervals:s,intervalsId:n}=i;if(r!==""){let o=t("mainInterval"),a=t("numbersInterval"),u=t("visualInterval"),g=t("autoSaveInterval");if(r==="main")s.main=Math.min(Math.max(Math.trunc(Number(o.value)),20),1e3),s.main>s.numbers&&(s.numbers=s.main);else if(r==="numbers"){let c=Math.min(Math.max(Math.trunc(Number(a.value)),20),1e3);s.numbers=Math.max(c,s.main)}else r==="visual"?s.visual=Math.min(Math.max(Math.trunc(Number(u.value)*10)/10,.5),10):r==="autoSave"&&(s.autoSave=Math.min(Math.max(Math.trunc(Number(g.value)),60),1800));o.value=String(s.main),a.value=String(s.numbers),u.value=String(s.visual),g.value=String(s.autoSave)}clearInterval(n.main),clearInterval(n.numbers),clearInterval(n.visual),clearInterval(n.autoSave),e||(n.main=setInterval(N,s.main),n.numbers=setInterval(x,s.numbers),n.visual=setInterval(j,s.visual*1e3),n.autoSave=setInterval(E,s.autoSave*1e3,"save"))}async function E(e){switch(e){case"load":{let r=t("file"),s=r.files;if(s===null)return p("Loaded file wasn't found.");let n=await s[0].text();try{let o=JSON.parse(atob(n));h(!0),W(o),await T(`This save file was set to have offline progress disabled (currently ${f(Date.now()-l.time.updated,0,"time")}). Press confirm to NOT to gain offline time.`)&&(l.time.updated=Date.now()),Q()}catch(o){p("Incorrect save file format.")}finally{r.value=""}break}case"save":{let r=btoa(`{"player":${JSON.stringify(l)},"global":{"intervals":${JSON.stringify(i.intervals)}}}`);localStorage.setItem("save",r),t("isSaved").textContent="Saved",i.lastSave=0;break}case"export":{await E("save");let r=localStorage.getItem("save");if(r===null)return p("Save file wasn't found. Even though game was saved just now...");let s=document.createElement("a");s.href="data:text/plain;charset=utf-8,"+r,s.download="Fundamental.txt",s.click();break}case"delete":{let r=await Y(`This will truly delete your save file!
Type 'delete' to confirm.`);(r==null?void 0:r.toLowerCase())==="delete"?(h(!0),localStorage.clear(),Object.assign(l,D("p")),Object.assign(i,D("g")),l.time.started=Date.now(),l.time.updated=l.time.started,Q()):r!==null&&r!==""&&p(`You wrote '${r}', so save file wasn't deleted.`);break}}}var X=async()=>{h(!0);let e=await Y("Game is currently paused. Press any button bellow to unpause it. If you want you can enter 'NoOffline' to NOT to gain offline time. Offline timer has a limit.");(e==null?void 0:e.toLowerCase())==="nooffline"?l.time.updated=Date.now():e!==null&&e!==""&&p(`You wrote '${e}', so you gained offline time.`),h()};})();
