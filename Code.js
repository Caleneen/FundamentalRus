"use strict";(()=>{var Q=e=>{let{stage:r,buildings:s}=l;switch(e){case"discharge":l.energy.current=0;for(let n=0;n<m.buildings.length;n++)n===0?(s[0].current=3,s[0].total+=3):(s[n].current=0,s[n].true=0,v(n));break;case"stage":{l.upgrades=[],l.researches=[];let{upgrades:n,researches:a}=l;for(let i=1;i<m.buildings.length;i++)s[i].current=0,s[i].true=0,s[i].total=0;switch(r.current){case 1:l.energy.current=0,l.energy.total=0,l.discharge.current=0,s[0].current=3,s[0].total=3;for(let i=0;i<o.upgradesInfo.cost.length;i++)n[i]=0;for(let i=0;i<o.researchesInfo.cost.length;i++)a[i]=0;break;case 2:s[0].current=.0028,s[0].total=.0028;break}N(),B(),M();break}}x()};var k=(e,r,s=!1)=>{if(e[r-1].current<o.buildingsInfo.cost[r]*(s?2:1)||!isFinite(o.buildingsInfo.cost[r])){o.screenReader&&!s&&(t("invisibleBought").textContent=`Coudn't buy '${o.buildingsInfo.name[r]}', because didn't had enough of '${o.buildingsInfo.name[r-1]}'`);return}let{stage:n,researchesAuto:a,buyToggle:i}=l,{stageInfo:u,buildingsInfo:d}=o;if(n.current===1&&(o.energyType[r]=w.energyType[r]*3**l.researches[4]),i.howMany!==1&&a[0]>0||s){let y=e[r-1].current/(s?2:1),g=d.cost[r],b=0,O=s?-1:i.howMany;for(var c=0;y>=g&&c!==O;c++)b+=g,y-=g,g*=d.increase;if(c<O&&O!==-1&&i.strict)return;e[r-1].current-=b,e[r].current+=c,e[r].true+=c,e[r].total+=c,n.current===1&&(l.energy.current+=o.energyType[r]*c,l.energy.total+=o.energyType[r]*c),o.screenReader&&!s&&(t("invisibleBought").textContent=`Bought ${f(c)} '${d.name[r]}'${n.current===1?`, gained ${f(o.energyType[r]*c)} ${u.resourceName[n.current]}`:""}`)}else(i.howMany===1||a[0]===0)&&(e[r-1].current-=d.cost[r],e[r].current++,e[r].true++,e[r].total++,n.current===1&&(l.energy.current+=o.energyType[r],l.energy.total+=o.energyType[r]),o.screenReader&&(t("invisibleBought").textContent=`Bought 1 '${d.name[r]}'${n.current===1?`, gained ${o.energyType[r]} ${u.resourceName[n.current]}`:""}`));v(r),R(),x()},v=e=>{let{stage:r,buildings:s,upgrades:n,researches:a}=l,{buildingsInfo:i}=o;r.current===1&&(o.upgradesInfo.effect[4]=Math.trunc((.2+a[0]*.01)*100)/100,i.increase=Math.trunc((1.4-(n[4]===1?o.upgradesInfo.effect[4]:0))*100)/100),i.cost[e]=w.buildingsInfo.cost[e]*i.increase**s[e].true,e===1&&n[0]===1&&r.current===1&&(i.cost[1]/=10)},P=(e,r,s=r+"Info")=>{l[r][e]!==o[s].max[e]&&(o[s].cost[e]=w[s].cost[e]+o[s].scalling[e]*l[r][e])},L=(e,r)=>{let{buildings:s}=l,{buildingsInfo:n}=o,a=s[e].current,i;if(l.stage.current===1&&e===3){if(n.producing[3]<=1)return;i=Math.log(n.producing[e])*r*12**l.researches[2],l.upgrades[7]===1&&(i*=l.energy.current)}else i=n.producing[e+1]*r;let u=s[e].current+i;if(isFinite(u))s[e].current=u;else return;u=s[e].total+(s[e].current-a),isFinite(u)&&(s[e].total=u)},C=(e,r="upgrades")=>{let{stage:s}=l;switch(r){case"upgrades":{let{upgrades:n}=l;if(s.current===1){let{energy:a}=l,{upgradesInfo:i}=o;if(n[e]===1||a.current<i.cost[e])return;if(n[e]=1,a.current-=i.cost[e],t(`upgrade${e+1}`).style.backgroundColor="green",e===0)v(1);else if(e===3)t("discharge").style.display="";else if(e===4)for(let u=1;u<o.buildingsInfo.name.length;u++)v(u);o.screenReader&&(t("invisibleBought").textContent=`You have bought upgrade '${i.description[e]}'`)}break}case"researches":{let{researches:n}=l;if(s.current===1){let{energy:a}=l,{researchesInfo:i}=o;if(n[e]===i.max[e]||a.current<i.cost[e])return;let u=t(`research${e+1}Stage1Level`);if(n[e]++,a.current-=i.cost[e],u.textContent=String(n[e]),n[e]!==i.max[e]?u.classList.replace("redText","orchidText"):(u.classList.remove("redText","orchidText"),u.classList.add("greenText")),e===0)for(let d=1;d<o.buildingsInfo.name.length;d++)v(d);o.screenReader&&(t("invisibleBought").textContent=`You have researched '${i.description[e]}', level is now ${n[e]} ${n[e]===i.max[e]?"maxed":""}`),P(e,"researches")}break}case"researchesAuto":{let{researchesAuto:n}=l,{researchesAutoInfo:a}=o,i=t(`researchAuto${e+1}Level`);if(s.current===1){let{energy:u}=l;if(n[e]===a.max[e]||u.current<a.cost[e]||e>1)return;n[e]++,u.current-=a.cost[e]}else if(s.current===2)return;i.textContent=String(n[e]),n[e]!==a.max[e]?i.classList.replace("redText","orchidText"):(i.classList.remove("redText","orchidText"),i.classList.add("greenText")),o.screenReader&&(t("invisibleBought").textContent=`You have researched '${a.description[e]}', level is now ${n[e]} ${n[e]===a.max[e]?"maxed":""}`),P(e,"researchesAuto");break}}x(),$(e,r)},z=(e,r=!0)=>{var a,i,u,d;let{toggles:s}=l,n=t(`toggle${e}`);r&&(s[e]=!s[e]),n.classList.contains("auto")?s[e]?(n.textContent="Auto ON",n.style.borderColor=""):(n.textContent="Auto OFF",n.style.borderColor="crimson"):s[e]?(n.textContent="ON",n.style.borderColor="",o.screenReader&&(n.ariaLabel=(d=(u=n.ariaLabel)==null?void 0:u.replace(" OFF"," ON"))!=null?d:"")):(n.textContent="OFF",n.style.borderColor="crimson",o.screenReader&&(n.ariaLabel=(i=(a=n.ariaLabel)==null?void 0:a.replace(" ON"," OFF"))!=null?i:""))},I=(e="none")=>{let{buyToggle:r}=l,s=t("buyAnyInput");switch(e){case"1":r.howMany=1;break;case"max":r.howMany=-1;break;case"any":r.input=Math.max(Math.trunc(Number(s.value)),-1),r.input===0&&(r.input=1),r.howMany=r.input;break;case"strict":r.strict=!r.strict;break;default:s.value=String(r.input)}t("buyStrict").style.borderColor=r.strict?"":"crimson",t("buy1x").style.backgroundColor=r.howMany===1?"green":"",t("buyAny").style.backgroundColor=Math.abs(r.howMany)!==1?"green":"",t("buyMax").style.backgroundColor=r.howMany===-1?"green":""},q=async()=>{let{stage:e,buildings:r,researchesAuto:s,toggles:n}=l,a=!1;if(e.current===1)if(r[3].current>=167e19){let i=!0;n[2]&&(i=await T("Ready to enter next stage?")),i&&(s[0]===0&&s[0]++,a=!0)}else p("There are more molecules in a single drop than that you know.");else p("Not yet in game");a&&p("There is nothing past stage 1 for now")},J=async()=>{let{energy:e}=l,{dischargeInfo:r}=o;if(l.upgrades[3]===1&&l.buildings[1].true>0&&l.stage.current===1){let s=!0;l.toggles[1]&&e.current<r.next?s=await T("This will reset all of your current buildings and energy. You will NOT gain production boost. Continue?"):l.toggles[1]&&e.current>=r.next&&(s=await T("You have enough energy to gain boost. Continue?")),s&&(e.current>=r.next?(r.next*=10,l.discharge.current++,o.screenReader&&(t("invisibleBought").textContent="Buildings and energy were reset for some boost")):o.screenReader&&e.current<r.next&&(t("invisibleBought").textContent="Buildings and energy were reset, no boost"),Q("discharge"))}};var S=(e="none")=>{if(o.tab!==e){t("stageTab").style.display="none",t("stageTabBtn").style.borderColor="",t("researchTab").style.display="none",t("researchTabBtn").style.borderColor="",t("settingsTab").style.display="none",t("settingsTabBtn").style.borderColor="";let r=["#e3e3e3","#a10000"][o.theme.stage-1],s=t("invisibleTab");t("specialTab").style.display="none",e!=="none"?o.tab=e:o.tab="stage",t(`${o.tab}Tab`).style.display="",t(`${o.tab}TabBtn`).style.borderColor=r,s.textContent=`Current tab: ${o.tab} tab`,B(),x()}},R=()=>{let{stage:e,time:r,buildings:s,upgrades:n,researches:a,researchesAuto:i,toggles:u}=l,{buildingsInfo:d}=o,c=Date.now()-r.updated,y=c/1e3;if(r.updated=Date.now(),c<0)return console.warn("Negative passed time detected.");if(o.lastSave+=c,y>3600&&(y=3600,console.log("Max offline progress is 1 hour.")),e.current===1){let{discharge:g}=l,{upgradesInfo:b}=o;u[6]&&i[1]>=3&&k(s,3,!0),d.producing[3]=.3*s[3].current*b.effect[3]**g.current,n[5]===1&&(d.producing[3]*=b.effect[5]**s[3].true),L(2,y),b.effect[5]=Math.trunc((1.02+.01*a[1])*100)/100,b.effect[3]=4+1*a[3],n[6]===1&&L(3,y),u[5]&&i[1]>=2&&k(s,2,!0),d.producing[2]=.4*s[2].current*b.effect[3]**g.current,n[2]===1&&(d.producing[2]*=5),n[5]===1&&(d.producing[2]*=b.effect[5]**s[2].true),L(1,y),u[4]&&i[1]>=1&&k(s,1,!0),d.producing[1]=.5*s[1].current*b.effect[3]**g.current,n[1]===1&&(d.producing[1]*=10),n[5]===1&&(d.producing[1]*=b.effect[5]**s[1].true),L(0,y)}else e.current===2&&(d.producing[1]=4e-4*s[1].current,L(0,y))},x=()=>{let{stage:e,buildings:r,upgrades:s}=l,{tab:n,buildingsInfo:a}=o;o.footer&&(e.current===1?(t("quarks").textContent=`Quarks: ${f(r[0].current)}`,l.energy.total>=9&&(t("energy").textContent=`Energy: ${f(l.energy.current,0)}`)):e.current===2&&(t("water").textContent=`Moles: ${f(r[0].current,4)}`)),n==="stage"?(t("building1Cur").textContent=f(r[1].current),t("building1Prod").textContent=f(a.producing[1]),e.current===1?(a.cost[1]<=r[0].current?(t("building1Btn").classList.add("availableBuilding"),t("building1Btn").textContent=`Buy for: ${f(a.cost[1])} Quarks`):(t("building1Btn").classList.remove("availableBuilding"),t("building1Btn").textContent=`Need: ${f(a.cost[1])} Quarks`),r[1].total>=11&&(t("building2Cur").textContent=f(r[2].current),t("building2Prod").textContent=f(a.producing[2]),a.cost[2]<=r[1].current?(t("building2Btn").classList.add("availableBuilding"),t("building2Btn").textContent=`Buy for: ${f(a.cost[2])} Particles`):(t("building2Btn").classList.remove("availableBuilding"),t("building2Btn").textContent=`Need: ${f(a.cost[2])} Particles`)),r[2].total>=2&&(t("building3Cur").textContent=f(r[3].current),t("building3Prod").textContent=f(a.producing[3]),a.cost[3]<=r[2].current?(t("building3Btn").classList.add("availableBuilding"),t("building3Btn").textContent=`Buy for: ${f(a.cost[3])} Atoms`):(t("building3Btn").classList.remove("availableBuilding"),t("building3Btn").textContent=`Need: ${f(a.cost[3])} Atoms`)),s[3]===1&&(t("dischargeReset").textContent=`Next goal is ${f(o.dischargeInfo.next,0)} Energy`,t("dischargeEffect").textContent=String(o.upgradesInfo.effect[3]))):e.current===2&&(a.cost[1]<=r[0].current?(t("building1Btn").classList.add("availableBuilding"),t("building1Btn").textContent=`Buy for: ${f(a.cost[1],4)} Moles`):(t("building1Btn").classList.remove("availableBuilding"),t("building1Btn").textContent=`Need: ${f(a.cost[1],4)} Moles`))):n==="settings"&&o.lastSave>=1e3&&(t("isSaved").textContent=`${f(o.lastSave,0,"time")} ago`)},B=()=>{let{stage:e,buildings:r,upgrades:s,researchesAuto:n}=l;if(e.current===1){let{energy:a,discharge:i}=l;t("energyStat").style.display=a.total>=9?"":"none",t("building2").style.display=r[1].total>=11?"":"none",t("building3").style.display=r[2].total>=2?"":"none",a.total>=9&&(t("upgrades").style.display=""),t("discharge").style.display=s[3]>0?"":"none",i.current>=1&&(t("resetToggles").style.display="");for(let u=5;u<=8;u++)i.current>=3?t(`upgrade${u}`).style.display="":t(`upgrade${u}`).style.display="none";i.current>=4&&(t("researchTabBtn").style.display=""),s[7]===1&&(t("stage").style.display=""),r[3].current>=167e19&&(t("stageReset").textContent="Enter next stage"),o.screenReader&&(t("invisibleGetBuilding2").style.display=r[2].total>0?"":"none",t("invisibleGetBuilding3").style.display=r[3].total>0?"":"none")}for(let a=1;a<m.buildings.length;a++)n[1]>=a?t(`toggle${a+3}`).style.display="":t(`toggle${a+3}`).style.display="none";t("toggleBuy").style.display=n[0]>0?"":"none"},$=(e,r="upgrades",s=r+"Info")=>{r.includes("researches")?(t("researchText").textContent=o[s].description[e],r==="researchesAuto"&&e===1&&(o.researchesAutoInfo.effect[1]=o.buildingsInfo.name[Math.min(l.researchesAuto[1]+1,o.buildingsInfo.name.length-1)]),o[s].effect[e]!==0?t("researchEffect").textContent=`${o[s].effectText[e][0]}${o[s].effect[e]}${o[s].effectText[e][1]}`:t("researchEffect").textContent=o[s].effectText[e][0],t("researchCost").textContent=`${l[r][e]===o[s].max[e]?0:o[s].cost[e]} ${o.stageInfo.resourceName[l.stage.current-1]}.`):(t("upgradeText").textContent=o[s].description[e],o[s].effect[e]!==0?t("upgradeEffect").textContent=`${o[s].effectText[e][0]}${o[s].effect[e]}${o[s].effectText[e][1]}`:t("upgradeEffect").textContent=o[s].effectText[e][0],t("upgradeCost").textContent=`${l[r][e]===1?0:o[s].cost[e]} ${o.stageInfo.resourceName[l.stage.current-1]}.`)},f=(e,r=e<1e3?2:0,s="number")=>{switch(s){case"number":if(l.stage.current===2&&r===4&&e>=1e3&&(r=0),r>0&&e<1e6)return String(Math.trunc(e*10**r)/10**r);if(r<=0&&e<1e6)return String(Math.trunc(e));{let n=Math.trunc(Math.log10(e));return`${Math.trunc(e/10**n*100)/100}e${n}`}case"time":return e>=1728e5?`${Math.trunc(e/864e5)} days`:e>=72e5?`${Math.trunc(e/36e5)} hours`:e>=6e5?`${Math.trunc(e/6e4)} minutes`:`${Math.trunc(e/1e3)} seconds`}},N=()=>{let{stage:e,upgrades:r,researches:s,researchesAuto:n}=l,{stageInfo:a,buildingsInfo:i,researchesAutoInfo:u}=o,d=document.body.style;t("upgradeCost").classList.remove("orangeText","cyanText"),t("researchCost").classList.remove("orangeText","cyanText");for(let c=2;c<m.buildings.length;c++)t(`building${c}`).style.display="none";if(e.current===1){let{upgradesInfo:c,researchesInfo:y}=o;i.name=["Quarks","Particles","Atoms","Molecules"],w.buildingsInfo.cost=[0,3,24,3],o.dischargeInfo.next=10**l.discharge.current,t("upgradeCost").classList.add("orangeText"),t("researchCost").classList.add("orangeText");for(let g=0;g<c.cost.length;g++)r[g]===1?t(`upgrade${[g+1]}`).style.backgroundColor="green":t(`upgrade${[g+1]}`).style.backgroundColor="";for(let g=0;g<y.cost.length;g++)t(`research${g+1}Stage1Level`).textContent=String(s[g]),t(`research${g+1}Stage1Level`).classList.remove("redText","orchidText","greenText"),P(g,"researches"),s[g]===y.max[g]?t(`research${g+1}Stage1Level`).classList.add("greenText"):s[g]===0?t(`research${g+1}Stage1Level`).classList.add("redText"):t(`research${g+1}Stage1Level`).classList.add("orchidText");t("quarkStat").style.display="",t("particles").style.display="",t("atoms").style.display="",t("molecules").style.display="",t("dischargeToggleReset").style.display="";for(let g=1;g<=4;g++)t(`upgrade${g}`).style.display="";for(let g=1;g<=y.cost.length;g++)t(`research${g}Stage1`).style.display="";e.true===1&&(t("upgrades").style.display="none",t("resetToggles").style.display="none",t("researchTabBtn").style.display="none",t("stage").style.display="none",t("stageToggleReset").style.display="none",t("themeArea").style.display="none")}else e.current===2&&(i.name=["Moles of water","Drops"],i.increase=1.2,w.buildingsInfo.cost=[0,.0028],t("upgradeCost").classList.add("cyanText"),t("researchCost").classList.add("cyanText"),t("waterStat").style.display="",t("drops").style.display="");for(let c=1;c<i.name.length;c++)t(`building${c}Name`).textContent=i.name[c],v(c);u.max[1]=i.name.length-1;for(let c=0;c<u.cost.length;c++)t(`researchAuto${c+1}Level`).textContent=String(n[c]),t(`researchAuto${c+1}Level`).classList.remove("redText","orchidText","greenText"),P(c,"researchesAuto"),n[c]===u.max[c]?t(`researchAuto${c+1}Level`).classList.add("greenText"):n[c]===0?t(`researchAuto${c+1}Level`).classList.add("redText"):t(`researchAuto${c+1}Level`).classList.add("orchidText");if(t("researchAuto2Max").textContent=String(u.max[1]),e.current!==1){t("quarkStat").style.display="none",t("energyStat").style.display="none",t("particles").style.display="none",t("atoms").style.display="none",t("molecules").style.display="none",t("discharge").style.display="none",t("dischargeToggleReset").style.display="none";for(let c=1;c<=o.upgradesInfo.cost.length;c++)t(`upgrade${c}`).style.display="none";for(let c=1;c<=o.researchesInfo.cost.length;c++)t(`research${c}Stage1`).style.display="none"}if(e.current!==2&&(t("waterStat").style.display="none",t("drops").style.display="none"),e.true>1&&(t("upgrades").style.display="",t("resetToggles").style.display="",t("researchTabBtn").style.display="",t("stage").style.display="",t("stageToggleReset").style.display="",t("themeArea").style.display=""),t("stageReset").textContent="You are not ready",t("stageWord").textContent=a.word[e.current-1],e.current===1?(d.removeProperty("--border-image"),d.removeProperty("--border-stage"),d.removeProperty("--stage-text-color")):(d.setProperty("--border-image",`url(Used_art/Stage${e.current}%20border.png)`),e.current===2&&(d.setProperty("--border-stage","#1460a8"),d.setProperty("--stage-text-color","dodgerblue"))),o.screenReader){t("invisibleBought").textContent=`Current stage is '${a.word[e.current-1]}'`,t("invisibleGetResource1").style.display=e.current===1?"":"none";for(let c=2;c<m.buildings.length;c++)t(`invisibleGetBuilding${c}`).style.display="none";for(let c=0;c<i.name.length;c++)t(`invisibleGetBuilding${c}`).textContent=`Get information for ${i.name[c]}`}};var Y=(e,r=!1)=>{let{theme:s}=o;r?(s.default=!0,localStorage.removeItem("theme")):(s.default=!1,s.stage=e,localStorage.setItem("theme",String(e))),M()},M=()=>{let{stage:e}=l,{stageInfo:r,theme:s}=o,n=document.body.style;switch(n.setProperty("--transition","1s"),s.default?(s.stage=e.current,t("currentTheme").textContent="Default"):t("currentTheme").textContent=r.word[s.stage-1],n.removeProperty("--background-color"),n.removeProperty("--window-color"),n.removeProperty("--window-border"),n.removeProperty("--footer-color"),n.removeProperty("--button-main-color"),n.removeProperty("--button-main-border"),n.removeProperty("--button-main-hover"),n.removeProperty("--button-extra-hover"),n.removeProperty("--main-text-color"),n.removeProperty("--blue-text-color"),s.stage){case 2:n.setProperty("--background-color","#070026"),n.setProperty("--window-color","#000052"),n.setProperty("--window-border","blue"),n.setProperty("--footer-color","#0000db"),n.setProperty("--button-main-color","blue"),n.setProperty("--button-main-border","#427be1"),n.setProperty("--button-main-hover","#1515cf"),n.setProperty("--button-extra-hover","#2400d7"),n.setProperty("--main-text-color","dodgerblue"),n.setProperty("--blue-text-color","#82cb3b");break}setTimeout(()=>{n.removeProperty("--transition")},1e3)},p=e=>{let r=t("blocker");if(t("blocker").style.display==="block")return console.warn("Wasn't able to show another window (alert)");t("alertText").textContent=e;let s=t("confirmBtn");r.style.display="block";let n=()=>{r.style.display="none",s.removeEventListener("click",n)};s.addEventListener("click",n)},T=async e=>await new Promise(r=>{let s=t("blocker");s.style.display==="block"&&(console.warn("Wasn't able to show another window (confirm)"),r(!1)),t("alertText").textContent=e;let n=t("cancelBtn"),a=t("confirmBtn");s.style.display="block",n.style.display="block";let i=async()=>{s.style.display="none",n.style.display="none",a.removeEventListener("click",i),n.removeEventListener("click",u),r(!0)},u=async()=>{s.style.display="none",n.style.display="none",a.removeEventListener("click",i),n.removeEventListener("click",u),r(!1)};a.addEventListener("click",i),n.addEventListener("click",u)}),H=async e=>await new Promise(r=>{let s=t("blocker");s.style.display==="block"&&(console.warn("Wasn't able to show another window (prompt)"),r(null)),t("alertText").textContent=e;let n=t("inputArea"),a="",i=t("cancelBtn"),u=t("confirmBtn");s.style.display="block",i.style.display="block",n.style.display="block";let d=()=>{a=n.value},c=async()=>{s.style.display="none",i.style.display="none",n.style.display="none",n.value="",u.removeEventListener("click",c),i.removeEventListener("click",y),n.removeEventListener("blur",d),r(a)},y=async()=>{s.style.display="none",i.style.display="none",n.style.display="none",n.value="",u.removeEventListener("click",c),i.removeEventListener("click",y),n.removeEventListener("blur",d),r(null)};u.addEventListener("click",c),i.addEventListener("click",y),n.addEventListener("blur",d)}),F=()=>{let e=t("footer"),r=t("footerColor"),s=t("hideToggle"),n=t("hideText"),a=t("hideArrow");o.footer=!o.footer,s.removeEventListener("click",F),o.footer?(r.style.display="",a.style.transform="",e.style.animation="hide 1s forwards reverse",a.style.animation="rotate 1s forwards reverse",n.textContent="Hide"):(e.style.animation="hide 1s backwards",a.style.animation="rotate 1s backwards",n.textContent="Show",setTimeout(()=>{r.style.display="none",a.style.transform="rotate(180deg)"},1e3)),setTimeout(()=>{e.style.animation="",a.style.animation="",s.addEventListener("click",F)},1e3)},A=(e=!1,r="toggle",s="building")=>{var n;switch(r){case"toggle":{let a=e,i=Boolean((n=localStorage.getItem("screen reader"))!=null?n:!1),u=t("screenReaderToggle");a&&(i=!i),i?(u.textContent="ON",u.style.borderColor="crimson",u.setAttribute("aria-label","Screen reader support is ON"),localStorage.setItem("screen reader","true"),o.screenReader=!0,s==="reload"&&(l.buyToggle.strict=!1,o.intervals.main=100,o.intervals.numbers=1e3),a&&p(`For full support please refresh page. This will allow to buy upgrades on focus (because I have no idea how to make an image clickable with a keyboard), also you will get a special tab where you can check how much you own and more.
(For non screen readers this will cause issues)`)):(u.textContent="OFF",u.style.borderColor="",u.setAttribute("aria-label","Screen reader support is OFF"),localStorage.removeItem("screen reader"),o.screenReader=!1);break}case"button":{let a=e,{stage:i}=l,u=t("invisibleBought");if(s==="building"){let{buildings:d}=l,{buildingsInfo:c}=o;a===0?u.textContent=`You have ${f(d[0].current)} ${c.name[0]}`:u.textContent=`You have ${f(d[a].current)} ${c.name[a]}, next one will cost ${f(c.cost[a])} ${c.name[a-1]}, they are producing ${f(c.producing[a])} ${c.name[a-1]} per second${l.researchesAuto[1]>=a?`, auto is ${l.toggles[a+3]?"on":"off"}`:""}`}else i.current===1&&(u.textContent=`You have ${l.energy.current} Energy${l.upgrades[3]===1?`, next discharge goal is ${f(o.dischargeInfo.next)} Energy`:""}`);break}}},D=(e=!1)=>{let r=document.body.style,s=t("customFontSize"),n=localStorage.getItem("fontSize");l.toggles[3]?((n===null||Number(n)<10||Number(n)>32||e)&&(n=String(Math.min(Math.max(Math.trunc(Number(s.value)*10)/10,10),32)),localStorage.setItem("fontSize",n)),r.setProperty("--font-size",`${n}px`),s.value=n):(r.setProperty("--font-size","1em"),localStorage.removeItem("fontSize"))};var l={stage:{true:1,current:1},energy:{current:0,total:0},discharge:{current:0,bonus:0},time:{updated:Date.now(),started:Date.now()},buildings:[{current:3,total:3},{current:0,true:0,total:0},{current:0,true:0,total:0},{current:0,true:0,total:0}],upgrades:[0,0,0,0,0,0,0,0],researches:[0,0,0,0,0],researchesAuto:[0,0],toggles:[],buyToggle:{howMany:1,input:10,strict:!0}},o={tab:"stage",footer:!0,screenReader:!1,lastSave:0,energyType:[0,1,5,20],stageInfo:{word:["Microworld","Submerged"],resourceName:["Energy","Water drops"]},theme:{stage:1,default:!0},dischargeInfo:{next:1},intervals:{main:50,numbers:50,visual:1,autoSave:180},intervalsId:{main:0,numbers:0,visual:0,autoSave:0},buildingsInfo:{name:["Quarks","Particles","Atoms","Molecules"],cost:[0,3,24,3],increase:1.4,producing:[0,0,0,0]},upgradesInfo:{description:["Bigger electrons. Particles cost decreased.","Stronger protons. Particles produce more.","More neutrons. Increased gain of Particles.","Superposition. Unlocks new reset tier.","Protium. Basic.","Deuterium. Heavy.","Tritium. Radioactive.","Nuclear fusion. More energy."],effectText:[["Particle cost is "," times cheaper."],["Particles produce "," times more Quarks."],["Atoms produce "," times more Particles."],["Abbility to reset at any time and boost production for all buildings by ",", if had enough energy."],["Cost scalling is decreased by ","."],["Buildings (only bought one's) boost themselfs by "," times."],["Molecules produce Molecules. At a reduced rate."],["Unspent energy boost Molecules production of themselfs 1 to 1."]],effect:[10,10,5,4,.2,1.01,0,0],cost:[9,12,36,300,800,5e3,15e3,36e3]},upgradesS2Info:{description:[],effectText:[],effect:[],cost:[]},researchesInfo:{description:["Effect of 'Protium' upgrade is stronger.","Effect of 'Deuterium' upgrade is bigger.","Effect of 'Tritium' upgrade is better.","Discharge bonus improved.","Gain more energy from buying a building."],effectText:[["Cost scalling is "," smaller for each level."],["Each bought building boost each other by additional ","."],["Molecules now produce themselfs "," times quicker."],["Discharge is now gives extra +"," bonus per reached goal."],["A single building now gives "," times more energy."]],effect:[.01,.01,12,1,3],cost:[2e3,6500,2e4,12e3,42e3],scalling:[300,1500,1800,0,81456],max:[9,3,9,1,2]},researchesS2Info:{description:[],effectText:[],effect:[],cost:[],scalling:[],max:[]},researchesAutoInfo:{description:["Buy toggles.","Automatization for buying upgrades."],effectText:[["Unlock abbility to buy multiple buildings at same time."],["Will automatically buy "," for you."]],effect:[0,"Particles"],cost:[300,3e3],scalling:[0,5e3],max:[1,3]}},V=e=>{let r=[];for(let s=0;s<e;s++)s===4||s===5||s===6?r.push(!1):r.push(!0);return r},_=document.getElementsByClassName("toggle").length;Object.assign(l,{toggles:V(_)});var m=structuredClone(l),w=structuredClone(o),U=e=>{let r;return e==="p"?r=structuredClone(m):r=structuredClone(w),r},j=e=>{if(Object.prototype.hasOwnProperty.call(e,"player")&&Object.prototype.hasOwnProperty.call(e,"global")){let r=U("p");for(let s in m)Object.prototype.hasOwnProperty.call(e.player,s)||(e.player[s]=r[s]);if(e.player.stage.current===1||e.player.stage.current,m.researchesAuto.length>e.player.researchesAuto.length)for(let s=e.player.researchesAuto.length;s<m.researchesAuto.length;s++)e.player.researchesAuto[s]=0;if(m.toggles.length>e.player.toggles.length)for(let s=e.player.toggles.length;s<m.toggles.length;s++)e.player.toggles[s]=r.toggles[s];Object.assign(l,e.player),o.intervals=e.global.intervals}else p("Save file coudn't be loaded as its missing important info.")};var t=e=>{let r=document.getElementById(e);if(r!==null)return r;throw p("Some ID failed to load, game won't be working properly. Please refresh."),new TypeError(`ID "${e}" not found.`)},W=async(e=!1)=>{if(e){let r=localStorage.getItem("save"),s=localStorage.getItem("theme");if(r!==null){let n=JSON.parse(atob(r));j(n),l.toggles[0]&&p(`Welcome back, you were away for ${f(Date.now()-l.time.updated,0,"time")}.`)}else p("Welcome. This is a test-project. Since I don't expect anyone to play this, save file can get corrupted with a new version.");s!==null&&(o.theme.default=!1,o.theme.stage=Number(s))}A(!1,"toggle","reload"),N(),S(),D();for(let r=0;r<m.toggles.length;r++)z(r,!1);I(),M(),e&&!l.toggles[0]&&await T(`Welcome back, you were away for ${f(Date.now()-l.time.updated,0,"time")}. Game was set to have offline time disabled. Press confirm to NOT to gain offline time.`)&&(l.time.updated=Date.now()),h(!1,"all")};W(!0);var{screenReader:G}=o;for(let e=0;e<m.toggles.length;e++)t(`toggle${e}`).addEventListener("click",()=>z(e));for(let e=1;e<m.buildings.length;e++)t(`building${e}Btn`).addEventListener("click",()=>k(l.buildings,e));for(let e=0;e<o.upgradesInfo.cost.length;e++)t(`upgrade${e+1}`).addEventListener("mouseover",()=>$(e)),t(`upgrade${e+1}`).addEventListener("click",()=>C(e)),G&&t(`upgrade${e+1}`).addEventListener("focus",()=>C(e));t("dischargeReset").addEventListener("click",async()=>await J());t("stageReset").addEventListener("click",async()=>await q());t("buy1x").addEventListener("click",()=>I("1"));t("buyAny").addEventListener("click",()=>I("any"));t("buyAnyInput").addEventListener("blur",()=>I("any"));t("buyMax").addEventListener("click",()=>I("max"));t("buyStrict").addEventListener("click",()=>I("strict"));for(let e=0;e<o.researchesInfo.cost.length;e++)t(`research${e+1}Stage1Image`).addEventListener("mouseover",()=>$(e,"researches")),t(`research${e+1}Stage1Image`).addEventListener("click",()=>C(e,"researches")),G&&t(`research${e+1}Stage1Image`).addEventListener("focus",()=>C(e,"researches"));for(let e=0;e<o.researchesAutoInfo.cost.length;e++)t(`researchAuto${e+1}Image`).addEventListener("mouseover",()=>$(e,"researchesAuto")),t(`researchAuto${e+1}Image`).addEventListener("click",()=>C(e,"researchesAuto")),G&&t(`researchAuto${e+1}Image`).addEventListener("focus",()=>C(e,"researchesAuto"));t("save").addEventListener("click",async()=>await E("save"));t("file").addEventListener("change",async()=>await E("load"));t("export").addEventListener("click",async()=>await E("export"));t("delete").addEventListener("click",async()=>await E("delete"));t("switchTheme0").addEventListener("click",()=>Y(0,!0));for(let e=1;e<=o.stageInfo.word.length;e++)t(`switchTheme${e}`).addEventListener("click",()=>Y(e));t("mainInterval").addEventListener("blur",()=>h(!1,"main"));t("numbersInterval").addEventListener("blur",()=>h(!1,"numbers"));t("visualInterval").addEventListener("blur",()=>h(!1,"visual"));t("autoSaveInterval").addEventListener("blur",()=>h(!1,"autoSave"));t("pauseGame").addEventListener("click",async()=>await K());t("toggle3").addEventListener("click",()=>D());t("customFontSize").addEventListener("blur",()=>D(!0));t("screenReaderToggle").addEventListener("click",()=>A(!0));if(G){for(let e=0;e<m.buildings.length;e++)t(`invisibleGetBuilding${e}`).addEventListener("click",()=>A(e,"button"));t("invisibleGetResource1").addEventListener("click",()=>A(0,"button","resource")),t("specialTabBtn").addEventListener("click",()=>S("special"))}else t("specialTabBtn").style.display="none";t("hideToggle").addEventListener("click",F);t("stageTabBtn").addEventListener("click",()=>S("stage"));t("researchTabBtn").addEventListener("click",()=>S("research"));t("settingsTabBtn").addEventListener("click",()=>S("settings"));function h(e=!1,r=""){let{intervals:s,intervalsId:n}=o;if(r!==""){let a=t("mainInterval"),i=t("numbersInterval"),u=t("visualInterval"),d=t("autoSaveInterval");if(r==="main")s.main=Math.min(Math.max(Math.trunc(Number(a.value)),20),1e3),s.main>s.numbers&&(s.numbers=s.main);else if(r==="numbers"){let c=Math.min(Math.max(Math.trunc(Number(i.value)),20),1e3);s.numbers=Math.max(c,s.main)}else r==="visual"?s.visual=Math.min(Math.max(Math.trunc(Number(u.value)*10)/10,.5),10):r==="autoSave"&&(s.autoSave=Math.min(Math.max(Math.trunc(Number(d.value)),60),1800));a.value=String(s.main),i.value=String(s.numbers),u.value=String(s.visual),d.value=String(s.autoSave)}clearInterval(n.main),clearInterval(n.numbers),clearInterval(n.visual),clearInterval(n.autoSave),e||(n.main=setInterval(R,s.main),n.numbers=setInterval(x,s.numbers),n.visual=setInterval(B,s.visual*1e3),n.autoSave=setInterval(E,s.autoSave*1e3,"save"))}async function E(e){switch(e){case"load":{let r=t("file"),s=r.files;if(s===null)return p("Loaded file wasn't found.");let n=await s[0].text();try{let a=JSON.parse(atob(n));h(!0),j(a),await T(`This save file was set to have offline progress disabled (currently ${f(Date.now()-l.time.updated,0,"time")}). Press confirm to NOT to gain offline time.`)&&(l.time.updated=Date.now()),W()}catch(a){p("Incorrect save file format.")}finally{r.value=""}break}case"save":{let r=btoa(`{"player":${JSON.stringify(l)},"global":{"intervals":${JSON.stringify(o.intervals)}}}`);localStorage.setItem("save",r),t("isSaved").textContent="Saved",o.lastSave=0;break}case"export":{await E("save");let r=localStorage.getItem("save");if(r===null)return p("Save file wasn't found. Even though game was saved just now...");let s=document.createElement("a");s.href="data:text/plain;charset=utf-8,"+r,s.download="Fundamental.txt",s.click();break}case"delete":{let r=await H(`This will truly delete your save file!
Type 'delete' to confirm.`);(r==null?void 0:r.toLowerCase())==="delete"?(h(!0),localStorage.clear(),Object.assign(l,U("p")),Object.assign(o,U("g")),l.time.started=Date.now(),l.time.updated=l.time.started,W()):r!==null&&r!==""&&p(`You wrote '${r}', so save file wasn't deleted.`);break}}}var K=async()=>{h(!0);let e=await H("Game is currently paused. Press any button bellow to unpause it. If you want you can enter 'NoOffline' to NOT to gain offline time. Offline timer has a limit.");(e==null?void 0:e.toLowerCase())==="nooffline"?l.time.updated=Date.now():e!==null&&e!==""&&p(`You wrote '${e}', so you gained offline time.`),h()};})();
